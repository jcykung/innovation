<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Artifact</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script type="importmap">
      {
        "imports": {
          "react": "https://esm.sh/react@18",
          "react-dom": "https://esm.sh/react-dom@18",
          "react-dom/client": "https://esm.sh/react-dom@18/client",
          "lucide-react": "https://esm.sh/lucide-react@0.263.1?external=react",
          "recharts": "https://esm.sh/recharts?external=react,react-dom",
          "mathjs": "https://esm.sh/mathjs",
          "lodash": "https://esm.sh/lodash",
          "d3": "https://esm.sh/d3",
          "plotly": "https://esm.sh/plotly.js",
          "three": "https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.module.min.js",
          "papaparse": "https://esm.sh/papaparse",
          "xlsx": "https://esm.sh/xlsx",
          "@/components/ui/alert": "https://esm.sh/@radix-ui/react-alert-dialog",
          "chart.js": "https://esm.sh/chart.js",
          "tone": "https://esm.sh/tone",
          "mammoth": "https://esm.sh/mammoth",
          "tensorflow": "https://esm.sh/@tensorflow/tfjs"
        }
      }
    </script>
  </head>
  <body>
    <div id="root"></div>
    <script type="module">
      const encodedReactCode =
        "CiAgICBjb25zdCBfanN4RmlsZU5hbWUgPSAiIjsgZnVuY3Rpb24gX29wdGlvbmFsQ2hhaW4ob3BzKSB7IGxldCBsYXN0QWNjZXNzTEhTID0gdW5kZWZpbmVkOyBsZXQgdmFsdWUgPSBvcHNbMF07IGxldCBpID0gMTsgd2hpbGUgKGkgPCBvcHMubGVuZ3RoKSB7IGNvbnN0IG9wID0gb3BzW2ldOyBjb25zdCBmbiA9IG9wc1tpICsgMV07IGkgKz0gMjsgaWYgKChvcCA9PT0gJ29wdGlvbmFsQWNjZXNzJyB8fCBvcCA9PT0gJ29wdGlvbmFsQ2FsbCcpICYmIHZhbHVlID09IG51bGwpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSBpZiAob3AgPT09ICdhY2Nlc3MnIHx8IG9wID09PSAnb3B0aW9uYWxBY2Nlc3MnKSB7IGxhc3RBY2Nlc3NMSFMgPSB2YWx1ZTsgdmFsdWUgPSBmbih2YWx1ZSk7IH0gZWxzZSBpZiAob3AgPT09ICdjYWxsJyB8fCBvcCA9PT0gJ29wdGlvbmFsQ2FsbCcpIHsgdmFsdWUgPSBmbigoLi4uYXJncykgPT4gdmFsdWUuY2FsbChsYXN0QWNjZXNzTEhTLCAuLi5hcmdzKSk7IGxhc3RBY2Nlc3NMSFMgPSB1bmRlZmluZWQ7IH0gfSByZXR1cm4gdmFsdWU7IH1pbXBvcnQgUmVhY3QsIHsgdXNlU3RhdGUsIHVzZUVmZmVjdCwgdXNlUmVmLCB1c2VNZW1vLCB1c2VDYWxsYmFjayB9IGZyb20gJ3JlYWN0JzsNCg0KLy8gLS0tIEljb24gQ29tcG9uZW50cyAoTHVjaWRlLVJlYWN0KSAtLS0NCi8vIFVzaW5nIGlubGluZSBTVkdzIHRvIGF2b2lkIGV4dGVybmFsIGRlcGVuZGVuY2llcw0KY29uc3QgQ2hlY2sgPSAocHJvcHMpID0+ICgNCiAgUmVhY3QuY3JlYXRlRWxlbWVudCgnc3ZnJywgeyB4bWxuczogImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiwgd2lkdGg6ICIyNCIsIGhlaWdodDogIjI0Iiwgdmlld0JveDogIjAgMCAyNCAyNCIgICAsIGZpbGw6ICJub25lIiwgc3Ryb2tlOiAiY3VycmVudENvbG9yIiwgc3Ryb2tlV2lkdGg6ICIyIiwgc3Ryb2tlTGluZWNhcDogInJvdW5kIiwgc3Ryb2tlTGluZWpvaW46ICJyb3VuZCIsIC4uLnByb3BzLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogNn19CiAgICAsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ3BvbHlsaW5lJywgeyBwb2ludHM6ICIyMCA2IDkgMTcgNCAxMiIgICAgICwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDd9fSkKICApDQopOw0KY29uc3QgWCA9IChwcm9wcykgPT4gKA0KICBSZWFjdC5jcmVhdGVFbGVtZW50KCdzdmcnLCB7IHhtbG5zOiAiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciLCB3aWR0aDogIjI0IiwgaGVpZ2h0OiAiMjQiLCB2aWV3Qm94OiAiMCAwIDI0IDI0IiAgICwgZmlsbDogIm5vbmUiLCBzdHJva2U6ICJjdXJyZW50Q29sb3IiLCBzdHJva2VXaWR0aDogIjIiLCBzdHJva2VMaW5lY2FwOiAicm91bmQiLCBzdHJva2VMaW5lam9pbjogInJvdW5kIiwgLi4ucHJvcHMsIF9fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiAxMX19CiAgICAsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ2xpbmUnLCB7IHgxOiAiMTgiLCB5MTogIjYiLCB4MjogIjYiLCB5MjogIjE4IiwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDEyfX0pCiAgICAsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ2xpbmUnLCB7IHgxOiAiNiIsIHkxOiAiNiIsIHgyOiAiMTgiLCB5MjogIjE4IiwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDEzfX0pCiAgKQ0KKTsNCmNvbnN0IFJlZnJlc2hDdyA9IChwcm9wcykgPT4gKA0KICBSZWFjdC5jcmVhdGVFbGVtZW50KCdzdmcnLCB7IHhtbG5zOiAiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciLCB3aWR0aDogIjI0IiwgaGVpZ2h0OiAiMjQiLCB2aWV3Qm94OiAiMCAwIDI0IDI0IiAgICwgZmlsbDogIm5vbmUiLCBzdHJva2U6ICJjdXJyZW50Q29sb3IiLCBzdHJva2VXaWR0aDogIjIiLCBzdHJva2VMaW5lY2FwOiAicm91bmQiLCBzdHJva2VMaW5lam9pbjogInJvdW5kIiwgLi4ucHJvcHMsIF9fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiAxN319CiAgICAsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ3BhdGgnLCB7IGQ6ICJNMyAydjZoNiIgLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogMTh9fSkKICAgICwgUmVhY3QuY3JlYXRlRWxlbWVudCgncGF0aCcsIHsgZDogIk0yMSAxMkE5IDkgMCAwIDAgNiA1LjNMMyA4IiAgICAgICAgLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogMTl9fSkKICAgICwgUmVhY3QuY3JlYXRlRWxlbWVudCgncGF0aCcsIHsgZDogIk0yMSAyMnYtNmgtNiIgLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogMjB9fSkKICAgICwgUmVhY3QuY3JlYXRlRWxlbWVudCgncGF0aCcsIHsgZDogIk0zIDEyYTkgOSAwIDAgMCAxNSA2LjdsMy0yLjciICAgICAgICwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDIxfX0pCiAgKQ0KKTsNCmNvbnN0IExpZ2h0YnVsYiA9IChwcm9wcykgPT4gKA0KICBSZWFjdC5jcmVhdGVFbGVtZW50KCdzdmcnLCB7IHhtbG5zOiAiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciLCB3aWR0aDogIjI0IiwgaGVpZ2h0OiAiMjQiLCB2aWV3Qm94OiAiMCAwIDI0IDI0IiAgICwgZmlsbDogIm5vbmUiLCBzdHJva2U6ICJjdXJyZW50Q29sb3IiLCBzdHJva2VXaWR0aDogIjIiLCBzdHJva2VMaW5lY2FwOiAicm91bmQiLCBzdHJva2VMaW5lam9pbjogInJvdW5kIiwgLi4ucHJvcHMsIF9fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiAyNX19CiAgICAsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ3BhdGgnLCB7IGQ6ICJNOSAxOGg2IiAsIF9fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiAyNn19KQogICAgLCBSZWFjdC5jcmVhdGVFbGVtZW50KCdwYXRoJywgeyBkOiAiTTEwIDIyaDQiICwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDI3fX0pCiAgICAsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ3BhdGgnLCB7IGQ6ICJNMTIgMmE3IDcgMCAwIDAtNyA3YzAgMyAyIDUgMiA3aDEwYzAtMiAyLTQgMi03YTcgNyAwIDAgMC03LTd6IiAgICAgICAgICAgICAgICAgLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogMjh9fSkKICApDQopOw0KY29uc3QgVHJvcGh5ID0gKHByb3BzKSA9PiAoDQogIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ3N2ZycsIHsgeG1sbnM6ICJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIsIHdpZHRoOiAiMjQiLCBoZWlnaHQ6ICIyNCIsIHZpZXdCb3g6ICIwIDAgMjQgMjQiICAgLCBmaWxsOiAibm9uZSIsIHN0cm9rZTogImN1cnJlbnRDb2xvciIsIHN0cm9rZVdpZHRoOiAiMiIsIHN0cm9rZUxpbmVjYXA6ICJyb3VuZCIsIHN0cm9rZUxpbmVqb2luOiAicm91bmQiLCAuLi5wcm9wcywgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDMyfX0KICAgICwgUmVhY3QuY3JlYXRlRWxlbWVudCgncGF0aCcsIHsgZDogIk02IDlINC41YTIuNSAyLjUgMCAwIDEgMC01SDYiICAgICAgLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogMzN9fSkKICAgICwgUmVhY3QuY3JlYXRlRWxlbWVudCgncGF0aCcsIHsgZDogIk0xOCA5aDEuNWEyLjUgMi41IDAgMCAwIDAtNUgxOCIgICAgICAsIF9fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiAzNH19KQogICAgLCBSZWFjdC5jcmVhdGVFbGVtZW50KCdwYXRoJywgeyBkOiAiTTQgMjJoMTYiICwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDM1fX0pCiAgICAsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ3BhdGgnLCB7IGQ6ICJNMTAgMTQuNjZWMTdjMCAuNTUtLjQ3Ljk4LTEuMDcgMS4yOFM3LjQgMTguNzggNyAxOUg2Yy0xLjEgMC0yLS45LTItMnYtMy4zNCIgICAgICAgLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogMzZ9fSkKICAgICwgUmVhY3QuY3JlYXRlRWxlbWVudCgncGF0aCcsIHsgZDogIk0xNCAxNC42NlYxN2MwIC41NS40Ny45OCAxLjA3IDEuMjhTMTYuNiAxOC43OCAxNyAxOWgxYzEuMSAwIDItLjkgMi0ydi0zLjM0IiAgICAgICAgICAsIF9fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiAzN319KQogICAgLCBSZWFjdC5jcmVhdGVFbGVtZW50KCdwYXRoJywgeyBkOiAiTTE4IDRINnY1YTYgNiAwIDAgMCAxMiAwVjR6IiAgICAgICAsIF9fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiAzOH19KQogICkNCik7DQpjb25zdCBDaGV2cm9uUmlnaHQgPSAocHJvcHMpID0+ICgNCiAgUmVhY3QuY3JlYXRlRWxlbWVudCgnc3ZnJywgeyB4bWxuczogImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiwgd2lkdGg6ICIyNCIsIGhlaWdodDogIjI0Iiwgdmlld0JveDogIjAgMCAyNCAyNCIgICAsIGZpbGw6ICJub25lIiwgc3Ryb2tlOiAiY3VycmVudENvbG9yIiwgc3Ryb2tlV2lkdGg6ICIyIiwgc3Ryb2tlTGluZWNhcDogInJvdW5kIiwgc3Ryb2tlTGluZWpvaW46ICJyb3VuZCIsIC4uLnByb3BzLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogNDJ9fQogICAgLCBSZWFjdC5jcmVhdGVFbGVtZW50KCdwYXRoJywgeyBkOiAibTkgMTggNi02LTYtNiIgICwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDQzfX0pCiAgKQ0KKTsNCmNvbnN0IENoZXZyb25MZWZ0ID0gKHByb3BzKSA9PiAoDQogIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ3N2ZycsIHsgeG1sbnM6ICJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIsIHdpZHRoOiAiMjQiLCBoZWlnaHQ6ICIyNCIsIHZpZXdCb3g6ICIwIDAgMjQgMjQiICAgLCBmaWxsOiAibm9uZSIsIHN0cm9rZTogImN1cnJlbnRDb2xvciIsIHN0cm9rZVdpZHRoOiAiMiIsIHN0cm9rZUxpbmVjYXA6ICJyb3VuZCIsIHN0cm9rZUxpbmVqb2luOiAicm91bmQiLCAuLi5wcm9wcywgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDQ3fX0KICAgICwgUmVhY3QuY3JlYXRlRWxlbWVudCgncGF0aCcsIHsgZDogIm0xNSAxOC02LTYgNi02IiAgLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogNDh9fSkKICApDQopOw0KY29uc3QgU3VuID0gKHByb3BzKSA9PiAoDQogIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ3N2ZycsIHsgeG1sbnM6ICJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIsIHdpZHRoOiAiMjQiLCBoZWlnaHQ6ICIyNCIsIHZpZXdCb3g6ICIwIDAgMjQgMjQiICAgLCBmaWxsOiAibm9uZSIsIHN0cm9rZTogImN1cnJlbnRDb2xvciIsIHN0cm9rZVdpZHRoOiAiMiIsIHN0cm9rZUxpbmVjYXA6ICJyb3VuZCIsIHN0cm9rZUxpbmVqb2luOiAicm91bmQiLCAuLi5wcm9wcywgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDUyfX0KICAgICwgUmVhY3QuY3JlYXRlRWxlbWVudCgnY2lyY2xlJywgeyBjeDogIjEyIiwgY3k6ICIxMiIsIHI6ICI1IiwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDUzfX0pCiAgICAsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ2xpbmUnLCB7IHgxOiAiMTIiLCB5MTogIjEiLCB4MjogIjEyIiwgeTI6ICIzIiwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDU0fX0pCiAgICAsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ2xpbmUnLCB7IHgxOiAiMTIiLCB5MTogIjIxIiwgeDI6ICIxMiIsIHkyOiAiMjMiLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogNTV9fSkKICAgICwgUmVhY3QuY3JlYXRlRWxlbWVudCgnbGluZScsIHsgeDE6ICI0LjIyIiwgeTE6ICI0LjIyIiwgeDI6ICI1LjY0IiwgeTI6ICI1LjY0IiwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDU2fX0pCiAgICAsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ2xpbmUnLCB7IHgxOiAiMTguMzYiLCB5MTogIjE4LjM2IiwgeDI6ICIxOS43OCIsIHkyOiAiMTkuNzgiLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogNTd9fSkKICAgICwgUmVhY3QuY3JlYXRlRWxlbWVudCgnbGluZScsIHsgeDE6ICIxIiwgeTE6ICIxMiIsIHgyOiAiMyIsIHkyOiAiMTIiLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogNTh9fSkKICAgICwgUmVhY3QuY3JlYXRlRWxlbWVudCgnbGluZScsIHsgeDE6ICIyMSIsIHkxOiAiMTIiLCB4MjogIjIzIiwgeTI6ICIxMiIsIF9fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiA1OX19KQogICAgLCBSZWFjdC5jcmVhdGVFbGVtZW50KCdsaW5lJywgeyB4MTogIjQuMjIiLCB5MTogIjE5Ljc4IiwgeDI6ICI1LjY0IiwgeTI6ICIxOC4zNiIsIF9fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiA2MH19KQogICAgLCBSZWFjdC5jcmVhdGVFbGVtZW50KCdsaW5lJywgeyB4MTogIjE4LjM2IiwgeTE6ICI1LjY0IiwgeDI6ICIxOS43OCIsIHkyOiAiNC4yMiIsIF9fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiA2MX19KQogICkNCik7DQpjb25zdCBNb29uID0gKHByb3BzKSA9PiAoDQogIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ3N2ZycsIHsgeG1sbnM6ICJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIsIHdpZHRoOiAiMjQiLCBoZWlnaHQ6ICIyNCIsIHZpZXdCb3g6ICIwIDAgMjQgMjQiICAgLCBmaWxsOiAibm9uZSIsIHN0cm9rZTogImN1cnJlbnRDb2xvciIsIHN0cm9rZVdpZHRoOiAiMiIsIHN0cm9rZUxpbmVjYXA6ICJyb3VuZCIsIHN0cm9rZUxpbmVqb2luOiAicm91bmQiLCAuLi5wcm9wcywgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDY1fX0KICAgICwgUmVhY3QuY3JlYXRlRWxlbWVudCgncGF0aCcsIHsgZDogIk0yMSAxMi43OUE5IDkgMCAxIDEgMTEuMjEgMyA3IDcgMCAwIDAgMjEgMTIuNzl6IiAgICAgICAgICAgICAgLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogNjZ9fSkKICApDQopOw0KDQovLyAtLS0gUmVhY3QgQ29tcG9uZW50cyAtLS0NCg0KLy8gVGFiIDE6IFNlbnNlIG9mIFNjYWxlDQpjb25zdCBTZW5zZU9mU2NhbGVUYWIgPSAoKSA9PiB7DQogIGNvbnN0IFtjdXJyZW50QWN0aXZpdHksIHNldEN1cnJlbnRBY3Rpdml0eV0gPSB1c2VTdGF0ZSgxKTsNCiAgY29uc3QgW3NlbGVjdGVkQW5zd2Vycywgc2V0U2VsZWN0ZWRBbnN3ZXJzXSA9IHVzZVN0YXRlKHt9KTsNCiAgY29uc3QgW2ZlZWRiYWNrLCBzZXRGZWVkYmFja10gPSB1c2VTdGF0ZSh7fSk7DQogIGNvbnN0IFtzaG93UmVzdWx0cywgc2V0U2hvd1Jlc3VsdHNdID0gdXNlU3RhdGUoZmFsc2UpOw0KICBjb25zdCBbY3VycmVudEl0ZW1zLCBzZXRDdXJyZW50SXRlbXNdID0gdXNlU3RhdGUoW10pOw0KICBjb25zdCBbdXNlZEl0ZW1JZHMsIHNldFVzZWRJdGVtSWRzXSA9IHVzZVN0YXRlKFtdKTsNCg0KICAvLyBTdGF0ZSBmb3IgQWN0aXZpdHkgMg0KICBjb25zdCBbbWVhc3VyZVdpZHRoLCBzZXRNZWFzdXJlV2lkdGhdID0gdXNlU3RhdGUoMCk7DQogIGNvbnN0IFtpc0RyYWdnaW5nLCBzZXRJc0RyYWdnaW5nXSA9IHVzZVN0YXRlKGZhbHNlKTsNCiAgY29uc3QgW3N0YXJ0WCwgc2V0U3RhcnRYXSA9IHVzZVN0YXRlKDApOw0KICBjb25zdCBbcm9vbU1lYXN1cmVkLCBzZXRSb29tTWVhc3VyZWRdID0gdXNlU3RhdGUoZmFsc2UpOw0KICBjb25zdCBbbWVhc3VyZUZlZWRiYWNrLCBzZXRNZWFzdXJlRmVlZGJhY2tdID0gdXNlU3RhdGUobnVsbCk7DQogIGNvbnN0IHJvb21SZWYgPSB1c2VSZWYobnVsbCk7DQoNCiAgLy8gVXNlIHVzZU1lbW8gZm9yIGFsbEl0ZW1zIHRvIHByZXZlbnQgcmUtY3JlYXRpb24NCiAgY29uc3QgYWxsSXRlbXMgPSB1c2VNZW1vKCgpID0+IFsNCiAgICB7IA0KICAgICAgaWQ6IDEsIA0KICAgICAgbmFtZTogJ1RoaWNrbmVzcyBvZiBhIHBob25lJywgDQogICAgICBjb3JyZWN0OiAnbW0nLCANCiAgICAgIGltYWdlOiAn8J+TsScsIA0KICAgICAgY29ycmVjdFZhbHVlOiAnOCBtbScsDQogICAgICB0eXBlOiAnZGlzdGFuY2UnLA0KICAgICAgd3JvbmdGZWVkYmFjazogeyANCiAgICAgICAgY206IHsgdmFsdWU6ICcwLjggY20nLCByZWFzb246ICdBd2t3YXJkIGRlY2ltYWwgLSBub3QgYXMgY2xlYXIgYXMgOCBtbScgfSwgDQogICAgICAgIG06IHsgdmFsdWU6ICcwLjAwOCBtJywgcmVhc29uOiAnV2F5IHRvbyBtYW55IHplcm9zIC0gaGFyZCB0byBwaWN0dXJlIScgfSwgDQogICAgICAgIGttOiB7IHZhbHVlOiAnMC4wMDAwMDgga20nLCByZWFzb246ICdSaWRpY3Vsb3VzbHkgdGlueSBudW1iZXIgLSBpbXBvc3NpYmxlIHRvIHZpc3VhbGl6ZSEnIH0gDQogICAgICB9IA0KICAgIH0sDQogICAgeyANCiAgICAgIGlkOiAyLCANCiAgICAgIG5hbWU6ICdIZWlnaHQgb2YgYSBwZXJzb24nLCANCiAgICAgIGNvcnJlY3Q6ICdjbScsIA0KICAgICAgaW1hZ2U6ICfwn6eNJywgDQogICAgICBjb3JyZWN0VmFsdWU6ICcxNzAgY20nLA0KICAgICAgdHlwZTogJ2Rpc3RhbmNlJywNCiAgICAgIHdyb25nRmVlZGJhY2s6IHsgDQogICAgICAgIG1tOiB7IHZhbHVlOiAnMTcwMCBtbScsIHJlYXNvbjogJ1RvbyBtYW55IGRpZ2l0cyAtIGhhcmRlciB0byByZWFkIHRoYW4gMTcwIGNtJyB9LCANCiAgICAgICAgbTogeyB2YWx1ZTogJzEuNyBtJywgcmVhc29uOiAnV29ya3MsIGJ1dCAxNzAgY20gaXMgbW9yZSBjb21tb25seSB1c2VkIGZvciBoZWlnaHQnIH0sIA0KICAgICAgICBrbTogeyB2YWx1ZTogJzAuMDAxNyBrbScsIHJlYXNvbjogJ1dheSB0b28gc21hbGwgLSBub2JvZHkgbWVhc3VyZXMgaGVpZ2h0IGluIGttIScgfSANCiAgICAgIH0gDQogICAgfSwNCiAgICB7IA0KICAgICAgaWQ6IDMsIA0KICAgICAgbmFtZTogJ0Rpc3RhbmNlIHRvIHNjaG9vbCcsIA0KICAgICAgY29ycmVjdDogJ2ttJywgDQogICAgICBpbWFnZTogJ/Cfj6snLCANCiAgICAgIGNvcnJlY3RWYWx1ZTogJzIga20nLA0KICAgICAgdHlwZTogJ2Rpc3RhbmNlJywNCiAgICAgIHdyb25nRmVlZGJhY2s6IHsgDQogICAgICAgIG1tOiB7IHZhbHVlOiAnMiwwMDAsMDAwIG1tJywgcmVhc29uOiAnSHVnZSBudW1iZXIgLSBpbXBvc3NpYmxlIHRvIGltYWdpbmUhJyB9LCANCiAgICAgICAgY206IHsgdmFsdWU6ICcyMDAsMDAwIGNtJywgcmVhc29uOiAnU3RpbGwgdG9vIGxhcmdlIGEgbnVtYmVyIHRvIGJlIHByYWN0aWNhbCEnIH0sIA0KICAgICAgICBtOiB7IHZhbHVlOiAnMjAwMCBtJywgcmVhc29uOiAnQmlnIG51bWJlciAtIG11Y2ggbmljZXIgYXMgMiBrbSEnIH0gDQogICAgICB9IA0KICAgIH0sDQogICAgeyANCiAgICAgIGlkOiA0LCANCiAgICAgIG5hbWU6ICdMZW5ndGggb2YgYSBwZW4nLCANCiAgICAgIGNvcnJlY3Q6ICdjbScsIA0KICAgICAgaW1hZ2U6ICfinI/vuI8nLCANCiAgICAgIGNvcnJlY3RWYWx1ZTogJzE1IGNtJywNCiAgICAgIHR5cGU6ICdkaXN0YW5jZScsDQogICAgICB3cm9uZ0ZlZWRiYWNrOiB7IA0KICAgICAgICBtbTogeyB2YWx1ZTogJzE1MCBtbScsIHJlYXNvbjogJ1dvcmtzIGJ1dCBjbSBpcyBtb3JlIHN0YW5kYXJkIGZvciBwZW4gbGVuZ3RoJyB9LCANCiAgICAgICAgbTogeyB2YWx1ZTogJzAuMTUgbScsIHJlYXNvbjogJ0F3a3dhcmQgZGVjaW1hbCAtIG5vdCBhcyBjbGVhciBhcyAxNSBjbScgfSwgDQogICAgICAgIGttOiB7IHZhbHVlOiAnMC4wMDAxNSBrbScsIHJlYXNvbjogJ0Fic3VyZGx5IHNtYWxsIG51bWJlciEnIH0gDQogICAgICB9IA0KICAgIH0sDQogICAgeyANCiAgICAgIGlkOiA1LCANCiAgICAgIG5hbWU6ICdNZWRpY2luZSBkb3NlJywgDQogICAgICBjb3JyZWN0OiAnbWcnLCANCiAgICAgIGltYWdlOiAn8J+SiicsIA0KICAgICAgY29ycmVjdFZhbHVlOiAnNTAwIG1nJywNCiAgICAgIHR5cGU6ICdtYXNzJywNCiAgICAgIHdyb25nRmVlZGJhY2s6IHsgDQogICAgICAgIGc6IHsgdmFsdWU6ICcwLjUgZycsIHJlYXNvbjogJ0RlY2ltYWwgbWFrZXMgaXQgbGVzcyBjbGVhciB0aGFuIDUwMCBtZycgfSwgDQogICAgICAgIGtnOiB7IHZhbHVlOiAnMC4wMDA1IGtnJywgcmVhc29uOiAnV2F5IHRvbyBzbWFsbCAtIGltcG9zc2libGUgdG8gd29yayB3aXRoIScgfSwgDQogICAgICAgIG1MOiB7IHZhbHVlOiAnTi9BJywgcmVhc29uOiAnVGhhdCBtZWFzdXJlcyB2b2x1bWUsIG5vdCBtYXNzIScgfSANCiAgICAgIH0gDQogICAgfSwNCiAgICB7IA0KICAgICAgaWQ6IDYsIA0KICAgICAgbmFtZTogJ0Nvb2tpbmcgb2lsIGluIHJlY2lwZScsIA0KICAgICAgY29ycmVjdDogJ21MJywgDQogICAgICBpbWFnZTogJ/Cfp4gnLCANCiAgICAgIGNvcnJlY3RWYWx1ZTogJzI1MCBtTCcsDQogICAgICB0eXBlOiAndm9sdW1lJywNCiAgICAgIHdyb25nRmVlZGJhY2s6IHsgDQogICAgICAgIEw6IHsgdmFsdWU6ICcwLjI1IEwnLCByZWFzb246ICdBd2t3YXJkIGRlY2ltYWwgLSBlYXNpZXIgdG8gc2F5IDI1MCBtTCcgfSwgDQogICAgICAgIG1nOiB7IHZhbHVlOiAnTi9BJywgcmVhc29uOiAnVGhhdCBtZWFzdXJlcyBtYXNzLCBub3Qgdm9sdW1lIScgfSwgDQogICAgICAgIGc6IHsgdmFsdWU6ICdOL0EnLCByZWFzb246ICdMaXF1aWRzIGFyZSBtZWFzdXJlZCBieSB2b2x1bWUgaW4gY29va2luZyEnIH0gDQogICAgICB9IA0KICAgIH0sDQogICAgeyANCiAgICAgIGlkOiA3LCANCiAgICAgIG5hbWU6ICdNYXJhdGhvbiB0aW1lJywgDQogICAgICBjb3JyZWN0OiAnaG91cnMnLCANCiAgICAgIGltYWdlOiAn8J+PgycsIA0KICAgICAgY29ycmVjdFZhbHVlOiAnMyBob3VycycsDQogICAgICB0eXBlOiAndGltZScsDQogICAgICB3cm9uZ0ZlZWRiYWNrOiB7IA0KICAgICAgICBzZWNvbmRzOiB7IHZhbHVlOiAnMTAsODAwIHNlY29uZHMnLCByZWFzb246ICdIdWdlIG51bWJlciAtIHRvbyBoYXJkIHRvIHBpY3R1cmUhJyB9LCANCiAgICAgICAgbWludXRlczogeyB2YWx1ZTogJzE4MCBtaW51dGVzJywgcmVhc29uOiAnTGFyZ2UgbnVtYmVyIC0gbXVjaCBjbGVhcmVyIGFzIDMgaG91cnMnIH0sIA0KICAgICAgICBkYXlzOiB7IHZhbHVlOiAnMC4xMjUgZGF5cycsIHJlYXNvbjogJ1dlaXJkIGRlY2ltYWwgLSBub3QgcHJhY3RpY2FsIScgfSwNCiAgICAgICAgbXM6IHsgdmFsdWU6ICcxMCw4MDAsMDAwIG1zJywgcmVhc29uOiAnQWJzdXJkbHkgaHVnZSBudW1iZXIhJyB9DQogICAgICB9IA0KICAgIH0sDQogICAgeyANCiAgICAgIGlkOiA4LCANCiAgICAgIG5hbWU6ICdCbGluayBvZiBhbiBleWUnLCANCiAgICAgIGNvcnJlY3Q6ICdtcycsIA0KICAgICAgaW1hZ2U6ICfwn5GB77iPJywgDQogICAgICBjb3JyZWN0VmFsdWU6ICczMDAgbXMnLA0KICAgICAgdHlwZTogJ3RpbWUnLA0KICAgICAgd3JvbmdGZWVkYmFjazogeyANCiAgICAgICAgc2Vjb25kczogeyB2YWx1ZTogJzAuMyBzZWNvbmRzJywgcmVhc29uOiAnRGVjaW1hbCAtIG1pbGxpc2Vjb25kcyBhcmUgbW9yZSBwcmVjaXNlJyB9LCANCiAgICAgICAgbWludXRlczogeyB2YWx1ZTogJzAuMDA1IG1pbnV0ZXMnLCByZWFzb246ICdBYnN1cmRseSBzbWFsbCBkZWNpbWFsIScgfSwgDQogICAgICAgIGhvdXJzOiB7IHZhbHVlOiAnMC4wMDAwODMgaG91cnMnLCByZWFzb246ICdJbXBvc3NpYmxlIHRvIHZpc3VhbGl6ZSEnIH0sDQogICAgICAgIGRheXM6IHsgdmFsdWU6ICcwLjAwMDAwMzUgZGF5cycsIHJlYXNvbjogJ1JpZGljdWxvdXNseSB0aW55IG51bWJlciEnIH0NCiAgICAgIH0gDQogICAgfSwNCiAgICB7IA0KICAgICAgaWQ6IDksIA0KICAgICAgbmFtZTogJ1dpZHRoIG9mIGEgZmluZ2VybmFpbCcsIA0KICAgICAgY29ycmVjdDogJ21tJywgDQogICAgICBpbWFnZTogJ/CfkoUnLCANCiAgICAgIGNvcnJlY3RWYWx1ZTogJzEwIG1tJywNCiAgICAgIHR5cGU6ICdkaXN0YW5jZScsDQogICAgICB3cm9uZ0ZlZWRiYWNrOiB7IA0KICAgICAgICBjbTogeyB2YWx1ZTogJzEgY20nLCByZWFzb246ICdXb3JrcywgYnV0IG1tIGlzIG1vcmUgcHJlY2lzZSBmb3Igc21hbGwgaXRlbXMnIH0sIA0KICAgICAgICBtOiB7IHZhbHVlOiAnMC4wMSBtJywgcmVhc29uOiAnVGlueSBkZWNpbWFsIC0gaGFyZCB0byB2aXN1YWxpemUhJyB9LCANCiAgICAgICAga206IHsgdmFsdWU6ICcwLjAwMDAxIGttJywgcmVhc29uOiAnQWJzdXJkbHkgc21hbGwgbnVtYmVyIScgfSANCiAgICAgIH0gDQogICAgfSwNCiAgICB7IA0KICAgICAgaWQ6IDEwLCANCiAgICAgIG5hbWU6ICdXZWlnaHQgb2YgYSBjYXInLCANCiAgICAgIGNvcnJlY3Q6ICdrZycsIA0KICAgICAgaW1hZ2U6ICfwn5qXJywgDQogICAgICBjb3JyZWN0VmFsdWU6ICcxNTAwIGtnJywNCiAgICAgIHR5cGU6ICdtYXNzJywNCiAgICAgIHdyb25nRmVlZGJhY2s6IHsgDQogICAgICAgIG1nOiB7IHZhbHVlOiAnMSw1MDAsMDAwLDAwMCBtZycsIHJlYXNvbjogJ0ltcG9zc2libHkgaHVnZSBudW1iZXIhJyB9LCANCiAgICAgICAgZzogeyB2YWx1ZTogJzEsNTAwLDAwMCBnJywgcmVhc29uOiAnU3RpbGwgd2F5IHRvbyBtYW55IGRpZ2l0cyEnIH0gDQogICAgICB9IA0KICAgIH0sDQogICAgeyANCiAgICAgIGlkOiAxMSwgDQogICAgICBuYW1lOiAnTW92aWUgcnVudGltZScsIA0KICAgICAgY29ycmVjdDogJ21pbnV0ZXMnLCANCiAgICAgIGltYWdlOiAn8J+OrCcsIA0KICAgICAgY29ycmVjdFZhbHVlOiAnMTIwIG1pbnV0ZXMnLA0KICAgICAgdHlwZTogJ3RpbWUnLA0KICAgICAgd3JvbmdGZWVkYmFjazogeyANCiAgICAgICAgc2Vjb25kczogeyB2YWx1ZTogJzcyMDAgc2Vjb25kcycsIHJlYXNvbjogJ0xhcmdlIG51bWJlciAtIGVhc2llciBhcyAxMjAgbWludXRlcycgfSwgDQogICAgICAgIGhvdXJzOiB7IHZhbHVlOiAnMiBob3VycycsIHJlYXNvbjogJ1dvcmtzIHdlbGwgdG9vISBNaW51dGVzIGFyZSBhbHNvIGNvbW1vbicgfSwgDQogICAgICAgIG1zOiB7IHZhbHVlOiAnNywyMDAsMDAwIG1zJywgcmVhc29uOiAnQWJzdXJkbHkgaHVnZSBudW1iZXIhJyB9LA0KICAgICAgICBkYXlzOiB7IHZhbHVlOiAnMC4wODMgZGF5cycsIHJlYXNvbjogJ1N0cmFuZ2UgZGVjaW1hbCEnIH0NCiAgICAgIH0gDQogICAgfSwNCiAgICB7IA0KICAgICAgaWQ6IDEyLCANCiAgICAgIG5hbWU6ICdTd2ltbWluZyBwb29sIHZvbHVtZScsIA0KICAgICAgY29ycmVjdDogJ0wnLCANCiAgICAgIGltYWdlOiAn8J+PiicsIA0KICAgICAgY29ycmVjdFZhbHVlOiAnNTAwMDAgTCcsDQogICAgICB0eXBlOiAndm9sdW1lJywNCiAgICAgIHdyb25nRmVlZGJhY2s6IHsgDQogICAgICAgIG1MOiB7IHZhbHVlOiAnNTAsMDAwLDAwMCBtTCcsIHJlYXNvbjogJ1dheSB0b28gbWFueSB6ZXJvcyEnIH0gDQogICAgICB9IA0KICAgIH0sDQogICAgeyANCiAgICAgIGlkOiAxMywgDQogICAgICBuYW1lOiAnRXJhc2VyIHRoaWNrbmVzcycsIA0KICAgICAgY29ycmVjdDogJ21tJywgDQogICAgICBpbWFnZTogJ/Cfp70nLCANCiAgICAgIGNvcnJlY3RWYWx1ZTogJzEyIG1tJywNCiAgICAgIHR5cGU6ICdkaXN0YW5jZScsDQogICAgICB3cm9uZ0ZlZWRiYWNrOiB7IA0KICAgICAgICBjbTogeyB2YWx1ZTogJzEuMiBjbScsIHJlYXNvbjogJ0RlY2ltYWwgbWFrZXMgaXQgbGVzcyBjbGVhciB0aGFuIDEyIG1tJyB9LCANCiAgICAgICAgbTogeyB2YWx1ZTogJzAuMDEyIG0nLCByZWFzb246ICdUb28gbWFueSB6ZXJvcyEnIH0sIA0KICAgICAgICBrbTogeyB2YWx1ZTogJzAuMDAwMDEyIGttJywgcmVhc29uOiAnUmlkaWN1bG91c2x5IHRpbnkhJyB9IA0KICAgICAgfSANCiAgICB9LA0KICAgIHsgDQogICAgICBpZDogMTQsIA0KICAgICAgbmFtZTogJ1NsZWVwaW5nIHRpbWUnLCANCiAgICAgIGNvcnJlY3Q6ICdob3VycycsIA0KICAgICAgaW1hZ2U6ICfwn5i0JywgDQogICAgICBjb3JyZWN0VmFsdWU6ICc4IGhvdXJzJywNCiAgICAgIHR5cGU6ICd0aW1lJywNCiAgICAgIHdyb25nRmVlZGJhY2s6IHsgDQogICAgICAgIHNlY29uZHM6IHsgdmFsdWU6ICcyOCw4MDAgc2Vjb25kcycsIHJlYXNvbjogJ0h1Z2UgbnVtYmVyIC0gaW1wb3NzaWJsZSB0byBwaWN0dXJlIScgfSwgDQogICAgICAgIG1pbnV0ZXM6IHsgdmFsdWU6ICc0ODAgbWludXRlcycsIHJlYXNvbjogJ0xhcmdlIG51bWJlciAtIGJldHRlciBhcyA4IGhvdXJzIScgfSwgDQogICAgICAgIG1zOiB7IHZhbHVlOiAnMjgsODAwLDAwMCBtcycsIHJlYXNvbjogJ0Fic3VyZGx5IGh1Z2UhJyB9LA0KICAgICAgICBkYXlzOiB7IHZhbHVlOiAnMC4zMyBkYXlzJywgcmVhc29uOiAnV2VpcmQgZnJhY3Rpb24hJyB9DQogICAgICB9IA0KICAgIH0sDQogICAgeyANCiAgICAgIGlkOiAxNSwgDQogICAgICBuYW1lOiAnV2VpZ2h0IG9mIGFuIGFwcGxlJywgDQogICAgICBjb3JyZWN0OiAnZycsIA0KICAgICAgaW1hZ2U6ICfwn42OJywgDQogICAgICBjb3JyZWN0VmFsdWU6ICcxODAgZycsDQogICAgICB0eXBlOiAnbWFzcycsDQogICAgICB3cm9uZ0ZlZWRiYWNrOiB7IA0KICAgICAgICBtZzogeyB2YWx1ZTogJzE4MCwwMDAgbWcnLCByZWFzb246ICdUb28gbWFueSBkaWdpdHMhJyB9LCANCiAgICAgICAga2c6IHsgdmFsdWU6ICcwLjE4IGtnJywgcmVhc29uOiAnQXdrd2FyZCBkZWNpbWFsIC0gZWFzaWVyIGFzIDE4MCBnJyB9IA0KICAgICAgfSANCiAgICB9LA0KICBdLCBbXSk7DQoNCiAgLy8gVXNlIHVzZUNhbGxiYWNrIGZvciBmdW5jdGlvbnMNCiAgY29uc3QgZ2VuZXJhdGVOZXdFeGFtcGxlcyA9IHVzZUNhbGxiYWNrKCgpID0+IHsNCiAgICAvLyBHZXQgaXRlbXMgdGhhdCBoYXZlbid0IGJlZW4gdXNlZCB5ZXQNCiAgICBjb25zdCBhdmFpbGFibGVJdGVtcyA9IGFsbEl0ZW1zLmZpbHRlcihpdGVtID0+ICF1c2VkSXRlbUlkcy5pbmNsdWRlcyhpdGVtLmlkKSk7DQogICAgDQogICAgLy8gSWYgd2UndmUgdXNlZCBhbGwgaXRlbXMsIHJlc2V0IHRoZSB1c2VkIGxpc3QNCiAgICBpZiAoYXZhaWxhYmxlSXRlbXMubGVuZ3RoIDwgMykgew0KICAgICAgc2V0VXNlZEl0ZW1JZHMoW10pOw0KICAgICAgY29uc3Qgc2h1ZmZsZWQgPSBbLi4uYWxsSXRlbXNdLnNvcnQoKCkgPT4gTWF0aC5yYW5kb20oKSAtIDAuNSk7DQogICAgICBjb25zdCBzZWxlY3RlZCA9IHNodWZmbGVkLnNsaWNlKDAsIDMpOw0KICAgICAgc2V0Q3VycmVudEl0ZW1zKHNlbGVjdGVkKTsNCiAgICAgIHNldFVzZWRJdGVtSWRzKHNlbGVjdGVkLm1hcChpdGVtID0+IGl0ZW0uaWQpKTsNCiAgICB9IGVsc2Ugew0KICAgICAgLy8gU2h1ZmZsZSBhdmFpbGFibGUgaXRlbXMgYW5kIHRha2UgMw0KICAgICAgY29uc3Qgc2h1ZmZsZWQgPSBbLi4uYXZhaWxhYmxlSXRlbXNdLnNvcnQoKCkgPT4gTWF0aC5yYW5kb20oKSAtIDAuNSk7DQogICAgICBjb25zdCBzZWxlY3RlZCA9IHNodWZmbGVkLnNsaWNlKDAsIDMpOw0KICAgICAgc2V0Q3VycmVudEl0ZW1zKHNlbGVjdGVkKTsNCiAgICAgIHNldFVzZWRJdGVtSWRzKHByZXYgPT4gWy4uLnByZXYsIC4uLnNlbGVjdGVkLm1hcChpdGVtID0+IGl0ZW0uaWQpXSk7DQogICAgfQ0KICAgIA0KICAgIHNldFNlbGVjdGVkQW5zd2Vycyh7fSk7DQogICAgc2V0RmVlZGJhY2soe30pOw0KICAgIHNldFNob3dSZXN1bHRzKGZhbHNlKTsNCiAgfSwgW2FsbEl0ZW1zLCB1c2VkSXRlbUlkc10pOw0KDQogIC8vIEluaXRpYWxpemUgd2l0aCByYW5kb20gMyBpdGVtcyBvbiBmaXJzdCBsb2FkDQogIHVzZUVmZmVjdCgoKSA9PiB7DQogICAgaWYgKGN1cnJlbnRJdGVtcy5sZW5ndGggPT09IDApIHsNCiAgICAgIGdlbmVyYXRlTmV3RXhhbXBsZXMoKTsNCiAgICB9DQogIH0sIFtjdXJyZW50SXRlbXMsIGdlbmVyYXRlTmV3RXhhbXBsZXNdKTsNCg0KICBjb25zdCB1bml0T3B0aW9ucyA9IHVzZU1lbW8oKCkgPT4gKHsNCiAgICBkaXN0YW5jZTogWydtbScsICdjbScsICdtJywgJ2ttJ10sDQogICAgbWFzczogWydtZycsICdnJywgJ2tnJ10sDQogICAgdm9sdW1lOiBbJ21MJywgJ0wnXSwNCiAgICB0aW1lOiBbJ21zJywgJ3NlY29uZHMnLCAnbWludXRlcycsICdob3VycycsICdkYXlzJ10NCiAgfSksIFtdKTsNCg0KICBjb25zdCBnZXRVbml0VHlwZSA9IHVzZUNhbGxiYWNrKCh1bml0KSA9PiB7DQogICAgZm9yIChjb25zdCBbdHlwZSwgdW5pdHNdIG9mIE9iamVjdC5lbnRyaWVzKHVuaXRPcHRpb25zKSkgew0KICAgICAgaWYgKHVuaXRzLmluY2x1ZGVzKHVuaXQpKSByZXR1cm4gdHlwZTsNCiAgICB9DQogICAgcmV0dXJuIG51bGw7DQogIH0sIFt1bml0T3B0aW9uc10pOw0KDQogIGNvbnN0IGhhbmRsZUFuc3dlciA9IChpdGVtSWQsIHVuaXQpID0+IHsNCiAgICAvLyBBY3Rpdml0eSAxOiBJbW1lZGlhdGUgZmVlZGJhY2sNCiAgICBjb25zdCBpdGVtID0gY3VycmVudEl0ZW1zLmZpbmQoaSA9PiBpLmlkID09PSBpdGVtSWQpOw0KICAgIHNldFNlbGVjdGVkQW5zd2VycyhwcmV2ID0+ICh7IC4uLnByZXYsIFtpdGVtSWRdOiB1bml0IH0pKTsNCiAgICANCiAgICBjb25zdCB1bml0VHlwZSA9IGdldFVuaXRUeXBlKHVuaXQpOw0KICAgIA0KICAgIC8vIENoZWNrIGlmIHdyb25nIHR5cGUgb2YgdW5pdCBlbnRpcmVseQ0KICAgIGlmICh1bml0VHlwZSAhPT0gaXRlbS50eXBlKSB7DQogICAgICBjb25zdCB0eXBlTmFtZXMgPSB7DQogICAgICAgIGRpc3RhbmNlOiAnZGlzdGFuY2UvbGVuZ3RoJywNCiAgICAgICAgbWFzczogJ21hc3Mvd2VpZ2h0JywNCiAgICAgICAgdm9sdW1lOiAndm9sdW1lJywNCiAgICAgICAgdGltZTogJ3RpbWUnDQogICAgICB9Ow0KICAgICAgc2V0RmVlZGJhY2socHJldiA9PiAoeyANCiAgICAgICAgLi4ucHJldiwgDQogICAgICAgIFtpdGVtSWRdOiB7IA0KICAgICAgICAgIGNvcnJlY3Q6IGZhbHNlLCANCiAgICAgICAgICB3cm9uZ1R5cGU6IHRydWUsDQogICAgICAgICAgbWVzc2FnZTogYFdhaXQhICR7dW5pdH0gbWVhc3VyZXMgJHt0eXBlTmFtZXNbdW5pdFR5cGVdfSwgYnV0IHlvdSBuZWVkIHRvIG1lYXN1cmUgJHt0eXBlTmFtZXNbaXRlbS50eXBlXX0gaGVyZS4gVHJ5IGEgZGlmZmVyZW50IHR5cGUgb2YgdW5pdCFgIA0KICAgICAgICB9IA0KICAgICAgfSkpOw0KICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICANCiAgICAvLyBHaXZlIGltbWVkaWF0ZSBmZWVkYmFjayBmb3IgY29ycmVjdCB0eXBlIGJ1dCB3cm9uZyBzaXplDQogICAgaWYgKHVuaXQgPT09IGl0ZW0uY29ycmVjdCkgew0KICAgICAgc2V0RmVlZGJhY2socHJldiA9PiAoeyANCiAgICAgICAgLi4ucHJldiwgDQogICAgICAgIFtpdGVtSWRdOiB7IA0KICAgICAgICAgIGNvcnJlY3Q6IHRydWUsIA0KICAgICAgICAgIG1lc3NhZ2U6IGBQZXJmZWN0ISAke2l0ZW0uY29ycmVjdFZhbHVlfSBpcyBjbGVhciBhbmQgZWFzeSB0byB1bmRlcnN0YW5kLmAgDQogICAgICAgIH0gDQogICAgICB9KSk7DQogICAgfSBlbHNlIGlmIChpdGVtLndyb25nRmVlZGJhY2tbdW5pdF0pIHsNCiAgICAgIHNldEZlZWRiYWNrKHByZXYgPT4gKHsgDQogICAgICAgIC4uLnByZXYsIA0KICAgICAgICBbaXRlbUlkXTogeyANCiAgICAgICAgICBjb3JyZWN0OiBmYWxzZSwgDQogICAgICAgICAgdmFsdWU6IGl0ZW0ud3JvbmdGZWVkYmFja1t1bml0XS52YWx1ZSwNCiAgICAgICAgICBtZXNzYWdlOiBpdGVtLndyb25nRmVlZGJhY2tbdW5pdF0ucmVhc29uDQogICAgICAgIH0gDQogICAgICB9KSk7DQogICAgfSBlbHNlIHsNCiAgICAgIC8vIFRoaXMgY2FzZSBzaG91bGQgYmUgcmFyZSBkdWUgdG8gdGhlIGZsYXQgbGlzdCBvZiBhbGwgdW5pdHMNCiAgICAgIHNldEZlZWRiYWNrKHByZXYgPT4gKHsgDQogICAgICAgIC4uLnByZXYsIA0KICAgICAgICBbaXRlbUlkXTogeyANCiAgICAgICAgICBjb3JyZWN0OiBmYWxzZSwgDQogICAgICAgICAgd3JvbmdUeXBlOiB0cnVlLA0KICAgICAgICAgIG1lc3NhZ2U6IGBUaGF0J3MgdGhlIHdyb25nIHR5cGUgb2YgbWVhc3VyZW1lbnQhYA0KICAgICAgICB9IA0KICAgICAgfSkpOw0KICAgIH0NCiAgfTsNCiAgDQogIC8vIC0tLSBBY3Rpdml0eSAyIEhhbmRsZXJzIC0tLQ0KICBjb25zdCBnZXRSb29tV2lkdGggPSAoKSA9PiB7DQogICAgcmV0dXJuIHJvb21SZWYuY3VycmVudCA/IHJvb21SZWYuY3VycmVudC5vZmZzZXRXaWR0aCA6IDA7DQogIH07DQoNCiAgY29uc3QgaGFuZGxlTWVhc3VyZVN0YXJ0ID0gKGUpID0+IHsNCiAgICBpZiAocm9vbU1lYXN1cmVkKSByZXR1cm47DQogICAgc2V0SXNEcmFnZ2luZyh0cnVlKTsNCiAgICBjb25zdCBjbGllbnRYID0gZS50b3VjaGVzID8gZS50b3VjaGVzWzBdLmNsaWVudFggOiBlLmNsaWVudFg7DQogICAgc2V0U3RhcnRYKGNsaWVudFggLSByb29tUmVmLmN1cnJlbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkubGVmdCk7DQogICAgc2V0TWVhc3VyZVdpZHRoKDApOyAvLyBSZXNldCBvbiBuZXcgZHJhZw0KICB9Ow0KDQogIGNvbnN0IGhhbmRsZU1lYXN1cmVNb3ZlID0gKGUpID0+IHsNCiAgICBpZiAoIWlzRHJhZ2dpbmcgfHwgcm9vbU1lYXN1cmVkKSByZXR1cm47DQogICAgY29uc3QgY2xpZW50WCA9IGUudG91Y2hlcyA/IGUudG91Y2hlc1swXS5jbGllbnRYIDogZS5jbGllbnRYOw0KICAgIGNvbnN0IHJvb21SZWN0ID0gcm9vbVJlZi5jdXJyZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOw0KICAgIGNvbnN0IHJvb21XaWR0aCA9IHJvb21SZWN0LndpZHRoOw0KICAgIGxldCBjdXJyZW50WCA9IGNsaWVudFggLSByb29tUmVjdC5sZWZ0Ow0KICAgIGxldCB3aWR0aCA9IGN1cnJlbnRYIC0gc3RhcnRYOw0KICAgIA0KICAgIGlmICh3aWR0aCA8IDApIHdpZHRoID0gMDsNCiAgICBpZiAod2lkdGggPiByb29tV2lkdGgpIHdpZHRoID0gcm9vbVdpZHRoOw0KICAgIA0KICAgIHNldE1lYXN1cmVXaWR0aCh3aWR0aCk7DQogIH07DQoNCiAgY29uc3QgaGFuZGxlTWVhc3VyZUVuZCA9ICgpID0+IHsNCiAgICBpZiAoIWlzRHJhZ2dpbmcpIHJldHVybjsNCiAgICBzZXRJc0RyYWdnaW5nKGZhbHNlKTsNCiAgICBjb25zdCByb29tV2lkdGggPSBnZXRSb29tV2lkdGgoKTsNCiAgICBjb25zdCB0b2xlcmFuY2UgPSAyMDsgLy8gMjBweCB0b2xlcmFuY2UNCiAgICANCiAgICBpZiAobWVhc3VyZVdpZHRoID49IHJvb21XaWR0aCAtIHRvbGVyYW5jZSkgew0KICAgICAgc2V0TWVhc3VyZVdpZHRoKHJvb21XaWR0aCk7IC8vIFNuYXAgdG8gZnVsbCB3aWR0aA0KICAgICAgc2V0Um9vbU1lYXN1cmVkKHRydWUpOw0KICAgICAgc2V0TWVhc3VyZUZlZWRiYWNrKG51bGwpOyAvLyBDbGVhciBhbnkgImtlZXAgZHJhZ2dpbmciIGZlZWRiYWNrDQogICAgfSBlbHNlIHsNCiAgICAgIHNldE1lYXN1cmVGZWVkYmFjayh7IHR5cGU6ICd3YXJuJywgbWVzc2FnZTogJ05vdCBxdWl0ZSEgS2VlcCBkcmFnZ2luZyB0byBtZWFzdXJlIHRoZSB3aG9sZSB3aWR0aC4nIH0pOw0KICAgIH0NCiAgfTsNCg0KICBjb25zdCBoYW5kbGVVbml0Q2hvaWNlID0gKGNob2ljZSkgPT4gew0KICAgIGlmICghcm9vbU1lYXN1cmVkKSByZXR1cm47DQogICAgaWYgKGNob2ljZS5jb3JyZWN0KSB7DQogICAgICBzZXRNZWFzdXJlRmVlZGJhY2soeyB0eXBlOiAnZ29vZCcsIG1lc3NhZ2U6IGBQZXJmZWN0ISAiJHtjaG9pY2UudmFsdWV9IiBpcyB2ZXJ5IGNsZWFyIGFuZCBlYXN5IHRvIHVuZGVyc3RhbmQuYCB9KTsNCiAgICB9IGVsc2Ugew0KICAgICAgc2V0TWVhc3VyZUZlZWRiYWNrKHsgdHlwZTogJ2JhZCcsIG1lc3NhZ2U6IGNob2ljZS5leHBsYW5hdGlvbiB9KTsNCiAgICB9DQogIH07DQoNCiAgY29uc3QgcmVzZXRBY3Rpdml0eTIgPSAoKSA9PiB7DQogICAgc2V0TWVhc3VyZVdpZHRoKDApOw0KICAgIHNldElzRHJhZ2dpbmcoZmFsc2UpOw0KICAgIHNldFJvb21NZWFzdXJlZChmYWxzZSk7DQogICAgc2V0TWVhc3VyZUZlZWRiYWNrKG51bGwpOw0KICB9Ow0KICANCiAgLy8gLS0tIFJlbmRlciBMb2dpYyAtLS0NCg0KICBpZiAoY3VycmVudEFjdGl2aXR5ID09PSAxKSB7DQogICAgY29uc3QgYWxsQW5zd2VyZWQgPSBPYmplY3Qua2V5cyhzZWxlY3RlZEFuc3dlcnMpLmxlbmd0aCA9PT0gY3VycmVudEl0ZW1zLmxlbmd0aDsNCg0KICAgIHJldHVybiAoDQogICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCdkaXYnLCB7X19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDQ1NX19CiAgICAgICAgLCBSZWFjdC5jcmVhdGVFbGVtZW50KCdoMicsIHsgY2xhc3NOYW1lOiAidGV4dC0yeGwgZm9udC1ib2xkIG1iLTQgdGV4dC1ibHVlLTQwMCIgICAsIF9fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiA0NTZ9fSwgIkFjdGl2aXR5IDE6IENob29zZSB0aGUgUmlnaHQgVW5pdCIgICAgICkKICAgICAgICAsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ3AnLCB7IGNsYXNzTmFtZTogInRleHQtZ3JheS0zMDAgbWItNiIgLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogNDU3fX0sICJTZWxlY3QgdGhlIG1vc3QgYXBwcm9wcmlhdGUgdW5pdCBmb3IgbWVhc3VyaW5nIGVhY2ggaXRlbS4gVGhpbmsgYWJvdXQgd2hpY2ggdW5pdCBtYWtlcyB0aGUgbnVtYmVyIGVhc2llc3QgdG8gdW5kZXJzdGFuZCEiICAgICAgICAgICAgICAgICAgKQoKICAgICAgICAsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ2RpdicsIHsgY2xhc3NOYW1lOiAiZ3JpZCBncmlkLWNvbHMtMSBtZDpncmlkLWNvbHMtMyBnYXAtNiBtYi02IiAgICAsIF9fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiA0NTl9fQogICAgICAgICAgLCBjdXJyZW50SXRlbXMubWFwKGl0ZW0gPT4gKA0KICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgnZGl2JywgeyBrZXk6IGl0ZW0uaWQsIGNsYXNzTmFtZTogImJnLWdyYXktNzAwIHJvdW5kZWQtbGcgcC02IiAgLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogNDYxfX0KICAgICAgICAgICAgICAsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ2RpdicsIHsgY2xhc3NOYW1lOiAidGV4dC01eGwgbWItMyB0ZXh0LWNlbnRlciIgICwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDQ2Mn19LCBpdGVtLmltYWdlKQogICAgICAgICAgICAgICwgUmVhY3QuY3JlYXRlRWxlbWVudCgnaDMnLCB7IGNsYXNzTmFtZTogInRleHQtbGcgZm9udC1zZW1pYm9sZCBtYi0zIHRleHQtY2VudGVyIiAgICwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDQ2M319LCBpdGVtLm5hbWUpCiAgICAgICAgICAgICAgLCBSZWFjdC5jcmVhdGVFbGVtZW50KCdkaXYnLCB7IGNsYXNzTmFtZTogImZsZXggZmxleC13cmFwIGdhcC0yIGp1c3RpZnktY2VudGVyIiAgICwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDQ2NH19CiAgICAgICAgICAgICAgICAsIE9iamVjdC52YWx1ZXModW5pdE9wdGlvbnMpLmZsYXQoKS5maWx0ZXIoKHYsIGksIGEpID0+IGEuaW5kZXhPZih2KSA9PT0gaSkubWFwKHVuaXQgPT4gKA0KICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgnYnV0dG9uJywgew0KICAgICAgICAgICAgICAgICAgICBrZXk6IHVuaXQsDQogICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s6ICgpID0+IGhhbmRsZUFuc3dlcihpdGVtLmlkLCB1bml0KSwNCiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lOiBgcHgtNCBweS0yIHJvdW5kZWQtbGcgZm9udC1zZW1pYm9sZCB0cmFuc2l0aW9uLWFsbCAkew0KICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkQW5zd2Vyc1tpdGVtLmlkXSA9PT0gdW5pdA0KICAgICAgICAgICAgICAgICAgICAgICAgPyBfb3B0aW9uYWxDaGFpbihbZmVlZGJhY2ssICdhY2Nlc3MnLCBfMiA9PiBfMltpdGVtLmlkXSwgJ29wdGlvbmFsQWNjZXNzJywgXzMgPT4gXzMuY29ycmVjdF0pDQogICAgICAgICAgICAgICAgICAgICAgICAgID8gJ2JnLWdyZWVuLTYwMCB0ZXh0LXdoaXRlJw0KICAgICAgICAgICAgICAgICAgICAgICAgICA6IF9vcHRpb25hbENoYWluKFtmZWVkYmFjaywgJ2FjY2VzcycsIF80ID0+IF80W2l0ZW0uaWRdLCAnb3B0aW9uYWxBY2Nlc3MnLCBfNSA9PiBfNS5jb3JyZWN0XSkgPT09IGZhbHNlDQogICAgICAgICAgICAgICAgICAgICAgICAgID8gX29wdGlvbmFsQ2hhaW4oW2ZlZWRiYWNrLCAnYWNjZXNzJywgXzYgPT4gXzZbaXRlbS5pZF0sICdvcHRpb25hbEFjY2VzcycsIF83ID0+IF83Lndyb25nVHlwZV0pDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPyAnYmctcmVkLTYwMCB0ZXh0LXdoaXRlJw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogJ2JnLW9yYW5nZS02MDAgdGV4dC13aGl0ZScNCiAgICAgICAgICAgICAgICAgICAgICAgICAgOiAnYmctYmx1ZS02MDAgdGV4dC13aGl0ZScNCiAgICAgICAgICAgICAgICAgICAgICAgIDogJ2JnLWdyYXktNjAwIHRleHQtZ3JheS0yMDAgaG92ZXI6YmctZ3JheS01MDAnDQogICAgICAgICAgICAgICAgICAgIH0gY3Vyc29yLXBvaW50ZXJgLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogNDY2fX0NCgogICAgICAgICAgICAgICAgICAgICwgdW5pdAogICAgICAgICAgICAgICAgICApDQogICAgICAgICAgICAgICAgKSkKICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgLCBmZWVkYmFja1tpdGVtLmlkXSAmJiAoDQogICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgnZGl2JywgeyBjbGFzc05hbWU6IGBtdC0zIHAtMyByb3VuZGVkLWxnICR7DQogICAgICAgICAgICAgICAgICBmZWVkYmFja1tpdGVtLmlkXS5jb3JyZWN0ID8gJ2JnLWdyZWVuLTkwMC81MCB0ZXh0LWdyZWVuLTIwMCcgOiANCiAgICAgICAgICAgICAgICAgIGZlZWRiYWNrW2l0ZW0uaWRdLndyb25nVHlwZSA/ICdiZy1yZWQtOTAwLzUwIHRleHQtcmVkLTIwMCcgOg0KICAgICAgICAgICAgICAgICAgJ2JnLW9yYW5nZS05MDAvNTAgdGV4dC1vcmFuZ2UtMjAwJw0KICAgICAgICAgICAgICAgIH1gLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogNDg2fX0KICAgICAgICAgICAgICAgICAgLCBSZWFjdC5jcmVhdGVFbGVtZW50KCdkaXYnLCB7IGNsYXNzTmFtZTogImZsZXggaXRlbXMtc3RhcnQgZ2FwLTIiICAsIF9fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiA0OTF9fQogICAgICAgICAgICAgICAgICAgICwgZmVlZGJhY2tbaXRlbS5pZF0uY29ycmVjdCA/IFJlYWN0LmNyZWF0ZUVsZW1lbnQoQ2hlY2ssIHsgc2l6ZTogMjAsIGNsYXNzTmFtZTogIm10LTAuNSBmbGV4LXNocmluay0wIiAsIF9fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiA0OTJ9fSApIDogUmVhY3QuY3JlYXRlRWxlbWVudChYLCB7IHNpemU6IDIwLCBjbGFzc05hbWU6ICJtdC0wLjUgZmxleC1zaHJpbmstMCIgLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogNDkyfX0gKQogICAgICAgICAgICAgICAgICAgICwgUmVhY3QuY3JlYXRlRWxlbWVudCgnZGl2JywgeyBjbGFzc05hbWU6ICJ0ZXh0LXNtIiwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDQ5M319CiAgICAgICAgICAgICAgICAgICAgICAsIGZlZWRiYWNrW2l0ZW0uaWRdLnZhbHVlICYmICFmZWVkYmFja1tpdGVtLmlkXS53cm9uZ1R5cGUgJiYgKA0KICAgICAgICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgnZGl2JywgeyBjbGFzc05hbWU6ICJmb250LWJvbGQgbWItMSIgLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogNDk1fX0KICAgICAgICAgICAgICAgICAgICAgICAgICAsIGl0ZW0ubmFtZSwgIjogIiAsIGZlZWRiYWNrW2l0ZW0uaWRdLnZhbHVlCiAgICAgICAgICAgICAgICAgICAgICAgICkNCiAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgICAsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ2RpdicsIHsgY2xhc3NOYW1lOiBmZWVkYmFja1tpdGVtLmlkXS53cm9uZ1R5cGUgPyAnZm9udC1ib2xkJyA6ICcnLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogNDk5fX0KICAgICAgICAgICAgICAgICAgICAgICAgLCBmZWVkYmFja1tpdGVtLmlkXS5tZXNzYWdlCiAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICApDQogICAgICAgICAgICAgICkKICAgICAgICAgICAgKQ0KICAgICAgICAgICkpCiAgICAgICAgKQoKICAgICAgICAsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ2RpdicsIHsgY2xhc3NOYW1lOiAiZmxleCBnYXAtNCBqdXN0aWZ5LWNlbnRlciIgICwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDUxMH19CiAgICAgICAgICAsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicsIHsNCiAgICAgICAgICAgIG9uQ2xpY2s6IGdlbmVyYXRlTmV3RXhhbXBsZXMsDQogICAgICAgICAgICBjbGFzc05hbWU6ICJweC02IHB5LTMgYmctcHVycGxlLTYwMCBob3ZlcjpiZy1wdXJwbGUtNzAwIHRleHQtd2hpdGUgcm91bmRlZC1sZyBmb250LXNlbWlib2xkIHRyYW5zaXRpb24tYWxsIHNoYWRvdy1sZyBmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMiIgICAgICAgICAgICwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDUxMX19DQoKICAgICAgICAgICAgLCBSZWFjdC5jcmVhdGVFbGVtZW50KFJlZnJlc2hDdywgeyBzaXplOiAyMCwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDUxNX19ICksICIgTmV3IEV4YW1wbGVzIgogICAgICAgICAgKQogICAgICAgICAgLCBhbGxBbnN3ZXJlZCAmJiAoDQogICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCdidXR0b24nLCB7DQogICAgICAgICAgICAgIG9uQ2xpY2s6ICgpID0+IHNldEN1cnJlbnRBY3Rpdml0eSgyKSwNCiAgICAgICAgICAgICAgY2xhc3NOYW1lOiAicHgtNiBweS0zIGJnLWdyZWVuLTYwMCBob3ZlcjpiZy1ncmVlbi03MDAgdGV4dC13aGl0ZSByb3VuZGVkLWxnIGZvbnQtc2VtaWJvbGQgdHJhbnNpdGlvbi1hbGwgZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTIiICAgICAgICAgICwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDUxOH19DQosICJOZXh0IEFjdGl2aXR5ICIKICAgICAgICAgICAgICAgICwgUmVhY3QuY3JlYXRlRWxlbWVudChDaGV2cm9uUmlnaHQsIHsgc2l6ZTogMjAsIF9fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiA1MjJ9fSApCiAgICAgICAgICAgICkNCiAgICAgICAgICApCiAgICAgICAgKQogICAgICApDQogICAgKTsNCiAgfQ0KDQogIC8vIC0tLSBBY3Rpdml0eSAyOiBXaHkgQ29udmVydD8gLS0tDQogIGNvbnN0IHJvb21XaWR0aFB4ID0gZ2V0Um9vbVdpZHRoKCk7DQogIGNvbnN0IG1lYXN1cmVkTW0gPSAobWVhc3VyZVdpZHRoIC8gcm9vbVdpZHRoUHggKiAzNzUwKS50b0ZpeGVkKDApOw0KICBjb25zdCBtZWFzdXJlZENtID0gKG1lYXN1cmVkTW0gLyAxMCkudG9GaXhlZCgxKTsNCiAgY29uc3QgbWVhc3VyZWRNID0gKG1lYXN1cmVkTW0gLyAxMDAwKS50b0ZpeGVkKDIpOw0KDQogIGNvbnN0IHVuaXRDaG9pY2VzID0gWw0KICAgIHsgdmFsdWU6ICczNzUwIG1tJywgZXhwbGFuYXRpb246ICdUb28gbWFueSBkaWdpdHMgdG8gcXVpY2tseSBncmFzcCcsIGNvcnJlY3Q6IGZhbHNlIH0sDQogICAgeyB2YWx1ZTogJzM3NSBjbScsIGV4cGxhbmF0aW9uOiAnQmV0dGVyLCBidXQgc3RpbGwgYSBsYXJnZSBudW1iZXInLCBjb3JyZWN0OiBmYWxzZSB9LA0KICAgIHsgdmFsdWU6ICczLjc1IG0nLCBleHBsYW5hdGlvbjogJ1BlcmZlY3QhIEVhc3kgdG8gdmlzdWFsaXplJywgY29ycmVjdDogdHJ1ZSB9LA0KICAgIHsgdmFsdWU6ICcwLjAwMzc1IGttJywgZXhwbGFuYXRpb246ICdUb28gc21hbGwgLSBoYXJkIHRvIHBpY3R1cmUnLCBjb3JyZWN0OiBmYWxzZSB9DQogIF07DQoNCiAgcmV0dXJuICgNCiAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCdkaXYnLCB7IA0KICAgICAgb25Nb3VzZU1vdmU6IGhhbmRsZU1lYXN1cmVNb3ZlLCANCiAgICAgIG9uTW91c2VVcDogaGFuZGxlTWVhc3VyZUVuZCwgDQogICAgICBvblRvdWNoTW92ZTogaGFuZGxlTWVhc3VyZU1vdmUsIA0KICAgICAgb25Ub3VjaEVuZDogaGFuZGxlTWVhc3VyZUVuZCwNCiAgICAgIGNsYXNzTmFtZTogInNlbGVjdC1ub25lIiwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDU0NH19DQoKICAgICAgLCBSZWFjdC5jcmVhdGVFbGVtZW50KCdoMicsIHsgY2xhc3NOYW1lOiAidGV4dC0yeGwgZm9udC1ib2xkIG1iLTQgdGV4dC1ibHVlLTQwMCIgICAsIF9fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiA1NTF9fSwgIkFjdGl2aXR5IDI6IFdoeSBEbyBXZSBDb252ZXJ0IFVuaXRzPyIgICAgICApCiAgICAgICwgUmVhY3QuY3JlYXRlRWxlbWVudCgncCcsIHsgY2xhc3NOYW1lOiAidGV4dC1ncmF5LTMwMCBtYi02IiAsIF9fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiA1NTJ9fSwgIllvdSdyZSBtZWFzdXJpbmcgYSByb29tLiBEcmFnIHRoZSBtZWFzdXJpbmcgdGFwZSB0byBmaW5kIGl0cyB3aWR0aCwgdGhlbiBwaWNrIHRoZSBiZXN0IHVuaXQgdG8gZGVzY3JpYmUgaXQuIiAgICAgICAgICAgICAgICAgICApCgogICAgICAsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ2RpdicsIHsgY2xhc3NOYW1lOiAiYmctZ3JheS03MDAgcm91bmRlZC1sZyBwLTYgbWQ6cC04IG1iLTYiICAgICwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDU1NH19CiAgICAgICAgLCBSZWFjdC5jcmVhdGVFbGVtZW50KCdkaXYnLCB7IGNsYXNzTmFtZTogInRleHQtY2VudGVyIG1iLTQiICwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDU1NX19CiAgICAgICAgICAsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ2RpdicsIHsgY2xhc3NOYW1lOiAidGV4dC02eGwgbWItNCIgLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogNTU2fX0sICLwn5OPIikKICAgICAgICAgICwgUmVhY3QuY3JlYXRlRWxlbWVudCgnaDMnLCB7IGNsYXNzTmFtZTogInRleHQtMnhsIGZvbnQtYm9sZCBtYi02IiAgLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogNTU3fX0sICJNZWFzdXJlIHRoZSBSb29tOiIgICkKICAgICAgICApCgogICAgICAgIC8qIC0tLSBJbnRlcmFjdGl2ZSBNZWFzdXJlbWVudCAtLS0gKi8KICAgICAgICAsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ2RpdicsIHsgDQogICAgICAgICAgcmVmOiByb29tUmVmLA0KICAgICAgICAgIGNsYXNzTmFtZTogInJlbGF0aXZlIHctZnVsbCBoLTI0IGJnLWdyYXktODAwIHJvdW5kZWQtbGcgYm9yZGVyLTIgYm9yZGVyLWdyYXktNjAwIGZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktYmV0d2VlbiBweC00IGN1cnNvci1ncmFiIiAgICAgICAgICAgLA0KICAgICAgICAgIG9uTW91c2VEb3duOiBoYW5kbGVNZWFzdXJlU3RhcnQsDQogICAgICAgICAgb25Ub3VjaFN0YXJ0OiBoYW5kbGVNZWFzdXJlU3RhcnQsIF9fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiA1NjF9fQ0KCiAgICAgICAgICAvKiBXYWxsIG1hcmtlcnMgKi8KICAgICAgICAgICwgUmVhY3QuY3JlYXRlRWxlbWVudCgnZGl2JywgeyBjbGFzc05hbWU6ICJhYnNvbHV0ZSBsZWZ0LTAgdG9wLTAgaC1mdWxsIHctMiBiZy1ncmF5LTUwMCByb3VuZGVkLWwtbWQiICAgICAgLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogNTY4fX0pCiAgICAgICAgICAsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ2RpdicsIHsgY2xhc3NOYW1lOiAiYWJzb2x1dGUgcmlnaHQtMCB0b3AtMCBoLWZ1bGwgdy0yIGJnLWdyYXktNTAwIHJvdW5kZWQtci1tZCIgICAgICAsIF9fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiA1Njl9fSkKCiAgICAgICAgICAvKiBNZWFzdXJpbmcgVGFwZSAqLwogICAgICAgICAgLCBSZWFjdC5jcmVhdGVFbGVtZW50KCdkaXYnLCB7IA0KICAgICAgICAgICAgY2xhc3NOYW1lOiAiYWJzb2x1dGUgbGVmdC0wIHRvcC0wIGgtZnVsbCBiZy15ZWxsb3ctNTAwLzMwIGJvcmRlci1yLTQgYm9yZGVyLXllbGxvdy02MDAgcm91bmRlZC1sLWxnIGZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktZW5kIHByLTIiICAgICAgICAgICAsDQogICAgICAgICAgICBzdHlsZTogeyB3aWR0aDogYCR7bWVhc3VyZVdpZHRofXB4YCB9LCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogNTcyfX0NCgogICAgICAgICAgICAsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nLCB7IGNsYXNzTmFtZTogInRleHQteWVsbG93LTEwMCBmb250LWJvbGQgdGV4dC1sZyIgICwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDU3Nn19LCBtZWFzdXJlZE0sICIgbSIgKQogICAgICAgICAgKQoKICAgICAgICAgIC8qIERyYWcgSGFuZGxlICovCiAgICAgICAgICAsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ2RpdicsIHsgDQogICAgICAgICAgICBjbGFzc05hbWU6ICJhYnNvbHV0ZSB0b3AtMS8yIC10cmFuc2xhdGUteS0xLzIgdy00IGgtMTIgYmctZ3JheS05MDAgYm9yZGVyLTIgYm9yZGVyLWdyYXktNDAwIHJvdW5kZWQtbWQgY3Vyc29yLWdyYWIgYWN0aXZlOmN1cnNvci1ncmFiYmluZyIgICAgICAgICAgLA0KICAgICAgICAgICAgc3R5bGU6IHsgbGVmdDogYCR7bWVhc3VyZVdpZHRoIC0gOH1weGAgfSwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDU4MH19DQopCgogICAgICAgICAgLCAhcm9vbU1lYXN1cmVkICYmICFpc0RyYWdnaW5nICYmICgNCiAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nLCB7IGNsYXNzTmFtZTogInRleHQtZ3JheS00MDAgYW5pbWF0ZS1wdWxzZSB0ZXh0LWNlbnRlciB3LWZ1bGwiICAgLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogNTg2fX0sICJDbGljayBhbmQgZHJhZyB0byBtZWFzdXJlISIgICAgKQ0KICAgICAgICAgICkKICAgICAgICApCiAgICAgICAgLyogLS0tIEVuZCBJbnRlcmFjdGl2ZSBNZWFzdXJlbWVudCAtLS0gKi8KCiAgICAgICAgLCByb29tTWVhc3VyZWQgJiYgKA0KICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ2RpdicsIHsgY2xhc3NOYW1lOiAibXQtOCIsIF9fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiA1OTJ9fQogICAgICAgICAgICAsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ2g0JywgeyBjbGFzc05hbWU6ICJ0ZXh0LWxnIGZvbnQtc2VtaWJvbGQgdGV4dC1jZW50ZXIgbWItNCIgICAsIF9fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiA1OTN9fSwgIkdyZWF0ISBUaGUgcm9vbSBpcyAzLjc1IG0gKG9yIDM3NSBjbSkuIFdoaWNoIHdheSBpcyBiZXN0PyIgICAgICAgICAgICApCiAgICAgICAgICAgICwgUmVhY3QuY3JlYXRlRWxlbWVudCgnZGl2JywgeyBjbGFzc05hbWU6ICJncmlkIGdyaWQtY29scy0xIG1kOmdyaWQtY29scy0yIGdhcC00IG1iLTYiICAgICwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDU5NH19CiAgICAgICAgICAgICAgLCB1bml0Q2hvaWNlcy5tYXAoKG9wdGlvbikgPT4gKA0KICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicsIHsNCiAgICAgICAgICAgICAgICAgIGtleTogb3B0aW9uLnZhbHVlLA0KICAgICAgICAgICAgICAgICAgb25DbGljazogKCkgPT4gaGFuZGxlVW5pdENob2ljZShvcHRpb24pLA0KICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAiYmctZ3JheS04MDAgcC02IHJvdW5kZWQtbGcgYm9yZGVyLTIgYm9yZGVyLWdyYXktNjAwIGhvdmVyOmJvcmRlci1ibHVlLTUwMCB0cmFuc2l0aW9uLWFsbCB0ZXh0LWxlZnQiICAgICAgICwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDU5Nn19DQoKICAgICAgICAgICAgICAgICAgLCBSZWFjdC5jcmVhdGVFbGVtZW50KCdkaXYnLCB7IGNsYXNzTmFtZTogInRleHQtM3hsIGZvbnQtYm9sZCB0ZXh0LWJsdWUtNDAwIG1iLTIiICAgLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogNjAxfX0sIG9wdGlvbi52YWx1ZSkKICAgICAgICAgICAgICAgICkNCiAgICAgICAgICAgICAgKSkKICAgICAgICAgICAgKQogICAgICAgICAgKQ0KICAgICAgICApCgogICAgICAgICwgbWVhc3VyZUZlZWRiYWNrICYmICgNCiAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCdkaXYnLCB7IGNsYXNzTmFtZTogYG10LTQgcC0zIHJvdW5kZWQtbGcgYm9yZGVyLTIgJHsNCiAgICAgICAgICAgIG1lYXN1cmVGZWVkYmFjay50eXBlID09PSAnZ29vZCcgPyAnYmctZ3JlZW4tOTAwLzUwIGJvcmRlci1ncmVlbi01MDAnIDoNCiAgICAgICAgICAgIG1lYXN1cmVGZWVkYmFjay50eXBlID09PSAnd2FybicgPyAnYmctb3JhbmdlLTkwMC81MCBib3JkZXItb3JhbmdlLTUwMCcgOg0KICAgICAgICAgICAgJ2JnLXJlZC05MDAvNTAgYm9yZGVyLXJlZC01MDAnDQogICAgICAgICAgfWAsIF9fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiA2MDl9fQogICAgICAgICAgICAsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ2RpdicsIHsgY2xhc3NOYW1lOiAiZmxleCBpdGVtcy1zdGFydCBnYXAtMiIgICwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDYxNH19CiAgICAgICAgICAgICAgLCBtZWFzdXJlRmVlZGJhY2sudHlwZSA9PT0gJ2dvb2QnID8gUmVhY3QuY3JlYXRlRWxlbWVudChDaGVjaywgeyBzaXplOiAyMCwgY2xhc3NOYW1lOiAibXQtMC41IGZsZXgtc2hyaW5rLTAgdGV4dC1ncmVlbi00MDAiICAsIF9fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiA2MTV9fSApIDogUmVhY3QuY3JlYXRlRWxlbWVudChYLCB7IHNpemU6IDIwLCBjbGFzc05hbWU6ICJtdC0wLjUgZmxleC1zaHJpbmstMCB0ZXh0LXJlZC00MDAiICAsIF9fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiA2MTV9fSApCiAgICAgICAgICAgICAgLCBSZWFjdC5jcmVhdGVFbGVtZW50KCdwJywgeyBjbGFzc05hbWU6IGB0ZXh0LXNtICR7DQogICAgICAgICAgICAgICAgbWVhc3VyZUZlZWRiYWNrLnR5cGUgPT09ICdnb29kJyA/ICd0ZXh0LWdyZWVuLTIwMCcgOg0KICAgICAgICAgICAgICAgIG1lYXN1cmVGZWVkYmFjay50eXBlID09PSAnd2FybicgPyAndGV4dC1vcmFuZ2UtMjAwJyA6DQogICAgICAgICAgICAgICAgJ3RleHQtcmVkLTIwMCcNCiAgICAgICAgICAgICAgfWAsIF9fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiA2MTZ9fQogICAgICAgICAgICAgICAgLCBtZWFzdXJlRmVlZGJhY2subWVzc2FnZQogICAgICAgICAgICAgICkKICAgICAgICAgICAgKQogICAgICAgICAgKQ0KICAgICAgICApCiAgICAgICkKCiAgICAgICwgUmVhY3QuY3JlYXRlRWxlbWVudCgnZGl2JywgeyBjbGFzc05hbWU6ICJiZy1wdXJwbGUtOTAwLzMwIGJvcmRlci0yIGJvcmRlci1wdXJwbGUtNTAwIHJvdW5kZWQtbGcgcC02IG1iLTYiICAgICAsIF9fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiA2Mjh9fQogICAgICAgICwgUmVhY3QuY3JlYXRlRWxlbWVudCgnZGl2JywgeyBjbGFzc05hbWU6ICJmbGV4IGl0ZW1zLXN0YXJ0IGdhcC0zIiAgLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogNjI5fX0KICAgICAgICAgICwgUmVhY3QuY3JlYXRlRWxlbWVudChMaWdodGJ1bGIsIHsgc2l6ZTogMjQsIGNsYXNzTmFtZTogInRleHQteWVsbG93LTQwMCBtdC0xIGZsZXgtc2hyaW5rLTAiICAsIF9fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiA2MzB9fSApCiAgICAgICAgICAsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ2RpdicsIHtfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogNjMxfX0KICAgICAgICAgICAgLCBSZWFjdC5jcmVhdGVFbGVtZW50KCdoNCcsIHsgY2xhc3NOYW1lOiAiZm9udC1ib2xkIHRleHQtbGcgbWItMiB0ZXh0LXB1cnBsZS0zMDAiICAgLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogNjMyfX0sICJLZXkgSW5zaWdodDoiICkKICAgICAgICAgICAgLCBSZWFjdC5jcmVhdGVFbGVtZW50KCdwJywgeyBjbGFzc05hbWU6ICJ0ZXh0LWdyYXktMjAwIiwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDYzM319LCAiV2UgY29udmVydCB1bml0cyB0byBtYWtlIG1lYXN1cmVtZW50cyBlYXNpZXIgdG8gdW5kZXJzdGFuZCBhbmQgd29yayB3aXRoLiBUaGUgXCJiZXN0XCIgdW5pdCBkZXBlbmRzIG9uIHRoZSBzaXplIG9mIHdoYXQgd2UncmUgbWVhc3VyaW5nLiBUb28gbGFyZ2Ugb3IgdG9vIHNtYWxsIG51bWJlcnMgd2l0aCBkZWNpbWFscyBhcmUgaGFyZCB0byBwaWN0dXJlISIKCiAgICAgICAgICAgICkKICAgICAgICAgICkKICAgICAgICApCiAgICAgICkKCiAgICAgICwgUmVhY3QuY3JlYXRlRWxlbWVudCgnZGl2JywgeyBjbGFzc05hbWU6ICJmbGV4IGp1c3RpZnktY2VudGVyIGdhcC00IiAgLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogNjQwfX0KICAgICAgICAsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicsIHsNCiAgICAgICAgICBvbkNsaWNrOiAoKSA9PiBzZXRDdXJyZW50QWN0aXZpdHkoMSksDQogICAgICAgICAgY2xhc3NOYW1lOiAicHgtNiBweS0zIGJnLWJsdWUtNjAwIGhvdmVyOmJnLWJsdWUtNzAwIHRleHQtd2hpdGUgcm91bmRlZC1sZyBmb250LXNlbWlib2xkIHRyYW5zaXRpb24tYWxsIiAgICAgICAsIF9fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiA2NDF9fQ0KLCAiQmFjayB0byBBY3Rpdml0eSAxIgoKICAgICAgICApCiAgICAgICAgLCBSZWFjdC5jcmVhdGVFbGVtZW50KCdidXR0b24nLCB7DQogICAgICAgICAgb25DbGljazogcmVzZXRBY3Rpdml0eTIsDQogICAgICAgICAgY2xhc3NOYW1lOiAicHgtNiBweS0zIGJnLWdyYXktNjAwIGhvdmVyOmJnLWdyYXktNTAwIHRleHQtd2hpdGUgcm91bmRlZC1sZyBmb250LXNlbWlib2xkIHRyYW5zaXRpb24tYWxsIGZsZXggaXRlbXMtY2VudGVyIGdhcC0yIiAgICAgICAgICAsIF9fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiA2NDd9fQ0KCiAgICAgICAgICAsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoUmVmcmVzaEN3LCB7IHNpemU6IDE4LCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogNjUxfX0gKSwgIiBSZXNldCIKICAgICAgICApCiAgICAgICkKICAgICkNCiAgKTsNCn07DQoNCi8vIFRhYiAyOiBVbmRlcnN0YW5kaW5nIENvbnZlcnNpb25zDQpjb25zdCBVbmRlcnN0YW5kaW5nQ29udmVyc2lvbnNUYWIgPSAoKSA9PiB7DQogIGNvbnN0IFtzbGlkZXJWYWx1ZSwgc2V0U2xpZGVyVmFsdWVdID0gdXNlU3RhdGUoMjUwKTsgLy8gQmFzZSB2YWx1ZSBpbiBjbQ0KICBjb25zdCBbY3VycmVudFVuaXQsIHNldEN1cnJlbnRVbml0XSA9IHVzZVN0YXRlKCdjbScpOw0KICBjb25zdCBbZmVlZGJhY2ssIHNldEZlZWRiYWNrXSA9IHVzZVN0YXRlKG51bGwpOyAvLyBTdGF0ZSBmb3IgZmVlZGJhY2sNCg0KICAvLyBNZW1vaXplIGNvbnZlcnNpb25zIG9iamVjdA0KICBjb25zdCBjb252ZXJzaW9ucyA9IFJlYWN0LnVzZU1lbW8oKCkgPT4gKHsNCiAgICBtbTogeyB2YWx1ZTogc2xpZGVyVmFsdWUgKiAxMCwgbGFiZWw6ICdtaWxsaW1ldGVycycgfSwNCiAgICBjbTogeyB2YWx1ZTogc2xpZGVyVmFsdWUsIGxhYmVsOiAnY2VudGltZXRlcnMnIH0sDQogICAgbTogeyB2YWx1ZTogc2xpZGVyVmFsdWUgLyAxMDAsIGxhYmVsOiAnbWV0ZXJzJyB9LA0KICAgIGttOiB7IHZhbHVlOiBzbGlkZXJWYWx1ZSAvIDEwMDAwMCwgbGFiZWw6ICdraWxvbWV0ZXJzJyB9DQogIH0pLCBbc2xpZGVyVmFsdWVdKTsNCg0KICAvLyBNZW1vaXplIGZlZWRiYWNrIGZ1bmN0aW9uDQogIGNvbnN0IGdldEZlZWRiYWNrID0gUmVhY3QudXNlQ2FsbGJhY2soKHVuaXQsIHZhbHVlKSA9PiB7DQogICAgc3dpdGNoICh1bml0KSB7DQogICAgICBjYXNlICdtbSc6DQogICAgICAgIGlmICh2YWx1ZSA+IDEwMDApIHJldHVybiB7IG1lc3NhZ2U6ICJUaGlzIG51bWJlciBpcyBnZXR0aW5nIGEgYml0IGxhcmdlISAnY20nIG9yICdtJyBtaWdodCBiZSBjbGVhcmVyLiIsIHR5cGU6ICd3YXJuJyB9Ow0KICAgICAgICBpZiAodmFsdWUgPCAxMCAmJiB2YWx1ZSA+IDApIHJldHVybiB7IG1lc3NhZ2U6ICJHb29kIGZvciB2ZXJ5IHNtYWxsIHRoaW5ncywgYnV0ICdjbScgbWlnaHQgYmUgZWFzaWVyIHRvIHJlYWQgaGVyZS4iLCB0eXBlOiAnb2snIH07DQogICAgICAgIGlmICh2YWx1ZSA9PT0gMCkgcmV0dXJuIHsgbWVzc2FnZTogIlRoaXMgdmFsdWUgaXMgMCEiLCB0eXBlOiAnb2snIH07DQogICAgICAgIHJldHVybiB7IG1lc3NhZ2U6ICJNaWxsaW1ldGVycyBhcmUgZ3JlYXQgZm9yIHByZWNpc2UsIHNtYWxsIG1lYXN1cmVtZW50cy4iLCB0eXBlOiAnb2snIH07DQogICAgICBjYXNlICdjbSc6DQogICAgICAgIGlmICh2YWx1ZSA+IDMwMCkgcmV0dXJuIHsgbWVzc2FnZTogIkNlbnRpbWV0ZXJzIHdvcmssIGJ1dCAnbWV0ZXJzJyBtaWdodCBiZSBzaW1wbGVyIGZvciB0aGlzIGxlbmd0aC4iLCB0eXBlOiAnd2FybicgfTsNCiAgICAgICAgaWYgKHZhbHVlIDwgMSAmJiB2YWx1ZSA+IDApIHJldHVybiB7IG1lc3NhZ2U6ICJUaGlzIGlzIGxlc3MgdGhhbiAxIGNtISAnbW0nIHdvdWxkIGJlIGJldHRlci4iLCB0eXBlOiAnd2FybicgfTsNCiAgICAgICAgcmV0dXJuIHsgbWVzc2FnZTogIkNlbnRpbWV0ZXJzIGFyZSBhIGdyZWF0LCBlYXN5LXRvLXJlYWQgdW5pdCBmb3IgdGhpcyBzaXplISIsIHR5cGU6ICdnb29kJyB9Ow0KICAgICAgY2FzZSAnbSc6DQogICAgICAgIGlmICh2YWx1ZSA+IDEwMCkgcmV0dXJuIHsgbWVzc2FnZTogIlRoaXMgaXMgYSBsYXJnZSBkaXN0YW5jZSEgJ2ttJyB3b3VsZCBiZSBtdWNoIGVhc2llci4iLCB0eXBlOiAnd2FybicgfTsNCiAgICAgICAgaWYgKHZhbHVlIDwgMSAmJiB2YWx1ZSA+IDApIHJldHVybiB7IG1lc3NhZ2U6ICJVc2luZyBhIGRlY2ltYWwgZm9yIG1ldGVycyBjYW4gYmUgYXdrd2FyZC4gJ2NtJyBtaWdodCBiZSBjbGVhcmVyLiIsIHR5cGU6ICd3YXJuJyB9Ow0KICAgICAgICBpZiAodmFsdWUgPj0gMSAmJiB2YWx1ZSA8IDEwKSByZXR1cm4geyBtZXNzYWdlOiAiTWV0ZXJzIGFyZSBwZXJmZWN0IGZvciB0aGlzIHNpemUsIHZlcnkgZWFzeSB0byBwaWN0dXJlISIsIHR5cGU6ICdnb29kJyB9Ow0KICAgICAgICByZXR1cm4geyBtZXNzYWdlOiAiTWV0ZXJzIHdvcmsgd2VsbCBmb3IgdGhpcyBsZW5ndGguIiwgdHlwZTogJ29rJyB9Ow0KICAgICAgY2FzZSAna20nOg0KICAgICAgICBpZiAodmFsdWUgPj0gMSkgcmV0dXJuIHsgbWVzc2FnZTogIktpbG9tZXRlcnMgYXJlIGZvciBsb25nIGRpc3RhbmNlcy4gVGhpcyBpcyBhIGdvb2QgdW5pdCBpZiB5b3UncmUgbWVhc3VyaW5nIGEgcm9hZCEiLCB0eXBlOiAnZ29vZCcgfTsNCiAgICAgICAgcmV0dXJuIHsgbWVzc2FnZTogIlRoaXMgbnVtYmVyIGlzIHRpbnkhIEtpbG9tZXRlcnMgYXJlIHdheSB0b28gYmlnIGZvciB0aGlzIG1lYXN1cmVtZW50LiIsIHR5cGU6ICdiYWQnIH07DQogICAgICBkZWZhdWx0Og0KICAgICAgICByZXR1cm4geyBtZXNzYWdlOiAnJywgdHlwZTogJ29rJyB9Ow0KICAgIH0NCiAgfSwgW10pOw0KDQogIC8vIFVwZGF0ZSBmZWVkYmFjayB3aGVuIHNsaWRlciBvciB1bml0IGNoYW5nZXMNCiAgdXNlRWZmZWN0KCgpID0+IHsNCiAgICBjb25zdCB2YWx1ZSA9IGNvbnZlcnNpb25zW2N1cnJlbnRVbml0XS52YWx1ZTsNCiAgICBjb25zdCBmZWVkYmFja01lc3NhZ2UgPSBnZXRGZWVkYmFjayhjdXJyZW50VW5pdCwgdmFsdWUpOw0KICAgIHNldEZlZWRiYWNrKGZlZWRiYWNrTWVzc2FnZSk7DQogIH0sIFtzbGlkZXJWYWx1ZSwgY3VycmVudFVuaXQsIGNvbnZlcnNpb25zLCBnZXRGZWVkYmFja10pOw0KDQogIHJldHVybiAoDQogICAgUmVhY3QuY3JlYXRlRWxlbWVudCgnZGl2Jywge19fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiA3MDV9fQogICAgICAsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ2gyJywgeyBjbGFzc05hbWU6ICJ0ZXh0LTJ4bCBmb250LWJvbGQgbWItNCB0ZXh0LWJsdWUtNDAwIiAgICwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDcwNn19LCAiVW5kZXJzdGFuZGluZyBDb252ZXJzaW9ucyIgKQogICAgICAsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ3AnLCB7IGNsYXNzTmFtZTogInRleHQtZ3JheS0zMDAgbWItNiIgLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogNzA3fX0sICJTZWUgaG93IHRoZSBzYW1lIG1lYXN1cmVtZW50IGNoYW5nZXMgd2hlbiB3ZSBjb252ZXJ0IGJldHdlZW4gdW5pdHMuIE5vdGljZSBob3cgdGhlIGRlY2ltYWwgcG9pbnQgbW92ZXMhIiAgICAgICAgICAgICAgICApCgogICAgICAsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ2RpdicsIHsgY2xhc3NOYW1lOiAiYmctZ3JheS03MDAgcm91bmRlZC1sZyBwLTggbWItOCIgICAsIF9fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiA3MDl9fQogICAgICAgICwgUmVhY3QuY3JlYXRlRWxlbWVudCgnaDMnLCB7IGNsYXNzTmFtZTogInRleHQteGwgZm9udC1ib2xkIG1iLTYgdGV4dC1jZW50ZXIiICAgLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogNzEwfX0sICJJbnRlcmFjdGl2ZSBDb252ZXJzaW9uIEV4cGxvcmVyIChCYXNlOiBjbSkiICAgICkKCiAgICAgICAgLCBSZWFjdC5jcmVhdGVFbGVtZW50KCdkaXYnLCB7IGNsYXNzTmFtZTogIm1iLTgiLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogNzEyfX0KICAgICAgICAgICwgUmVhY3QuY3JlYXRlRWxlbWVudCgnbGFiZWwnLCB7IGNsYXNzTmFtZTogImJsb2NrIHRleHQtc20gZm9udC1zZW1pYm9sZCBtYi0zIHRleHQtZ3JheS0zMDAiICAgICwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDcxM319LCAiQWRqdXN0IHRoZSBtZWFzdXJlbWVudDogIiAgICwgc2xpZGVyVmFsdWUsICIgY20iICkKICAgICAgICAgICwgUmVhY3QuY3JlYXRlRWxlbWVudCgnZGl2JywgeyBjbGFzc05hbWU6ICJyZWxhdGl2ZSBwdC00IiAsIF9fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiA3MTR9fQogICAgICAgICAgICAsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jywgew0KICAgICAgICAgICAgICB0eXBlOiAicmFuZ2UiLA0KICAgICAgICAgICAgICBtaW46ICIxIiwNCiAgICAgICAgICAgICAgbWF4OiAiNTAwIiwNCiAgICAgICAgICAgICAgdmFsdWU6IHNsaWRlclZhbHVlLA0KICAgICAgICAgICAgICBvbkNoYW5nZTogKGUpID0+IHNldFNsaWRlclZhbHVlKE51bWJlcihlLnRhcmdldC52YWx1ZSkpLA0KICAgICAgICAgICAgICBjbGFzc05hbWU6ICJ3LWZ1bGwgaC0yIGJnLXRyYW5zcGFyZW50IHJvdW5kZWQtbGcgYXBwZWFyYW5jZS1ub25lIGN1cnNvci1wb2ludGVyIHotMTAgcmVsYXRpdmUiICAgICAgICwNCiAgICAgICAgICAgICAgc3R5bGU6IHsNCiAgICAgICAgICAgICAgICAvLyBDdXN0b20gc3R5bGVzIGZvciB0aHVtYg0KICAgICAgICAgICAgICAgICctLXNsaWRlci10aHVtYi1iZyc6ICcjM2I4MmY2JywgLy8gYmx1ZS01MDANCiAgICAgICAgICAgICAgICAnLS1zbGlkZXItdGh1bWItYm9yZGVyJzogJyMxZTNhOGEnLCAvLyBibHVlLTgwMA0KICAgICAgICAgICAgICB9LCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogNzE1fX0NCiAgICAgICAgICAgICkKICAgICAgICAgICAgIC8qIFJ1bGVyIFRyYWNrICovCiAgICAgICAgICAgICwgUmVhY3QuY3JlYXRlRWxlbWVudCgnZGl2JywgeyBjbGFzc05hbWU6ICJhYnNvbHV0ZSB0b3AtMS8yIGxlZnQtMCB3LWZ1bGwgaC0yIC10cmFuc2xhdGUteS0xLzIgYmctZ3JheS02MDAgcm91bmRlZC1sZyBvdmVyZmxvdy1oaWRkZW4iICAgICAgICAsIF9fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiA3Mjl9fQogICAgICAgICAgICAgICAgLyogVGljayBtYXJrcyAqLwogICAgICAgICAgICAgICAgLCBSZWFjdC5jcmVhdGVFbGVtZW50KCdkaXYnLCB7IGNsYXNzTmFtZTogImFic29sdXRlIHRvcC0wIGxlZnQtMCBoLWZ1bGwgdy1mdWxsIGZsZXgganVzdGlmeS1iZXR3ZWVuIiAgICAgICwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDczMX19CiAgICAgICAgICAgICAgICAgICwgWy4uLkFycmF5KDExKV0ubWFwKChfLCBpKSA9PiAoDQogICAgICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nLCB7IGtleTogaSwgY2xhc3NOYW1lOiBgdy0wLjUgaC1mdWxsICR7aSAlIDUgPT09IDAgPyAnYmctZ3JheS0yMDAnIDogJ2JnLWdyYXktNDAwJ31gLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogNzMzfX0pDQogICAgICAgICAgICAgICAgICApKQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICApCiAgICAgICAgICAgIC8qIFJ1bGVyIExhYmVscyAqLwogICAgICAgICAgICAsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ2RpdicsIHsgY2xhc3NOYW1lOiAiYWJzb2x1dGUgLWJvdHRvbS02IGxlZnQtMCB3LWZ1bGwgZmxleCBqdXN0aWZ5LWJldHdlZW4gdGV4dC14cyB0ZXh0LWdyYXktNDAwIiAgICAgICAsIF9fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiA3Mzh9fQogICAgICAgICAgICAgICAgLCBSZWFjdC5jcmVhdGVFbGVtZW50KCdzcGFuJywge19fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiA3Mzl9fSwgIjEiKQogICAgICAgICAgICAgICAgLCBSZWFjdC5jcmVhdGVFbGVtZW50KCdzcGFuJywge19fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiA3NDB9fSwgIjEwMCIpCiAgICAgICAgICAgICAgICAsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nLCB7X19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDc0MX19LCAiMjAwIikKICAgICAgICAgICAgICAgICwgUmVhY3QuY3JlYXRlRWxlbWVudCgnc3BhbicsIHtfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogNzQyfX0sICIzMDAiKQogICAgICAgICAgICAgICAgLCBSZWFjdC5jcmVhdGVFbGVtZW50KCdzcGFuJywge19fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiA3NDN9fSwgIjQwMCIpCiAgICAgICAgICAgICAgICAsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nLCB7X19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDc0NH19LCAiNTAwIikKICAgICAgICAgICAgKQogICAgICAgICAgKQogICAgICAgICkKCiAgICAgICAgLCBSZWFjdC5jcmVhdGVFbGVtZW50KCdkaXYnLCB7IGNsYXNzTmFtZTogImdyaWQgZ3JpZC1jb2xzLTIgbWQ6Z3JpZC1jb2xzLTQgZ2FwLTQgbWItOCBtdC0xMiIgICAgICwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDc0OX19CiAgICAgICAgICAsIE9iamVjdC5lbnRyaWVzKGNvbnZlcnNpb25zKS5tYXAoKFt1bml0LCBkYXRhXSkgPT4gKA0KICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgnZGl2Jywgew0KICAgICAgICAgICAgICBrZXk6IHVuaXQsDQogICAgICAgICAgICAgIG9uQ2xpY2s6ICgpID0+IHNldEN1cnJlbnRVbml0KHVuaXQpLCAvLyBKdXN0IHNldCB0aGUgY3VycmVudCB1bml0DQogICAgICAgICAgICAgIGNsYXNzTmFtZTogYHAtNiByb3VuZGVkLWxnIGJvcmRlci0yIGN1cnNvci1wb2ludGVyIHRyYW5zaXRpb24tYWxsICR7DQogICAgICAgICAgICAgICAgY3VycmVudFVuaXQgPT09IHVuaXQNCiAgICAgICAgICAgICAgICAgID8gJ2JvcmRlci1ibHVlLTUwMCBiZy1ibHVlLTkwMC8zMCcNCiAgICAgICAgICAgICAgICAgIDogJ2JvcmRlci1ncmF5LTYwMCBiZy1ncmF5LTgwMCBob3Zlcjpib3JkZXItZ3JheS01MDAnDQogICAgICAgICAgICAgIH1gLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogNzUxfX0NCgogICAgICAgICAgICAgICwgUmVhY3QuY3JlYXRlRWxlbWVudCgnZGl2JywgeyBjbGFzc05hbWU6ICJ0ZXh0LTN4bCBmb250LWJvbGQgdGV4dC1ibHVlLTQwMCBtYi0xIiAgICwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDc2MH19CiAgICAgICAgICAgICAgICAsIGRhdGEudmFsdWUudG9Mb2NhbGVTdHJpbmcodW5kZWZpbmVkLCB7IA0KICAgICAgICAgICAgICAgICAgbWF4aW11bUZyYWN0aW9uRGlnaXRzOiB1bml0ID09PSAna20nID8gNSA6IDIsIA0KICAgICAgICAgICAgICAgICAgbWluaW11bUZyYWN0aW9uRGlnaXRzOiAwIA0KICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICwgUmVhY3QuY3JlYXRlRWxlbWVudCgnZGl2JywgeyBjbGFzc05hbWU6ICJ0ZXh0LXNtIHRleHQtZ3JheS00MDAiICwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDc2Nn19LCBkYXRhLmxhYmVsLCAiICgiICwgdW5pdCwgIikiKQogICAgICAgICAgICApDQogICAgICAgICAgKSkKICAgICAgICApCgogICAgICAgIC8qIC0tLSBGZWVkYmFjayBCb3ggLS0tICovCiAgICAgICAgLCBmZWVkYmFjayAmJiAoDQogICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgnZGl2JywgeyBjbGFzc05hbWU6IGBtYi04IHAtNCByb3VuZGVkLWxnIGJvcmRlci0yICR7DQogICAgICAgICAgICBmZWVkYmFjay50eXBlID09PSAnZ29vZCcgPyAnYmctZ3JlZW4tOTAwLzUwIGJvcmRlci1ncmVlbi01MDAnIDoNCiAgICAgICAgICAgIGZlZWRiYWNrLnR5cGUgPT09ICd3YXJuJyA/ICdiZy1vcmFuZ2UtOTAwLzUwIGJvcmRlci1vcmFuZ2UtNTAwJyA6DQogICAgICAgICAgICBmZWVkYmFjay50eXBlID09PSAnYmFkJyA/ICdiZy1yZWQtOTAwLzUwIGJvcmRlci1yZWQtNTAwJyA6DQogICAgICAgICAgICAnYmctYmx1ZS05MDAvMzAgYm9yZGVyLWJsdWUtNTAwJyAvLyAnb2snIHR5cGUNCiAgICAgICAgICB9YCwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDc3M319CiAgICAgICAgICAgICwgUmVhY3QuY3JlYXRlRWxlbWVudCgnZGl2JywgeyBjbGFzc05hbWU6ICJmbGV4IGl0ZW1zLXN0YXJ0IGdhcC0yIiAgLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogNzc5fX0KICAgICAgICAgICAgICAsIGZlZWRiYWNrLnR5cGUgPT09ICdnb29kJyA/IFJlYWN0LmNyZWF0ZUVsZW1lbnQoQ2hlY2ssIHsgc2l6ZTogMjAsIGNsYXNzTmFtZTogIm10LTAuNSBmbGV4LXNocmluay0wIHRleHQtZ3JlZW4tNDAwIiAgLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogNzgwfX0gKSA6DQogICAgICAgICAgICAgICBmZWVkYmFjay50eXBlID09PSAnYmFkJyA/IFJlYWN0LmNyZWF0ZUVsZW1lbnQoWCwgeyBzaXplOiAyMCwgY2xhc3NOYW1lOiAibXQtMC41IGZsZXgtc2hyaW5rLTAgdGV4dC1yZWQtNDAwIiAgLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogNzgxfX0gKSA6DQogICAgICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KExpZ2h0YnVsYiwgeyBzaXplOiAyMCwgY2xhc3NOYW1lOiAibXQtMC41IGZsZXgtc2hyaW5rLTAgdGV4dC15ZWxsb3ctNDAwIiAgLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogNzgyfX0gKQogICAgICAgICAgICAgICwgUmVhY3QuY3JlYXRlRWxlbWVudCgncCcsIHsgY2xhc3NOYW1lOiBgdGV4dC1zbSAkew0KICAgICAgICAgICAgICAgIGZlZWRiYWNrLnR5cGUgPT09ICdnb29kJyA/ICd0ZXh0LWdyZWVuLTIwMCcgOg0KICAgICAgICAgICAgICAgIGZlZWRiYWNrLnR5cGUgPT09ICd3YXJuJyA/ICd0ZXh0LW9yYW5nZS0yMDAnIDoNCiAgICAgICAgICAgICAgICBmZWVkYmFjay50eXBlID09PSAnYmFkJyA/ICd0ZXh0LXJlZC0yMDAnIDoNCiAgICAgICAgICAgICAgICAndGV4dC1ibHVlLTIwMCcNCiAgICAgICAgICAgICAgfWAsIF9fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiA3ODN9fQogICAgICAgICAgICAgICAgLCBmZWVkYmFjay5tZXNzYWdlCiAgICAgICAgICAgICAgKQogICAgICAgICAgICApCiAgICAgICAgICApDQogICAgICAgICkKICAgICAgICAvKiAtLS0gRW5kIEZlZWRiYWNrIEJveCAtLS0gKi8KCgogICAgICAgICwgUmVhY3QuY3JlYXRlRWxlbWVudCgnZGl2JywgeyBjbGFzc05hbWU6ICJiZy1ncmF5LTgwMCByb3VuZGVkLWxnIHAtNiIgICwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDc5N319CiAgICAgICAgICAsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ2g0JywgeyBjbGFzc05hbWU6ICJmb250LWJvbGQgbWItNCB0ZXh0LWxnIHRleHQtYmx1ZS0zMDAiICAgLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogNzk4fX0sICJDb252ZXJzaW9uIFJlbGF0aW9uc2hpcHM6IiApCiAgICAgICAgICAsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ2RpdicsIHsgY2xhc3NOYW1lOiAic3BhY2UteS0zIHRleHQtZ3JheS0yMDAiICwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDc5OX19CiAgICAgICAgICAgICwgUmVhY3QuY3JlYXRlRWxlbWVudCgnZGl2JywgeyBjbGFzc05hbWU6ICJmbGV4IGZsZXgtd3JhcCBpdGVtcy1jZW50ZXIgZ2FwLXgtMyBnYXAteS0xIiAgICAsIF9fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiA4MDB9fQogICAgICAgICAgICAgICwgUmVhY3QuY3JlYXRlRWxlbWVudCgnc3BhbicsIHsgY2xhc3NOYW1lOiAiZm9udC1tb25vIGJnLWdyYXktNzAwIHB4LTMgcHktMSByb3VuZGVkIiAgICAsIF9fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiA4MDF9fSwgIjEgbSA9IDEwMCBjbSIgICAgKQogICAgICAgICAgICAgICwgUmVhY3QuY3JlYXRlRWxlbWVudCgnc3BhbicsIHsgY2xhc3NOYW1lOiAidGV4dC1ncmF5LTQwMCIsIF9fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiA4MDJ9fSwgIuKGkiBtdWx0aXBseSBieSAxMDAgdG8gZ28gZnJvbSBtIHRvIGNtIiAgICAgICAgICkKICAgICAgICAgICAgKQogICAgICAgICAgICAsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ2RpdicsIHsgY2xhc3NOYW1lOiAiZmxleCBmbGV4LXdyYXAgaXRlbXMtY2VudGVyIGdhcC14LTMgZ2FwLXktMSIgICAgLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogODA0fX0KICAgICAgICAgICAgICAsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nLCB7IGNsYXNzTmFtZTogImZvbnQtbW9ubyBiZy1ncmF5LTcwMCBweC0zIHB5LTEgcm91bmRlZCIgICAgLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogODA1fX0sICIxIG0gPSAxMDAwIG1tIiAgICApCiAgICAgICAgICAgICAgLCBSZWFjdC5jcmVhdGVFbGVtZW50KCdzcGFuJywgeyBjbGFzc05hbWU6ICJ0ZXh0LWdyYXktNDAwIiwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDgwNn19LCAi4oaSIG11bHRpcGx5IGJ5IDEwMDAgdG8gZ28gZnJvbSBtIHRvIG1tIiAgICAgICAgICkKICAgICAgICAgICAgKQogICAgICAgICAgICAsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ2RpdicsIHsgY2xhc3NOYW1lOiAiZmxleCBmbGV4LXdyYXAgaXRlbXMtY2VudGVyIGdhcC14LTMgZ2FwLXktMSIgICAgLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogODA4fX0KICAgICAgICAgICAgICAsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nLCB7IGNsYXNzTmFtZTogImZvbnQtbW9ubyBiZy1ncmF5LTcwMCBweC0zIHB5LTEgcm91bmRlZCIgICAgLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogODA5fX0sICIxIGttID0gMTAwMCBtIiAgICApCiAgICAgICAgICAgICAgLCBSZWFjdC5jcmVhdGVFbGVtZW50KCdzcGFuJywgeyBjbGFzc05hbWU6ICJ0ZXh0LWdyYXktNDAwIiwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDgxMH19LCAi4oaSIG11bHRpcGx5IGJ5IDEwMDAgdG8gZ28gZnJvbSBrbSB0byBtIiAgICAgICAgICkKICAgICAgICAgICAgKQogICAgICAgICAgKQogICAgICAgICkKICAgICAgKQoKICAgICAgLCBSZWFjdC5jcmVhdGVFbGVtZW50KCdkaXYnLCB7IGNsYXNzTmFtZTogImJnLXB1cnBsZS05MDAvMzAgYm9yZGVyLTIgYm9yZGVyLXB1cnBsZS01MDAgcm91bmRlZC1sZyBwLTYiICAgICwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDgxNn19CiAgICAgICAgLCBSZWFjdC5jcmVhdGVFbGVtZW50KCdkaXYnLCB7IGNsYXNzTmFtZTogImZsZXggaXRlbXMtc3RhcnQgZ2FwLTMiICAsIF9fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiA4MTd9fQogICAgICAgICAgLCBSZWFjdC5jcmVhdGVFbGVtZW50KExpZ2h0YnVsYiwgeyBzaXplOiAyNCwgY2xhc3NOYW1lOiAidGV4dC15ZWxsb3ctNDAwIG10LTEgZmxleC1zaHJpbmstMCIgICwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDgxOH19ICkKICAgICAgICAgICwgUmVhY3QuY3JlYXRlRWxlbWVudCgnZGl2Jywge19fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiA4MTl9fQogICAgICAgICAgICAsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ2g0JywgeyBjbGFzc05hbWU6ICJmb250LWJvbGQgdGV4dC1sZyBtYi0yIHRleHQtcHVycGxlLTMwMCIgICAsIF9fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiA4MjB9fSwgIkNvbnZlcnNpb24gRmFjdG9yczoiICkKICAgICAgICAgICAgLCBSZWFjdC5jcmVhdGVFbGVtZW50KCdwJywgeyBjbGFzc05hbWU6ICJ0ZXh0LWdyYXktMjAwIG1iLTMiICwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDgyMX19LCAiQSBjb252ZXJzaW9uIGZhY3RvciBpcyBhIHJhdGlvIHRoYXQgZXF1YWxzIDEsIGxpa2UgXCIxMDAgY20gLyAxIG1cIi4gV2hlbiB3ZSBtdWx0aXBseSBieSBpdCwgd2UncmUgbm90IGNoYW5naW5nIHRoZSBhY3R1YWwgbWVhc3VyZW1lbnTigJRqdXN0IGhvdyB3ZSBleHByZXNzIGl0ISIKCiAgICAgICAgICAgICkKICAgICAgICAgICAgLCBSZWFjdC5jcmVhdGVFbGVtZW50KCdwJywgeyBjbGFzc05hbWU6ICJ0ZXh0LWdyYXktMjAwIiwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDgyNH19LCAi4oCiIEdvaW5nIHRvIGEgc21hbGxlciB1bml0PyBNdWx0aXBseSAodGhlIG51bWJlciBnZXRzIGJpZ2dlcikiCiAgICAgICAgICAgICAgICAgICAgICAgICwgUmVhY3QuY3JlYXRlRWxlbWVudCgnYnInLCB7X19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDgyNX19ICksICLigKIgR29pbmcgdG8gYSBsYXJnZXIgdW5pdD8gRGl2aWRlICh0aGUgbnVtYmVyIGdldHMgc21hbGxlcikiCgogICAgICAgICAgICApCiAgICAgICAgICApCiAgICAgICAgKQogICAgICApCiAgICApDQogICk7DQp9Ow0KDQovLyAtLS0gRnJhY3Rpb24gQ29tcG9uZW50IGZvciBUYWIgMyAtLS0NCmNvbnN0IEZyYWN0aW9uID0gKHsgbnVtLCBkZW4sIG51bUNhbmNlbGxlZCwgZGVuQ2FuY2VsbGVkIH0pID0+IHsNCiAgY29uc3QgW251bVZhbCwgbnVtVW5pdF0gPSBudW0uc3BsaXQoJyAnKTsNCiAgY29uc3QgW2RlblZhbCwgZGVuVW5pdF0gPSBkZW4uc3BsaXQoJyAnKTsNCiAgDQogIHJldHVybiAoDQogICAgUmVhY3QuY3JlYXRlRWxlbWVudCgnZGl2JywgeyBjbGFzc05hbWU6ICJpbmxpbmUtZmxleCBmbGV4LWNvbCBpdGVtcy1jZW50ZXIgdGV4dC1sZyBtZDp0ZXh0LXhsIG14LTEgZm9udC1tb25vIiAgICAgICwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDg0MX19CiAgICAgICwgUmVhY3QuY3JlYXRlRWxlbWVudCgnc3BhbicsIHsgY2xhc3NOYW1lOiAicHgtMiIsIF9fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiA4NDJ9fQogICAgICAgICwgbnVtVmFsLCAnICcKICAgICAgICAsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nLCB7IGNsYXNzTmFtZTogYCR7bnVtQ2FuY2VsbGVkID8gJ2xpbmUtdGhyb3VnaCB0ZXh0LXJlZC00MDAnIDogJyd9YCwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDg0NH19CiAgICAgICAgICAsIG51bVVuaXQKICAgICAgICApCiAgICAgICkKICAgICAgLCBSZWFjdC5jcmVhdGVFbGVtZW50KCdzcGFuJywgeyBjbGFzc05hbWU6ICJib3JkZXItdC0yIGJvcmRlci1ncmF5LTQwMCB3LWZ1bGwgbXktMSIgICAsIF9fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiA4NDh9fSkKICAgICAgLCBSZWFjdC5jcmVhdGVFbGVtZW50KCdzcGFuJywgeyBjbGFzc05hbWU6ICJweC0yIiwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDg0OX19CiAgICAgICAgLCBkZW5WYWwsICcgJwogICAgICAgICwgUmVhY3QuY3JlYXRlRWxlbWVudCgnc3BhbicsIHsgY2xhc3NOYW1lOiBgJHtkZW5DYW5jZWxsZWQgPyAnbGluZS10aHJvdWdoIHRleHQtcmVkLTQwMCcgOiAnJ31gLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogODUxfX0KICAgICAgICAgICwgZGVuVW5pdAogICAgICAgICkKICAgICAgKQogICAgKQ0KICApOw0KfTsNCg0KDQovLyBUYWIgMzogVW5pdCBDYW5jZWxsYXRpb24NCmNvbnN0IFVuaXRDYW5jZWxsYXRpb25UYWIgPSAoKSA9PiB7DQogIGNvbnN0IFtjdXJyZW50TGV2ZWwsIHNldEN1cnJlbnRMZXZlbF0gPSB1c2VTdGF0ZSgxKTsNCiAgY29uc3QgW3NlbGVjdGVkRmFjdG9ycywgc2V0U2VsZWN0ZWRGYWN0b3JzXSA9IHVzZVN0YXRlKFtdKTsNCiAgY29uc3QgW3Nob3dTb2x1dGlvbiwgc2V0U2hvd1NvbHV0aW9uXSA9IHVzZVN0YXRlKGZhbHNlKTsNCiAgY29uc3QgW2hpbnQsIHNldEhpbnRdID0gdXNlU3RhdGUobnVsbCk7IC8vIFN0YXRlIGZvciBIaW50cw0KDQogIC8vIFVzZSBSZWFjdC51c2VNZW1vIHRvIGF2b2lkIHJlZGVmaW5pbmcgdGhpcyBvYmplY3Qgb24gZXZlcnkgcmVuZGVyDQogIGNvbnN0IGxldmVscyA9IFJlYWN0LnVzZU1lbW8oKCkgPT4gKHsNCiAgICAxOiB7DQogICAgICB0aXRsZTogJ0xldmVsIDE6IFdoYXQgaXMgQ2FuY2VsbGluZz8nLA0KICAgICAgcHJvYmxlbTogJzE1MCBjbSB0byBtZXRlcnMnLA0KICAgICAgc3RhcnQ6IHsgdmFsdWU6IDE1MCwgdW5pdDogJ2NtJyB9LA0KICAgICAgdGFyZ2V0OiAnbScsDQogICAgICBmYWN0b3JzOiBbDQogICAgICAgIHsgbnVtOiAnMSBtJywgZGVuOiAnMTAwIGNtJywgY29ycmVjdDogdHJ1ZSwgaWQ6ICcxLTEnIH0sDQogICAgICAgIHsgbnVtOiAnMTAwIGNtJywgZGVuOiAnMSBtJywgY29ycmVjdDogZmFsc2UsIGlkOiAnMS0yJyB9LA0KICAgICAgICB7IG51bTogJzEga20nLCBkZW46ICcxMDAwIG0nLCBjb3JyZWN0OiBmYWxzZSwgaWQ6ICcxLTMnIH0NCiAgICAgIF0sDQogICAgICBzb2x1dGlvbjogWyAnMS0xJyBdLA0KICAgICAgZXhwbGFuYXRpb246ICdXZSB1c2UgdGhlIGNvbnZlcnNpb24gZmFjdG9yIHdpdGggImNtIiBpbiB0aGUgZGVub21pbmF0b3Igc28gaXQgY2FuY2VscyB3aXRoIHRoZSAiY20iIGluIG91ciBzdGFydGluZyB2YWx1ZS4nLA0KICAgICAgY2FsY3VsYXRpb246ICcoIDE1MCDDlyAxICkgLyAxMDAgPSAxLjUgbScNCiAgICB9LA0KICAgIDI6IHsNCiAgICAgIHRpdGxlOiAnTGV2ZWwgMjogTXVsdGktU3RlcCAoY20g4oaSIG0g4oaSIGttKScsDQogICAgICBwcm9ibGVtOiAnMjUwLDAwMCBjbSB0byBraWxvbWV0ZXJzJywNCiAgICAgIHN0YXJ0OiB7IHZhbHVlOiAyNTAwMDAsIHVuaXQ6ICdjbScgfSwNCiAgICAgIHRhcmdldDogJ2ttJywNCiAgICAgIGZhY3RvcnM6IFsNCiAgICAgICAgeyBudW06ICcxIG0nLCBkZW46ICcxMDAgY20nLCBjb3JyZWN0OiB0cnVlLCBvcmRlcjogMSwgaWQ6ICcyLTEnIH0sDQogICAgICAgIHsgbnVtOiAnMSBrbScsIGRlbjogJzEwMDAgbScsIGNvcnJlY3Q6IHRydWUsIG9yZGVyOiAyLCBpZDogJzItMicgfSwNCiAgICAgICAgeyBudW06ICcxMDAgY20nLCBkZW46ICcxIG0nLCBjb3JyZWN0OiBmYWxzZSwgaWQ6ICcyLTMnIH0sDQogICAgICAgIHsgbnVtOiAnMTAwMCBtJywgZGVuOiAnMSBrbScsIGNvcnJlY3Q6IGZhbHNlLCBpZDogJzItNCcgfQ0KICAgICAgXSwNCiAgICAgIHNvbHV0aW9uOiBbJzItMScsICcyLTInXSwNCiAgICAgIGV4cGxhbmF0aW9uOiAnRmlyc3QgY2FuY2VsICJjbSIgdG8gZ2V0ICJtIiwgdGhlbiBjYW5jZWwgIm0iIHRvIGdldCAia20iLiBUaGUgb3JkZXIgbWF0dGVycyEnLA0KICAgICAgY2FsY3VsYXRpb246ICcoIDI1MDAwMCDDlyAxIMOXIDEgKSAvICggMTAwIMOXIDEwMDAgKSA9IDIuNSBrbScNCiAgICB9LA0KICAgIDM6IHsNCiAgICAgIHRpdGxlOiAnTGV2ZWwgMzogVGltZSBDb252ZXJzaW9uIChzZWMg4oaSIG1pbiDihpIgaHIpJywNCiAgICAgIHByb2JsZW06ICc3MjAwIHNlY29uZHMgdG8gaG91cnMnLA0KICAgICAgc3RhcnQ6IHsgdmFsdWU6IDcyMDAsIHVuaXQ6ICdzJyB9LA0KICAgICAgdGFyZ2V0OiAnaHInLA0KICAgICAgZmFjdG9yczogWw0KICAgICAgICB7IG51bTogJzEgbWluJywgZGVuOiAnNjAgcycsIGNvcnJlY3Q6IHRydWUsIG9yZGVyOiAxLCBpZDogJzMtMScgfSwNCiAgICAgICAgeyBudW06ICcxIGhyJywgZGVuOiAnNjAgbWluJywgY29ycmVjdDogdHJ1ZSwgb3JkZXI6IDIsIGlkOiAnMy0yJyB9LA0KICAgICAgICB7IG51bTogJzYwIHMnLCBkZW46ICcxIG1pbicsIGNvcnJlY3Q6IGZhbHNlLCBpZDogJzMtMycgfSwNCiAgICAgICAgeyBudW06ICc2MCBtaW4nLCBkZW46ICcxIGhyJywgY29ycmVjdDogZmFsc2UsIGlkOiAnMy00JyB9DQogICAgICBdLA0KICAgICAgc29sdXRpb246IFsnMy0xJywgJzMtMiddLA0KICAgICAgZXhwbGFuYXRpb246ICdDYW5jZWwgInNlY29uZHMiIHdpdGggdGhlIGZpcnN0IGZhY3RvciwgdGhlbiBjYW5jZWwgIm1pbnV0ZXMiIHdpdGggdGhlIHNlY29uZCB0byBiZSBsZWZ0IHdpdGggImhvdXJzIi4nLA0KICAgICAgY2FsY3VsYXRpb246ICcoIDcyMDAgw5cgMSDDlyAxICkgLyAoIDYwIMOXIDYwICkgPSAyIGhyJw0KICAgIH0NCiAgfSksIFtdKTsgLy8gRW1wdHkgZGVwZW5kZW5jeSBhcnJheSBtZWFucyB0aGlzIG9iamVjdCBpcyBjcmVhdGVkIG9ubHkgb25jZQ0KDQogIGNvbnN0IGN1cnJlbnRQcm9ibGVtID0gbGV2ZWxzW2N1cnJlbnRMZXZlbF07DQoNCiAgLy8gVGhpcyBzdGF0ZSB3aWxsIHRyYWNrIHRoZSAibGl2ZSIgY2FuY2VsbGF0aW9uIGFzIHVzZXIgY2xpY2tzDQogIGNvbnN0IFtsaXZlQ2FuY2VsbGF0aW9uLCBzZXRMaXZlQ2FuY2VsbGF0aW9uXSA9IHVzZVN0YXRlKHt9KTsNCg0KICAvLyBUaGlzIGZ1bmN0aW9uIHVwZGF0ZXMgdGhlIGxpdmUgY2FuY2VsbGF0aW9uIHN0YXRlIGFuZCByZXR1cm5zIHRoZSBjdXJyZW50IGFjdGl2ZSB1bml0DQogIGNvbnN0IHVwZGF0ZUxpdmVDYW5jZWxsYXRpb24gPSAoZmFjdG9ycykgPT4gew0KICAgIGxldCBhY3RpdmVVbml0ID0gY3VycmVudFByb2JsZW0uc3RhcnQudW5pdDsNCiAgICBjb25zdCBjYW5jZWxsYXRpb25zID0ge307IC8vIHsgJzEtMSc6IHsgbnVtOiBmYWxzZSwgZGVuOiB0cnVlIH0sICdzdGFydCc6IHsgdW5pdDogdHJ1ZSB9IH0NCiAgICANCiAgICBsZXQgc3RhcnRVbml0Q2FuY2VsbGVkID0gZmFsc2U7DQogICAgDQogICAgLy8gU29ydCBmYWN0b3JzIGJ5IHNlbGVjdGlvbiBvcmRlciBmb3IgdGhpcyBsb2dpYw0KICAgIGNvbnN0IG9yZGVyZWRGYWN0b3JzID0gZmFjdG9yczsgDQoNCiAgICBmb3IgKGNvbnN0IGZhY3RvciBvZiBvcmRlcmVkRmFjdG9ycykgew0KICAgICAgY29uc3QgW251bVZhbCwgbnVtVW5pdF0gPSBmYWN0b3IubnVtLnNwbGl0KCcgJyk7DQogICAgICBjb25zdCBbZGVuVmFsLCBkZW5Vbml0XSA9IGZhY3Rvci5kZW4uc3BsaXQoJyAnKTsNCiAgICAgIA0KICAgICAgbGV0IGRlbkNhbmNlbGxlZCA9IGZhbHNlOw0KICAgICAgDQogICAgICAvLyBDaGVjayBpZiB0aGUgZGVub21pbmF0b3IgY2FuY2VscyB0aGUgYWN0aXZlIHVuaXQNCiAgICAgIGlmIChkZW5Vbml0ID09PSBhY3RpdmVVbml0KSB7DQogICAgICAgIGRlbkNhbmNlbGxlZCA9IHRydWU7DQogICAgICAgIA0KICAgICAgICAvLyBNYXJrIHRoZSBhY3RpdmUgdW5pdCBhcyBjYW5jZWxsZWQNCiAgICAgICAgaWYgKCFzdGFydFVuaXRDYW5jZWxsZWQpIHsNCiAgICAgICAgICBjYW5jZWxsYXRpb25zWydzdGFydCddID0geyB1bml0OiB0cnVlIH07DQogICAgICAgICAgc3RhcnRVbml0Q2FuY2VsbGVkID0gdHJ1ZTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAvLyBGaW5kIHRoZSBwcmV2aW91cyBmYWN0b3IgdGhhdCBwcm92aWRlZCB0aGlzIHVuaXQNCiAgICAgICAgICBjb25zdCBwcmV2RmFjdG9yID0gb3JkZXJlZEZhY3RvcnMuZmluZCgoZiwgaSkgPT4gaSA8IG9yZGVyZWRGYWN0b3JzLmluZGV4T2YoZmFjdG9yKSAmJiBmLm51bS5zcGxpdCgnICcpWzFdID09PSBhY3RpdmVVbml0KTsNCiAgICAgICAgICBpZiAocHJldkZhY3Rvcikgew0KICAgICAgICAgICAgY2FuY2VsbGF0aW9uc1twcmV2RmFjdG9yLmlkXSA9IHsgLi4uY2FuY2VsbGF0aW9uc1twcmV2RmFjdG9yLmlkXSwgbnVtOiB0cnVlIH07DQogICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAvLyBUaGUgbmV3IGFjdGl2ZSB1bml0IGlzIHRoaXMgZmFjdG9yJ3MgbnVtZXJhdG9yDQogICAgICAgIGFjdGl2ZVVuaXQgPSBudW1Vbml0Ow0KICAgICAgfQ0KICAgICAgDQogICAgICBjYW5jZWxsYXRpb25zW2ZhY3Rvci5pZF0gPSB7IC4uLmNhbmNlbGxhdGlvbnNbZmFjdG9yLmlkXSwgZGVuOiBkZW5DYW5jZWxsZWQgfTsNCiAgICB9DQogICAgDQogICAgc2V0TGl2ZUNhbmNlbGxhdGlvbihjYW5jZWxsYXRpb25zKTsNCiAgICByZXR1cm4gYWN0aXZlVW5pdDsgLy8gUmV0dXJuIHRoZSBuZXcgYWN0aXZlIHVuaXQgZm9yIGhpbnQgbG9naWMNCiAgfTsNCg0KICBjb25zdCBoYW5kbGVGYWN0b3JDbGljayA9IChmYWN0b3IpID0+IHsNCiAgICBpZiAoc2hvd1NvbHV0aW9uKSByZXR1cm47DQogICAgDQogICAgY29uc3QgaXNTZWxlY3RlZCA9IHNlbGVjdGVkRmFjdG9ycy5zb21lKGYgPT4gZi5pZCA9PT0gZmFjdG9yLmlkKTsNCiAgICBsZXQgbmV3U2VsZWN0ZWRGYWN0b3JzOw0KICAgIGlmIChpc1NlbGVjdGVkKSB7DQogICAgICBuZXdTZWxlY3RlZEZhY3RvcnMgPSBzZWxlY3RlZEZhY3RvcnMuZmlsdGVyKGYgPT4gZi5pZCAhPT0gZmFjdG9yLmlkKTsNCiAgICB9IGVsc2Ugew0KICAgICAgbmV3U2VsZWN0ZWRGYWN0b3JzID0gWy4uLnNlbGVjdGVkRmFjdG9ycywgZmFjdG9yXTsNCiAgICB9DQogICAgDQogICAgc2V0U2VsZWN0ZWRGYWN0b3JzKG5ld1NlbGVjdGVkRmFjdG9ycyk7DQogICAgY29uc3QgbmV3QWN0aXZlVW5pdCA9IHVwZGF0ZUxpdmVDYW5jZWxsYXRpb24obmV3U2VsZWN0ZWRGYWN0b3JzKTsgLy8gVXBkYXRlIGxpdmUgY2FuY2VsbGF0aW9uDQoNCiAgICAvLyAtLS0gSGludCBMb2dpYyAtLS0NCiAgICBjb25zdCBzdGFydFVuaXQgPSBjdXJyZW50UHJvYmxlbS5zdGFydC51bml0Ow0KICAgIGNvbnN0IHRhcmdldFVuaXQgPSBjdXJyZW50UHJvYmxlbS50YXJnZXQ7DQogICAgDQogICAgaWYgKG5ld1NlbGVjdGVkRmFjdG9ycy5sZW5ndGggPT09IDApIHsNCiAgICAgIHNldEhpbnQobnVsbCk7DQogICAgICByZXR1cm47DQogICAgfQ0KICAgIA0KICAgIC8vIEdldCB0aGUgbGFzdCBzZWxlY3RlZCBmYWN0b3IgYW5kIGl0cyB1bml0cw0KICAgIGNvbnN0IGxhc3RGYWN0b3IgPSBuZXdTZWxlY3RlZEZhY3RvcnNbbmV3U2VsZWN0ZWRGYWN0b3JzLmxlbmd0aCAtIDFdOw0KICAgIGNvbnN0IFtsYXN0TnVtVmFsLCBsYXN0TnVtVW5pdF0gPSBsYXN0RmFjdG9yLm51bS5zcGxpdCgnICcpOw0KICAgIGNvbnN0IFtsYXN0RGVuVmFsLCBsYXN0RGVuVW5pdF0gPSBsYXN0RmFjdG9yLmRlbi5zcGxpdCgnICcpOw0KICAgIA0KICAgIC8vIEdldCB0aGUgYWN0aXZlIHVuaXQgKmJlZm9yZSogdGhpcyBsYXN0IGNsaWNrDQogICAgbGV0IGFjdGl2ZVVuaXQgPSBzdGFydFVuaXQ7DQogICAgbGV0IHN0YXJ0Q2FuY2VsbGVkID0gZmFsc2U7DQogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBuZXdTZWxlY3RlZEZhY3RvcnMubGVuZ3RoIC0gMTsgaSsrKSB7DQogICAgICAgIGNvbnN0IGYgPSBuZXdTZWxlY3RlZEZhY3RvcnNbaV07DQogICAgICAgIGNvbnN0IFtudW1VLCBkZW5VXSA9IFtmLm51bS5zcGxpdCgnICcpWzFdLCBmLmRlbi5zcGxpdCgnICcpWzFdXTsNCiAgICAgICAgaWYgKGRlblUgPT09IGFjdGl2ZVVuaXQpIHsNCiAgICAgICAgICAgIGlmICghc3RhcnRDYW5jZWxsZWQpIHsNCiAgICAgICAgICAgICAgICBzdGFydENhbmNlbGxlZCA9IHRydWU7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIC8vIFRoaXMgbG9naWMgZmluZHMgdGhlICpwcmV2aW91cyogZmFjdG9yIHRoYXQgZ2F2ZSB1cyB0aGUgYWN0aXZlIHVuaXQNCiAgICAgICAgICAgICAgICBjb25zdCBwRmFjdG9ycyA9IG5ld1NlbGVjdGVkRmFjdG9ycy5zbGljZSgwLCBpKTsNCiAgICAgICAgICAgICAgICBjb25zdCBwRmFjdG9yID0gcEZhY3RvcnMucmV2ZXJzZSgpLmZpbmQocGYgPT4gcGYubnVtLnNwbGl0KCcgJylbMV0gPT09IGFjdGl2ZVVuaXQpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgYWN0aXZlVW5pdCA9IG51bVU7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvLyBOb3cgY2hlY2sgdGhlIGxhc3QgZmFjdG9yDQogICAgaWYgKGxhc3REZW5Vbml0ID09PSBhY3RpdmVVbml0KSB7DQogICAgICAvLyBDb3JyZWN0IGNhbmNlbGxhdGlvbg0KICAgICAgaWYgKG5ld0FjdGl2ZVVuaXQgPT09IHRhcmdldFVuaXQpIHsNCiAgICAgICAgc2V0SGludCh7IHR5cGU6ICdnb29kJywgbWVzc2FnZTogYFBlcmZlY3QhIFlvdSd2ZSBjYW5jZWxsZWQgIiR7YWN0aXZlVW5pdH0iIGFuZCBhcmUgbGVmdCB3aXRoICIke25ld0FjdGl2ZVVuaXR9Iiwgd2hpY2ggaXMgeW91ciB0YXJnZXQgdW5pdCFgIH0pOw0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgc2V0SGludCh7IHR5cGU6ICdnb29kJywgbWVzc2FnZTogYEdvb2QhIFlvdSd2ZSBjYW5jZWxsZWQgIiR7YWN0aXZlVW5pdH0iLiBOb3cgeW91IG5lZWQgdG8gY2FuY2VsICIke25ld0FjdGl2ZVVuaXR9Ii5gIH0pOw0KICAgICAgfQ0KICAgIH0gZWxzZSB7DQogICAgICAvLyBJbmNvcnJlY3QgY2FuY2VsbGF0aW9uDQogICAgICBpZiAoYWN0aXZlVW5pdCA9PT0gdGFyZ2V0VW5pdCkgew0KICAgICAgICAgc2V0SGludCh7IHR5cGU6ICd3YXJuJywgbWVzc2FnZTogYFdob29wcyEgWW91IGFscmVhZHkgcmVhY2hlZCB5b3VyIHRhcmdldCB1bml0ICIke3RhcmdldFVuaXR9Ii4gWW91IGRvbid0IG5lZWQgYW55IG1vcmUgZmFjdG9ycy5gIH0pOw0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgIHNldEhpbnQoeyB0eXBlOiAnd2FybicsIG1lc3NhZ2U6IGBOb3QgdGhpcyBvbmUuIFRvIGNhbmNlbCAiJHthY3RpdmVVbml0fSIsIHlvdSBuZWVkIGEgZmFjdG9yIHdpdGggIiR7YWN0aXZlVW5pdH0iIG9uIHRoZSBib3R0b20gKGRlbm9taW5hdG9yKS5gIH0pOw0KICAgICAgfQ0KICAgIH0NCiAgfTsNCg0KICBjb25zdCBjaGVja0Fuc3dlciA9ICgpID0+IHsNCiAgICBzZXRTaG93U29sdXRpb24odHJ1ZSk7DQogICAgc2V0SGludChudWxsKTsgLy8gQ2xlYXIgaGludHMgd2hlbiBjaGVja2luZw0KICB9Ow0KDQogIGNvbnN0IHJlc2V0ID0gKCkgPT4gew0KICAgIHNldFNlbGVjdGVkRmFjdG9ycyhbXSk7DQogICAgc2V0U2hvd1NvbHV0aW9uKGZhbHNlKTsNCiAgICBzZXRIaW50KG51bGwpOyAvLyBDbGVhciBoaW50cyBvbiByZXNldA0KICAgIHNldExpdmVDYW5jZWxsYXRpb24oe30pOyAvLyBDbGVhciBsaXZlIGNhbmNlbGxhdGlvbg0KICB9Ow0KDQogIGNvbnN0IG5leHRMZXZlbCA9ICgpID0+IHsNCiAgICBpZiAoY3VycmVudExldmVsIDwgT2JqZWN0LmtleXMobGV2ZWxzKS5sZW5ndGgpIHsNCiAgICAgIHNldEN1cnJlbnRMZXZlbChjdXJyZW50TGV2ZWwgKyAxKTsNCiAgICAgIHJlc2V0KCk7DQogICAgfQ0KICB9Ow0KICANCiAgY29uc3QgcHJldkxldmVsID0gKCkgPT4gew0KICAgIGlmIChjdXJyZW50TGV2ZWwgPiAxKSB7DQogICAgICBzZXRDdXJyZW50TGV2ZWwoY3VycmVudExldmVsIC0gMSk7DQogICAgICByZXNldCgpOw0KICAgIH0NCiAgfTsNCiAgDQogIC8vIENoZWNrIGlmIHRoZSBzZWxlY3RlZCBmYWN0b3JzIGFyZSBjb3JyZWN0DQogIGxldCBpc0NvcnJlY3QgPSBmYWxzZTsNCiAgaWYgKHNob3dTb2x1dGlvbikgew0KICAgIGNvbnN0IHNlbGVjdGVkSWRzID0gc2VsZWN0ZWRGYWN0b3JzLm1hcChmID0+IGYuaWQpLnNvcnQoKTsNCiAgICBjb25zdCBzb2x1dGlvbklkcyA9IGN1cnJlbnRQcm9ibGVtLnNvbHV0aW9uLnNvcnQoKTsNCiAgICBpc0NvcnJlY3QgPSBKU09OLnN0cmluZ2lmeShzZWxlY3RlZElkcykgPT09IEpTT04uc3RyaW5naWZ5KHNvbHV0aW9uSWRzKTsNCiAgfQ0KDQogIC8vIERldGVybWluZSBmaW5hbCBzb2x1dGlvbiBjYW5jZWxsYXRpb24gKHdoZW4gc2hvd1NvbHV0aW9uIGlzIHRydWUgYW5kIGlzQ29ycmVjdCkNCiAgY29uc3QgZmluYWxDYW5jZWxsYXRpb25zID0gdXNlTWVtbygoKSA9PiB7DQogICAgLy8gVXNlIGxpdmVDYW5jZWxsYXRpb24gaWYgd2UncmUgbm90IHNob3dpbmcgdGhlIHNvbHV0aW9uIHlldA0KICAgIGlmICghc2hvd1NvbHV0aW9uKSByZXR1cm4gbGl2ZUNhbmNlbGxhdGlvbjsNCiAgICAvLyBJZiBzaG93aW5nIHNvbHV0aW9uIGJ1dCBpdCdzIHdyb25nLCAqc3RpbGwqIHVzZSBsaXZlQ2FuY2VsbGF0aW9uDQogICAgaWYgKHNob3dTb2x1dGlvbiAmJiAhaXNDb3JyZWN0KSByZXR1cm4gbGl2ZUNhbmNlbGxhdGlvbjsNCiAgICANCiAgICAvLyBJZiBzb2x1dGlvbiBpcyBzaG93biBBTkQgY29ycmVjdCwgY2FsY3VsYXRlIHRoZSBkZWZpbml0aXZlIGNhbmNlbGxhdGlvbg0KICAgIGxldCBhY3RpdmVVbml0ID0gY3VycmVudFByb2JsZW0uc3RhcnQudW5pdDsNCiAgICBjb25zdCBjYW5jZWxsYXRpb25zID0ge307DQogICAgbGV0IHN0YXJ0VW5pdENhbmNlbGxlZCA9IGZhbHNlOw0KDQogICAgLy8gU29ydCBzZWxlY3RlZCBmYWN0b3JzIGJ5IHRoZSBpbnRlbmRlZCBvcmRlciBmb3IgbXVsdGktc3RlcCBwcm9ibGVtcw0KICAgIGNvbnN0IG9yZGVyZWRGYWN0b3JzID0gWy4uLnNlbGVjdGVkRmFjdG9yc10uc29ydCgoYSwgYikgPT4gKGEub3JkZXIgfHwgMCkgLSAoYi5vcmRlciB8fCAwKSk7DQoNCiAgICBmb3IgKGNvbnN0IGZhY3RvciBvZiBvcmRlcmVkRmFjdG9ycykgew0KICAgICAgY29uc3QgW251bVZhbCwgbnVtVW5pdF0gPSBmYWN0b3IubnVtLnNwbGl0KCcgJyk7DQogICAgICBjb25zdCBbZGVuVmFsLCBkZW5Vbml0XSA9IGZhY3Rvci5kZW4uc3BsaXQoJyAnKTsNCiAgICAgIA0KICAgICAgbGV0IGRlbkNhbmNlbGxlZCA9IGZhbHNlOw0KICAgICAgDQogICAgICBpZiAoZGVuVW5pdCA9PT0gYWN0aXZlVW5pdCkgew0KICAgICAgICBkZW5DYW5jZWxsZWQgPSB0cnVlOw0KICAgICAgICBpZiAoIXN0YXJ0VW5pdENhbmNlbGxlZCkgew0KICAgICAgICAgIGNhbmNlbGxhdGlvbnNbJ3N0YXJ0J10gPSB7IHVuaXQ6IHRydWUgfTsNCiAgICAgICAgICBzdGFydFVuaXRDYW5jZWxsZWQgPSB0cnVlOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgIC8vIEZpbmQgdGhlIHByZXZpb3VzIGZhY3RvciB0aGF0IHByb3ZpZGVkIHRoaXMgdW5pdA0KICAgICAgICAgIGNvbnN0IHByZXZGYWN0b3IgPSBvcmRlcmVkRmFjdG9ycy5maW5kKGYgPT4gZi5udW0uc3BsaXQoJyAnKVsxXSA9PT0gYWN0aXZlVW5pdCk7DQogICAgICAgICAgaWYgKHByZXZGYWN0b3IpIHsNCiAgICAgICAgICAgIGNhbmNlbGxhdGlvbnNbcHJldkZhY3Rvci5pZF0gPSB7IC4uLmNhbmNlbGxhdGlvbnNbcHJldkZhY3Rvci5pZF0sIG51bTogdHJ1ZSB9Ow0KICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICBhY3RpdmVVbml0ID0gbnVtVW5pdDsNCiAgICAgIH0NCiAgICAgIGNhbmNlbGxhdGlvbnNbZmFjdG9yLmlkXSA9IHsgLi4uY2FuY2VsbGF0aW9uc1tmYWN0b3IuaWRdLCBkZW46IGRlbkNhbmNlbGxlZCB9Ow0KICAgIH0NCiAgICByZXR1cm4gY2FuY2VsbGF0aW9uczsNCiAgfSwgW3Nob3dTb2x1dGlvbiwgaXNDb3JyZWN0LCBzZWxlY3RlZEZhY3RvcnMsIGN1cnJlbnRQcm9ibGVtLCBsaXZlQ2FuY2VsbGF0aW9uXSk7DQoNCg0KICByZXR1cm4gKA0KICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ2RpdicsIHtfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogMTEwM319CiAgICAgICwgUmVhY3QuY3JlYXRlRWxlbWVudCgnaDInLCB7IGNsYXNzTmFtZTogInRleHQtMnhsIGZvbnQtYm9sZCBtYi00IHRleHQtYmx1ZS00MDAiICAgLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogMTEwNH19LCAiVW5pdCBDYW5jZWxsYXRpb24iICkKICAgICAgLCBSZWFjdC5jcmVhdGVFbGVtZW50KCdwJywgeyBjbGFzc05hbWU6ICJ0ZXh0LWdyYXktMzAwIG1iLTYiICwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDExMDV9fSwgIkxlYXJuIGhvdyB0byB1c2UgZnJhY3Rpb25zIHRvIGNhbmNlbCB1bml0cyBhbmQgY29udmVydCBtZWFzdXJlbWVudHMgc3RlcCBieSBzdGVwLiIgICAgICAgICAgICAgKQoKICAgICAgLCBSZWFjdC5jcmVhdGVFbGVtZW50KCdkaXYnLCB7IGNsYXNzTmFtZTogImJnLWdyYXktNzAwIHJvdW5kZWQtbGcgcC02IG1iLTYiICAgLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogMTEwN319CiAgICAgICAgLCBSZWFjdC5jcmVhdGVFbGVtZW50KCdkaXYnLCB7IGNsYXNzTmFtZTogImZsZXgganVzdGlmeS1iZXR3ZWVuIGl0ZW1zLWNlbnRlciBtYi00IiAgICwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDExMDh9fQogICAgICAgICAgLCBSZWFjdC5jcmVhdGVFbGVtZW50KCdoMycsIHsgY2xhc3NOYW1lOiAidGV4dC14bCBmb250LWJvbGQgdGV4dC1wdXJwbGUtMzAwIiAgLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogMTEwOX19LCBjdXJyZW50UHJvYmxlbS50aXRsZSkKICAgICAgICAgICwgUmVhY3QuY3JlYXRlRWxlbWVudCgnZGl2JywgeyBjbGFzc05hbWU6ICJmbGV4IGdhcC0yIiAsIF9fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiAxMTEwfX0KICAgICAgICAgICAgLCBSZWFjdC5jcmVhdGVFbGVtZW50KCdidXR0b24nLCB7DQogICAgICAgICAgICAgIG9uQ2xpY2s6IHByZXZMZXZlbCwNCiAgICAgICAgICAgICAgZGlzYWJsZWQ6IGN1cnJlbnRMZXZlbCA9PT0gMSwNCiAgICAgICAgICAgICAgY2xhc3NOYW1lOiAicC0yIGJnLWJsdWUtNjAwIHJvdW5kZWQtZnVsbCBkaXNhYmxlZDpvcGFjaXR5LTMwIGhvdmVyOmJnLWJsdWUtNTAwIHRyYW5zaXRpb24tYWxsIiAgICAgLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogMTExMX19DQoKICAgICAgICAgICAgICAsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoQ2hldnJvbkxlZnQsIHsgc2l6ZTogMjAsIGNsYXNzTmFtZTogInRleHQtd2hpdGUiLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogMTExNn19ICkKICAgICAgICAgICAgKQogICAgICAgICAgICAsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicsIHsNCiAgICAgICAgICAgICAgb25DbGljazogbmV4dExldmVsLA0KICAgICAgICAgICAgICBkaXNhYmxlZDogY3VycmVudExldmVsID09PSBPYmplY3Qua2V5cyhsZXZlbHMpLmxlbmd0aCwNCiAgICAgICAgICAgICAgY2xhc3NOYW1lOiAicC0yIGJnLWJsdWUtNjAwIHJvdW5kZWQtZnVsbCBkaXNhYmxlZDpvcGFjaXR5LTMwIGhvdmVyOmJnLWJsdWUtNTAwIHRyYW5zaXRpb24tYWxsIiAgICAgLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogMTExOH19DQoKICAgICAgICAgICAgICAsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoQ2hldnJvblJpZ2h0LCB7IHNpemU6IDIwLCBjbGFzc05hbWU6ICJ0ZXh0LXdoaXRlIiwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDExMjN9fSApCiAgICAgICAgICAgICkKICAgICAgICAgICkKICAgICAgICApCiAgICAgICAgLCBSZWFjdC5jcmVhdGVFbGVtZW50KCdwJywgeyBjbGFzc05hbWU6ICJ0ZXh0LWxnIHRleHQtZ3JheS0yMDAgbWItNiIgICwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDExMjd9fQogICAgICAgICAgLCBSZWFjdC5jcmVhdGVFbGVtZW50KCdzcGFuJywgeyBjbGFzc05hbWU6ICJmb250LXNlbWlib2xkIiwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDExMjh9fSwgIlByb2JsZW06IiksICIgQ29udmVydCAiICAsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nLCB7IGNsYXNzTmFtZTogImZvbnQtYm9sZCB0ZXh0LWJsdWUtNDAwIiAsIF9fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiAxMTI4fX0sIGN1cnJlbnRQcm9ibGVtLnByb2JsZW0pCiAgICAgICAgKQoKICAgICAgICAvKiBFcXVhdGlvbiBCdWlsZGVyICovCiAgICAgICAgLCBSZWFjdC5jcmVhdGVFbGVtZW50KCdkaXYnLCB7IGNsYXNzTmFtZTogImZsZXggZmxleC13cmFwIGl0ZW1zLWNlbnRlciBiZy1ncmF5LTgwMCBwLTQgcm91bmRlZC1sZyBtaW4taC1bMTAwcHhdIG92ZXJmbG93LXgtYXV0byIgICAgICAgLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogMTEzMn19CiAgICAgICAgICAsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ2RpdicsIHsgY2xhc3NOYW1lOiAiaW5saW5lLWZsZXggZmxleC1jb2wgaXRlbXMtY2VudGVyIHRleHQtbGcgbWQ6dGV4dC14bCBteC0xIGZvbnQtbW9ubyIgICAgICAsIF9fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiAxMTMzfX0KICAgICAgICAgICAgLCBSZWFjdC5jcmVhdGVFbGVtZW50KCdzcGFuJywgeyBjbGFzc05hbWU6ICJweC0yIiwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDExMzR9fQogICAgICAgICAgICAgICwgY3VycmVudFByb2JsZW0uc3RhcnQudmFsdWUsICcgJwogICAgICAgICAgICAgICwgUmVhY3QuY3JlYXRlRWxlbWVudCgnc3BhbicsIHsgY2xhc3NOYW1lOiBgJHtfb3B0aW9uYWxDaGFpbihbZmluYWxDYW5jZWxsYXRpb25zLCAnYWNjZXNzJywgXzggPT4gXzhbJ3N0YXJ0J10sICdvcHRpb25hbEFjY2VzcycsIF85ID0+IF85LnVuaXRdKSA/ICdsaW5lLXRocm91Z2ggdGV4dC1yZWQtNDAwJyA6ICcnfWAsIF9fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiAxMTM2fX0KICAgICAgICAgICAgICAgICwgY3VycmVudFByb2JsZW0uc3RhcnQudW5pdAogICAgICAgICAgICAgICkKICAgICAgICAgICAgKQogICAgICAgICAgICAsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nLCB7IGNsYXNzTmFtZTogImJvcmRlci10LTIgYm9yZGVyLWdyYXktNDAwIHctZnVsbCBteS0xIiAgICwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDExNDB9fSkKICAgICAgICAgICAgLCBSZWFjdC5jcmVhdGVFbGVtZW50KCdzcGFuJywgeyBjbGFzc05hbWU6ICJweC0yIiwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDExNDF9fSwgIjEiKQogICAgICAgICAgKQoKICAgICAgICAgICwgc2VsZWN0ZWRGYWN0b3JzLmxlbmd0aCA+IDAgJiYgUmVhY3QuY3JlYXRlRWxlbWVudCgnc3BhbicsIHsgY2xhc3NOYW1lOiAidGV4dC0yeGwgbXgtMiBmb250LW1vbm8iICAsIF9fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiAxMTQ0fX0sICLDlyIpCgogICAgICAgICAgLCBzZWxlY3RlZEZhY3RvcnMubWFwKChmYWN0b3IsIGluZGV4KSA9PiAoDQogICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChSZWFjdC5GcmFnbWVudCwgeyBrZXk6IGZhY3Rvci5pZCwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDExNDd9fQogICAgICAgICAgICAgICwgUmVhY3QuY3JlYXRlRWxlbWVudChGcmFjdGlvbiwgeyANCiAgICAgICAgICAgICAgICBudW06IGZhY3Rvci5udW0sIA0KICAgICAgICAgICAgICAgIGRlbjogZmFjdG9yLmRlbiwgDQogICAgICAgICAgICAgICAgbnVtQ2FuY2VsbGVkOiBfb3B0aW9uYWxDaGFpbihbZmluYWxDYW5jZWxsYXRpb25zLCAnYWNjZXNzJywgXzEwID0+IF8xMFtmYWN0b3IuaWRdLCAnb3B0aW9uYWxBY2Nlc3MnLCBfMTEgPT4gXzExLm51bV0pLA0KICAgICAgICAgICAgICAgIGRlbkNhbmNlbGxlZDogX29wdGlvbmFsQ2hhaW4oW2ZpbmFsQ2FuY2VsbGF0aW9ucywgJ2FjY2VzcycsIF8xMiA9PiBfMTJbZmFjdG9yLmlkXSwgJ29wdGlvbmFsQWNjZXNzJywgXzEzID0+IF8xMy5kZW5dKSwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDExNDh9fQ0KICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgLCBpbmRleCA8IHNlbGVjdGVkRmFjdG9ycy5sZW5ndGggLSAxICYmIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nLCB7IGNsYXNzTmFtZTogInRleHQtMnhsIG14LTIgZm9udC1tb25vIiAgLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogMTE1NH19LCAiw5ciKQogICAgICAgICAgICAgKQ0KICAgICAgICAgICApKQoKICAgICAgICAgICwgc2hvd1NvbHV0aW9uICYmIGlzQ29ycmVjdCAmJiAoDQogICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgnc3BhbicsIHsgY2xhc3NOYW1lOiAidGV4dC0yeGwgbXgtMiBmb250LW1vbm8iICAsIF9fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiAxMTU5fX0sICI9IikNCiAgICAgICAgICApCiAgICAgICAgICAsIHNob3dTb2x1dGlvbiAmJiBpc0NvcnJlY3QgJiYgKA0KICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgnZGl2JywgeyBjbGFzc05hbWU6ICJ0ZXh0LTJ4bCBmb250LWJvbGQgdGV4dC1ncmVlbi00MDAgbWwtMiIgICAsIF9fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiAxMTYyfX0KICAgICAgICAgICAgICAsIGN1cnJlbnRQcm9ibGVtLmNhbGN1bGF0aW9uLnNwbGl0KCc9JylbMV0KICAgICAgICAgICAgKQ0KICAgICAgICAgICkKICAgICAgICApCgogICAgICAgIC8qIEZhY3RvciBCYW5rICovCiAgICAgICAgLCBSZWFjdC5jcmVhdGVFbGVtZW50KCdkaXYnLCB7IGNsYXNzTmFtZTogIm15LTYiLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogMTE2OX19CiAgICAgICAgICAsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ2g0JywgeyBjbGFzc05hbWU6ICJmb250LXNlbWlib2xkIG1iLTMgdGV4dC1ncmF5LTMwMCIgICwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDExNzB9fSwgIkNob29zZSB5b3VyIGNvbnZlcnNpb24gZmFjdG9yKHMpOiIgICApCiAgICAgICAgICAsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ2RpdicsIHsgY2xhc3NOYW1lOiAiZmxleCBmbGV4LXdyYXAgZ2FwLTMiICAsIF9fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiAxMTcxfX0KICAgICAgICAgICAgLCBjdXJyZW50UHJvYmxlbS5mYWN0b3JzLm1hcChmYWN0b3IgPT4gew0KICAgICAgICAgICAgICBjb25zdCBpc1NlbGVjdGVkID0gc2VsZWN0ZWRGYWN0b3JzLnNvbWUoZiA9PiBmLmlkID09PSBmYWN0b3IuaWQpOw0KICAgICAgICAgICAgICByZXR1cm4gKA0KICAgICAgICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicsIHsNCiAgICAgICAgICAgICAgICAgIGtleTogZmFjdG9yLmlkLA0KICAgICAgICAgICAgICAgICAgb25DbGljazogKCkgPT4gaGFuZGxlRmFjdG9yQ2xpY2soZmFjdG9yKSwNCiAgICAgICAgICAgICAgICAgIGRpc2FibGVkOiBzaG93U29sdXRpb24sDQogICAgICAgICAgICAgICAgICBjbGFzc05hbWU6IGB0cmFuc2l0aW9uLWFsbCBwLTIgcm91bmRlZC1sZyAkew0KICAgICAgICAgICAgICAgICAgICBpc1NlbGVjdGVkDQogICAgICAgICAgICAgICAgICAgICAgPyAnYmctYmx1ZS02MDAgdGV4dC13aGl0ZSBzaGFkb3ctbGcnDQogICAgICAgICAgICAgICAgICAgICAgOiAnYmctZ3JheS02MDAgdGV4dC1ncmF5LTIwMCBob3ZlcjpiZy1ncmF5LTUwMCcNCiAgICAgICAgICAgICAgICAgIH0gJHtzaG93U29sdXRpb24gPyAnb3BhY2l0eS01MCBjdXJzb3Itbm90LWFsbG93ZWQnIDogJ2N1cnNvci1wb2ludGVyJ31gLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogMTE3NX19DQoKICAgICAgICAgICAgICAgICAgLCBSZWFjdC5jcmVhdGVFbGVtZW50KEZyYWN0aW9uLCB7IG51bTogZmFjdG9yLm51bSwgZGVuOiBmYWN0b3IuZGVuLCBudW1DYW5jZWxsZWQ6IGZhbHNlLCBkZW5DYW5jZWxsZWQ6IGZhbHNlLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogMTE4NX19ICkKICAgICAgICAgICAgICAgICkNCiAgICAgICAgICAgICAgKTsNCiAgICAgICAgICAgIH0pCiAgICAgICAgICApCiAgICAgICAgKQoKICAgICAgICAvKiBIaW50IEJveCAqLwogICAgICAgICwgaGludCAmJiAhc2hvd1NvbHV0aW9uICYmICgNCiAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCdkaXYnLCB7IGNsYXNzTmFtZTogYG15LTQgcC0zIHJvdW5kZWQtbGcgYm9yZGVyLTIgJHsNCiAgICAgICAgICAgIGhpbnQudHlwZSA9PT0gJ2dvb2QnID8gJ2JnLWdyZWVuLTkwMC81MCBib3JkZXItZ3JlZW4tNTAwJyA6DQogICAgICAgICAgICBoaW50LnR5cGUgPT09ICd3YXJuJyA/ICdiZy1vcmFuZ2UtOTAwLzUwIGJvcmRlci1vcmFuZ2UtNTAwJyA6DQogICAgICAgICAgICAnYmctcmVkLTkwMC81MCBib3JkZXItcmVkLTUwMCcNCiAgICAgICAgICB9YCwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDExOTR9fQogICAgICAgICAgICAsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ2RpdicsIHsgY2xhc3NOYW1lOiAiZmxleCBpdGVtcy1zdGFydCBnYXAtMiIgICwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDExOTl9fQogICAgICAgICAgICAgICwgaGludC50eXBlID09PSAnZ29vZCcgPyBSZWFjdC5jcmVhdGVFbGVtZW50KENoZWNrLCB7IHNpemU6IDIwLCBjbGFzc05hbWU6ICJtdC0wLjUgZmxleC1zaHJpbmstMCB0ZXh0LWdyZWVuLTQwMCIgICwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDEyMDB9fSApIDogUmVhY3QuY3JlYXRlRWxlbWVudChMaWdodGJ1bGIsIHsgc2l6ZTogMjAsIGNsYXNzTmFtZTogIm10LTAuNSBmbGV4LXNocmluay0wIHRleHQteWVsbG93LTQwMCIgICwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDEyMDB9fSApCiAgICAgICAgICAgICAgLCBSZWFjdC5jcmVhdGVFbGVtZW50KCdwJywgeyBjbGFzc05hbWU6IGB0ZXh0LXNtICR7DQogICAgICAgICAgICAgICAgaGludC50eXBlID09PSAnZ29vZCcgPyAndGV4dC1ncmVlbi0yMDAnIDoNCiAgICAgICAgICAgICAgICBoaW50LnR5cGUgPT09ICd3YXJuJyA/ICd0ZXh0LW9yYW5nZS0yMDAnIDoNCiAgICAgICAgICAgICAgICAndGV4dC1yZWQtMjAwJw0KICAgICAgICAgICAgICB9YCwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDEyMDF9fQogICAgICAgICAgICAgICAgLCBoaW50Lm1lc3NhZ2UKICAgICAgICAgICAgICApCiAgICAgICAgICAgICkKICAgICAgICAgICkNCiAgICAgICAgKQoKICAgICAgICAvKiBDb250cm9scyAqLwogICAgICAgICwgUmVhY3QuY3JlYXRlRWxlbWVudCgnZGl2JywgeyBjbGFzc05hbWU6ICJmbGV4IGZsZXgtd3JhcCBnYXAtNCBtdC02IiAgICwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDEyMTN9fQogICAgICAgICAgLCBSZWFjdC5jcmVhdGVFbGVtZW50KCdidXR0b24nLCB7DQogICAgICAgICAgICBvbkNsaWNrOiBjaGVja0Fuc3dlciwNCiAgICAgICAgICAgIGRpc2FibGVkOiBzaG93U29sdXRpb24sDQogICAgICAgICAgICBjbGFzc05hbWU6ICJweC02IHB5LTMgYmctYmx1ZS02MDAgaG92ZXI6YmctYmx1ZS03MDAgdGV4dC13aGl0ZSByb3VuZGVkLWxnIGZvbnQtc2VtaWJvbGQgdHJhbnNpdGlvbi1hbGwgZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTIgZGlzYWJsZWQ6b3BhY2l0eS01MCIgICAgICAgICAgICwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDEyMTR9fQ0KCiAgICAgICAgICAgICwgUmVhY3QuY3JlYXRlRWxlbWVudChDaGVjaywgeyBzaXplOiAyMCwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDEyMTl9fSApLCAiIENoZWNrIEFuc3dlciIKICAgICAgICAgICkKICAgICAgICAgICwgUmVhY3QuY3JlYXRlRWxlbWVudCgnYnV0dG9uJywgew0KICAgICAgICAgICAgb25DbGljazogcmVzZXQsDQogICAgICAgICAgICBjbGFzc05hbWU6ICJweC02IHB5LTMgYmctZ3JheS02MDAgaG92ZXI6YmctZ3JheS01MDAgdGV4dC13aGl0ZSByb3VuZGVkLWxnIGZvbnQtc2VtaWJvbGQgdHJhbnNpdGlvbi1hbGwgZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTIiICAgICAgICAgICwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDEyMjF9fQ0KCiAgICAgICAgICAgICwgUmVhY3QuY3JlYXRlRWxlbWVudChSZWZyZXNoQ3csIHsgc2l6ZTogMTgsIF9fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiAxMjI1fX0gKSwgIiBSZXNldCIKICAgICAgICAgICkKICAgICAgICApCgogICAgICAgIC8qIFNvbHV0aW9uIEZlZWRiYWNrICovCiAgICAgICAgLCBzaG93U29sdXRpb24gJiYgKA0KICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ2RpdicsIHsgY2xhc3NOYW1lOiBgbXQtNiBwLTQgcm91bmRlZC1sZyBib3JkZXItMiAkew0KICAgICAgICAgICAgaXNDb3JyZWN0ID8gJ2JnLWdyZWVuLTkwMC81MCBib3JkZXItZ3JlZW4tNTAwJyA6ICdiZy1yZWQtOTAwLzUwIGJvcmRlci1yZWQtNTAwJw0KICAgICAgICAgIH1gLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogMTIzMX19CiAgICAgICAgICAgICwgUmVhY3QuY3JlYXRlRWxlbWVudCgnZGl2JywgeyBjbGFzc05hbWU6ICJmbGV4IGl0ZW1zLXN0YXJ0IGdhcC0zIiAgLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogMTIzNH19CiAgICAgICAgICAgICAgLCBpc0NvcnJlY3QgPyBSZWFjdC5jcmVhdGVFbGVtZW50KFRyb3BoeSwgeyBzaXplOiAyNCwgY2xhc3NOYW1lOiAidGV4dC15ZWxsb3ctNDAwIiwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDEyMzV9fSApIDogUmVhY3QuY3JlYXRlRWxlbWVudChYLCB7IHNpemU6IDI0LCBjbGFzc05hbWU6ICJ0ZXh0LXJlZC00MDAiLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogMTIzNX19ICkKICAgICAgICAgICAgICAsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ2RpdicsIHtfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogMTIzNn19CiAgICAgICAgICAgICAgICAsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ2g0JywgeyBjbGFzc05hbWU6ICJmb250LWJvbGQgdGV4dC1sZyBtYi0yIiAgLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogMTIzN319CiAgICAgICAgICAgICAgICAgICwgaXNDb3JyZWN0ID8gJ0NvcnJlY3QhJyA6ICdOb3QgUXVpdGUhJwogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgLCBSZWFjdC5jcmVhdGVFbGVtZW50KCdwJywgeyBjbGFzc05hbWU6ICJtYi0yIiwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDEyNDB9fQogICAgICAgICAgICAgICAgICAsIGlzQ29ycmVjdCA/IGN1cnJlbnRQcm9ibGVtLmV4cGxhbmF0aW9uIDogJ1lvdXIgc2VsZWN0ZWQgZmFjdG9ycyBkb25cJ3QgbWF0Y2ggdGhlIHNvbHV0aW9uLiBUcnkgYWdhaW4hJwogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgLCBpc0NvcnJlY3QgJiYgKA0KICAgICAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgnZGl2JywgeyBjbGFzc05hbWU6ICJmb250LW1vbm8gYmctZ3JheS04MDAgcC0zIHJvdW5kZWQgbXQtMiIgICAgLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogMTI0NH19LCAiQ2FsY3VsYXRpb246ICIKICAgICAgICAgICAgICAgICAgICAgLCBjdXJyZW50UHJvYmxlbS5jYWxjdWxhdGlvbgogICAgICAgICAgICAgICAgICApDQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICkKICAgICAgICAgICAgKQogICAgICAgICAgKQ0KICAgICAgICApCiAgICAgICkKICAgICkNCiAgKTsNCn07DQoNCg0KLy8gVGFiIDQ6IFByYWN0aWNlDQpjb25zdCBQcmFjdGljZVRhYiA9ICgpID0+IHsNCiAgY29uc3QgW3F1ZXN0aW9ucywgc2V0UXVlc3Rpb25zXSA9IHVzZVN0YXRlKFtdKTsNCiAgY29uc3QgW2N1cnJlbnRRdWVzdGlvbkluZGV4LCBzZXRDdXJyZW50UXVlc3Rpb25JbmRleF0gPSB1c2VTdGF0ZSgwKTsNCiAgY29uc3QgW3VzZXJBbnN3ZXJzLCBzZXRVc2VyQW5zd2Vyc10gPSB1c2VTdGF0ZSh7fSk7DQogIGNvbnN0IFtzaG93RmVlZGJhY2ssIHNldFNob3dGZWVkYmFja10gPSB1c2VTdGF0ZShmYWxzZSk7DQogIGNvbnN0IFt1c2VkUXVlc3Rpb25JZHMsIHNldFVzZWRRdWVzdGlvbklkc10gPSB1c2VTdGF0ZShbXSk7DQogIGNvbnN0IFtzY29yZSwgc2V0U2NvcmVdID0gdXNlU3RhdGUoMCk7DQoNCiAgY29uc3QgYWxsUXVlc3Rpb25zID0gdXNlTWVtbygoKSA9PiBbDQogICAgeyBpZDogMSwgcTogJ0NvbnZlcnQgNS41IG1ldGVycyB0byBjZW50aW1ldGVycy4nLCBhOiA1NTAsIHVuaXQ6ICdjbScsIHR5cGU6ICdzaW1wbGUnIH0sDQogICAgeyBpZDogMiwgcTogJ0NvbnZlcnQgMi41IGtpbG9tZXRlcnMgdG8gbWV0ZXJzLicsIGE6IDI1MDAsIHVuaXQ6ICdtJywgdHlwZTogJ3NpbXBsZScgfSwNCiAgICB7IGlkOiAzLCBxOiAnQ29udmVydCAxNTAwIGdyYW1zIHRvIGtpbG9ncmFtcy4nLCBhOiAxLjUsIHVuaXQ6ICdrZycsIHR5cGU6ICdzaW1wbGUnIH0sDQogICAgeyBpZDogNCwgcTogJ0NvbnZlcnQgNzUwIG1pbGxpZ3JhbXMgdG8gZ3JhbXMuJywgYTogMC43NSwgdW5pdDogJ2cnLCB0eXBlOiAnc2ltcGxlJyB9LA0KICAgIHsgaWQ6IDUsIHE6ICdDb252ZXJ0IDMuMiBsaXRlcnMgdG8gbWlsbGlsaXRlcnMuJywgYTogMzIwMCwgdW5pdDogJ21MJywgdHlwZTogJ3NpbXBsZScgfSwNCiAgICB7IGlkOiA2LCBxOiAnQ29udmVydCA0NSBzZWNvbmRzIHRvIG1pbnV0ZXMuJywgYTogMC43NSwgdW5pdDogJ21pbicsIHR5cGU6ICdzaW1wbGUnIH0sDQogICAgeyBpZDogNywgcTogJ0NvbnZlcnQgMi41IGhvdXJzIHRvIG1pbnV0ZXMuJywgYTogMTUwLCB1bml0OiAnbWluJywgdHlwZTogJ3NpbXBsZScgfSwNCiAgICB7IGlkOiA4LCBxOiAnSG93IG1hbnkgaW5jaGVzIGFyZSBpbiA1MC44IGNtPyAoMSBpbmNoID0gMi41NCBjbSknLCBhOiAyMCwgdW5pdDogJ2luJywgdHlwZTogJ21peGVkJyB9LA0KICAgIHsgaWQ6IDksIHE6ICdIb3cgbWFueSBraWxvZ3JhbXMgaXMgMTY1IGxicz8gKDEga2cg4omIIDIuMiBsYnMpJywgYTogNzUsIHVuaXQ6ICdrZycsIHR5cGU6ICdtaXhlZCcgfSwNCiAgICB7IGlkOiAxMCwgcTogJ0hvdyBtYW55IG1ldGVycyBhcmUgaW4gMS4yIG1pbGVzPyAoMSBtaWxlIOKJiCAxLjYwOSBrbSknLCBhOiAxOTMwLjgsIHVuaXQ6ICdtJywgdHlwZTogJ2NoYWxsZW5nZScgfSwNCiAgICB7IGlkOiAxMSwgcTogJ0NvbnZlcnQgMiBkYXlzIGludG8gc2Vjb25kcy4nLCBhOiAxNzI4MDAsIHVuaXQ6ICdzJywgdHlwZTogJ2NoYWxsZW5nZScgfSwNCiAgICB7IGlkOiAxMiwgcTogJ0NvbnZlcnQgMC41IGtnIHRvIG1pbGxpZ3JhbXMuJywgYTogNTAwMDAwLCB1bml0OiAnbWcnLCB0eXBlOiAnY2hhbGxlbmdlJyB9LA0KICAgIHsgaWQ6IDEzLCBxOiAnSG93IG1hbnkgVVMgZ2FsbG9ucyBpcyAyMCBsaXRlcnM/ICgxIGdhbCDiiYggMy43ODUgTCknLCBhOiA1LjI4LCB1bml0OiAnZ2FsJywgdHlwZTogJ21peGVkJyB9LA0KICBdLCBbXSk7DQoNCiAgY29uc3QgZ2VuZXJhdGVRdWVzdGlvbnMgPSB1c2VDYWxsYmFjaygoKSA9PiB7DQogICAgbGV0IGF2YWlsYWJsZSA9IGFsbFF1ZXN0aW9ucy5maWx0ZXIocSA9PiAhdXNlZFF1ZXN0aW9uSWRzLmluY2x1ZGVzKHEuaWQpKTsNCiAgICBpZiAoYXZhaWxhYmxlLmxlbmd0aCA8IDUpIHsNCiAgICAgIHNldFVzZWRRdWVzdGlvbklkcyhbXSk7DQogICAgICBhdmFpbGFibGUgPSBhbGxRdWVzdGlvbnM7DQogICAgfQ0KICAgIA0KICAgIGNvbnN0IHNodWZmbGVkID0gWy4uLmF2YWlsYWJsZV0uc29ydCgoKSA9PiAwLjUgLSBNYXRoLnJhbmRvbSgpKTsNCiAgICBjb25zdCBzZWxlY3RlZCA9IHNodWZmbGVkLnNsaWNlKDAsIDUpOw0KICAgIA0KICAgIHNldFF1ZXN0aW9ucyhzZWxlY3RlZCk7DQogICAgc2V0VXNlZFF1ZXN0aW9uSWRzKHByZXYgPT4gWy4uLnByZXYsIC4uLnNlbGVjdGVkLm1hcChxID0+IHEuaWQpXSk7DQogICAgc2V0Q3VycmVudFF1ZXN0aW9uSW5kZXgoMCk7DQogICAgc2V0VXNlckFuc3dlcnMoe30pOw0KICAgIHNldFNob3dGZWVkYmFjayhmYWxzZSk7DQogICAgc2V0U2NvcmUoMCk7DQogIH0sIFthbGxRdWVzdGlvbnMsIHVzZWRRdWVzdGlvbklkc10pOw0KDQogIHVzZUVmZmVjdCgoKSA9PiB7DQogICAgaWYgKHF1ZXN0aW9ucy5sZW5ndGggPT09IDApIHsNCiAgICAgIGdlbmVyYXRlUXVlc3Rpb25zKCk7DQogICAgfQ0KICB9LCBbcXVlc3Rpb25zLCBnZW5lcmF0ZVF1ZXN0aW9uc10pOw0KDQogIGNvbnN0IGhhbmRsZUFuc3dlckNoYW5nZSA9IChlKSA9PiB7DQogICAgc2V0VXNlckFuc3dlcnMoew0KICAgICAgLi4udXNlckFuc3dlcnMsDQogICAgICBbY3VycmVudFF1ZXN0aW9uSW5kZXhdOiBlLnRhcmdldC52YWx1ZQ0KICAgIH0pOw0KICB9Ow0KDQogIGNvbnN0IGNoZWNrQW5zd2VyID0gKCkgPT4gew0KICAgIGNvbnN0IHVzZXJBbnN3ZXIgPSBwYXJzZUZsb2F0KHVzZXJBbnN3ZXJzW2N1cnJlbnRRdWVzdGlvbkluZGV4XSk7DQogICAgY29uc3QgY29ycmVjdEFuc3dlciA9IHF1ZXN0aW9uc1tjdXJyZW50UXVlc3Rpb25JbmRleF0uYTsNCiAgICANCiAgICAvLyBDaGVjayBmb3IgZmxvYXRpbmcgcG9pbnQgaXNzdWVzDQogICAgY29uc3QgaXNDb3JyZWN0ID0gTWF0aC5hYnModXNlckFuc3dlciAtIGNvcnJlY3RBbnN3ZXIpIDwgMC4wMTsNCg0KICAgIGlmIChpc0NvcnJlY3QpIHsNCiAgICAgIHNldFNjb3JlKHMgPT4gcyArIDEpOw0KICAgIH0NCiAgICBzZXRTaG93RmVlZGJhY2sodHJ1ZSk7DQogIH07DQoNCiAgY29uc3QgbmV4dFF1ZXN0aW9uID0gKCkgPT4gew0KICAgIHNldFNob3dGZWVkYmFjayhmYWxzZSk7DQogICAgc2V0Q3VycmVudFF1ZXN0aW9uSW5kZXgoaSA9PiBpICsgMSk7DQogIH07DQoNCiAgaWYgKHF1ZXN0aW9ucy5sZW5ndGggPT09IDApIHsNCiAgICByZXR1cm4gUmVhY3QuY3JlYXRlRWxlbWVudCgnZGl2Jywge19fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiAxMzMzfX0sICJMb2FkaW5nIHF1ZXN0aW9ucy4uLiIgKTsNCiAgfQ0KDQogIGNvbnN0IGlzUXVpek92ZXIgPSBjdXJyZW50UXVlc3Rpb25JbmRleCA+PSBxdWVzdGlvbnMubGVuZ3RoOw0KICANCiAgaWYgKGlzUXVpek92ZXIpIHsNCiAgICByZXR1cm4gKA0KICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgnZGl2Jywge19fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiAxMzQwfX0KICAgICAgICAsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ2gyJywgeyBjbGFzc05hbWU6ICJ0ZXh0LTJ4bCBmb250LWJvbGQgbWItNCB0ZXh0LWJsdWUtNDAwIiAgICwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDEzNDF9fSwgIlByYWN0aWNlIENvbXBsZXRlISIgKQogICAgICAgICwgUmVhY3QuY3JlYXRlRWxlbWVudCgnZGl2JywgeyBjbGFzc05hbWU6ICJiZy1ncmF5LTcwMCByb3VuZGVkLWxnIHAtOCB0ZXh0LWNlbnRlciIgICAsIF9fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiAxMzQyfX0KICAgICAgICAgICwgUmVhY3QuY3JlYXRlRWxlbWVudChUcm9waHksIHsgc2l6ZTogNjQsIGNsYXNzTmFtZTogInRleHQteWVsbG93LTQwMCBteC1hdXRvIG1iLTYiICAsIF9fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiAxMzQzfX0gKQogICAgICAgICAgLCBSZWFjdC5jcmVhdGVFbGVtZW50KCdoMycsIHsgY2xhc3NOYW1lOiAidGV4dC0zeGwgZm9udC1ib2xkIG1iLTQiICAsIF9fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiAxMzQ0fX0sICJZb3VyIFNjb3JlOiAiICAsIHNjb3JlLCAiIC8gIiAgLCBxdWVzdGlvbnMubGVuZ3RoKQogICAgICAgICAgLCBSZWFjdC5jcmVhdGVFbGVtZW50KCdwJywgeyBjbGFzc05hbWU6ICJ0ZXh0LWdyYXktMzAwIG1iLTgiICwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDEzNDV9fQogICAgICAgICAgICAsIHNjb3JlID09PSBxdWVzdGlvbnMubGVuZ3RoID8gIkFtYXppbmcgd29yayEgWW91J3JlIGEgdW5pdCBjb252ZXJzaW9uIG1hc3RlciEiIDogIkdyZWF0IGVmZm9ydCEgS2VlcCBwcmFjdGljaW5nIHRvIGltcHJvdmUuIgogICAgICAgICAgKQogICAgICAgICAgLCBSZWFjdC5jcmVhdGVFbGVtZW50KCdidXR0b24nLCB7DQogICAgICAgICAgICBvbkNsaWNrOiBnZW5lcmF0ZVF1ZXN0aW9ucywNCiAgICAgICAgICAgIGNsYXNzTmFtZTogInB4LTYgcHktMyBiZy1ibHVlLTYwMCBob3ZlcjpiZy1ibHVlLTcwMCB0ZXh0LXdoaXRlIHJvdW5kZWQtbGcgZm9udC1zZW1pYm9sZCB0cmFuc2l0aW9uLWFsbCBmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMiBteC1hdXRvIiAgICAgICAgICAgLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogMTM0OH19DQoKICAgICAgICAgICAgLCBSZWFjdC5jcmVhdGVFbGVtZW50KFJlZnJlc2hDdywgeyBzaXplOiAyMCwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDEzNTJ9fSApLCAiIFRyeSBOZXcgUXVlc3Rpb25zIgogICAgICAgICAgKQogICAgICAgICkKICAgICAgKQ0KICAgICk7DQogIH0NCg0KICBjb25zdCBjdXJyZW50UXVlc3Rpb24gPSBxdWVzdGlvbnNbY3VycmVudFF1ZXN0aW9uSW5kZXhdOw0KICBjb25zdCB1c2VyQW5zd2VyID0gdXNlckFuc3dlcnNbY3VycmVudFF1ZXN0aW9uSW5kZXhdOw0KDQogIGxldCBpc0NvcnJlY3QgPSBmYWxzZTsNCiAgaWYgKHNob3dGZWVkYmFjaykgew0KICAgIGNvbnN0IHVzZXJBbnN3ZXJOdW0gPSBwYXJzZUZsb2F0KHVzZXJBbnN3ZXIpOw0KICAgIGNvbnN0IGNvcnJlY3RBbnN3ZXIgPSBjdXJyZW50UXVlc3Rpb24uYTsNCiAgICBpc0NvcnJlY3QgPSBNYXRoLmFicyh1c2VyQW5zd2VyTnVtIC0gY29ycmVjdEFuc3dlcikgPCAwLjAxOw0KICB9DQoNCiAgcmV0dXJuICgNCiAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCdkaXYnLCB7X19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDEzNzB9fQogICAgICAsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ2gyJywgeyBjbGFzc05hbWU6ICJ0ZXh0LTJ4bCBmb250LWJvbGQgbWItNCB0ZXh0LWJsdWUtNDAwIiAgICwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDEzNzF9fSwgIlByYWN0aWNlIFpvbmUiICkKICAgICAgLCBSZWFjdC5jcmVhdGVFbGVtZW50KCdwJywgeyBjbGFzc05hbWU6ICJ0ZXh0LWdyYXktMzAwIG1iLTYiICwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDEzNzJ9fSwgIlRlc3QgeW91ciBrbm93bGVkZ2UhIEVudGVyIHRoZSBjb3JyZWN0IG51bWJlciBmb3IgdGhlIGNvbnZlcnNpb24uIiAgICAgICAgICkKCiAgICAgICwgUmVhY3QuY3JlYXRlRWxlbWVudCgnZGl2JywgeyBjbGFzc05hbWU6ICJiZy1ncmF5LTcwMCByb3VuZGVkLWxnIHAtOCIgICwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDEzNzR9fQogICAgICAgICwgUmVhY3QuY3JlYXRlRWxlbWVudCgnZGl2JywgeyBjbGFzc05hbWU6ICJmbGV4IGp1c3RpZnktYmV0d2VlbiBpdGVtcy1jZW50ZXIgbWItNCIgICAsIF9fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiAxMzc1fX0KICAgICAgICAgICwgUmVhY3QuY3JlYXRlRWxlbWVudCgnc3BhbicsIHsgY2xhc3NOYW1lOiAidGV4dC1zbSBmb250LXNlbWlib2xkIHRleHQtZ3JheS00MDAiICAsIF9fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiAxMzc2fX0sICJRdWVzdGlvbiAiICwgY3VycmVudFF1ZXN0aW9uSW5kZXggKyAxLCAiIG9mICIgICwgcXVlc3Rpb25zLmxlbmd0aCkKICAgICAgICAgICwgUmVhY3QuY3JlYXRlRWxlbWVudCgnc3BhbicsIHsgY2xhc3NOYW1lOiBgcHgtMyBweS0xIHJvdW5kZWQtZnVsbCB0ZXh0LXhzIGZvbnQtYm9sZCAkew0KICAgICAgICAgICAgY3VycmVudFF1ZXN0aW9uLnR5cGUgPT09ICdzaW1wbGUnID8gJ2JnLWdyZWVuLTgwMCB0ZXh0LWdyZWVuLTIwMCcgOg0KICAgICAgICAgICAgY3VycmVudFF1ZXN0aW9uLnR5cGUgPT09ICdtaXhlZCcgPyAnYmcteWVsbG93LTgwMCB0ZXh0LXllbGxvdy0yMDAnIDoNCiAgICAgICAgICAgICdiZy1yZWQtODAwIHRleHQtcmVkLTIwMCcNCiAgICAgICAgICB9YCwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDEzNzd9fQogICAgICAgICAgICAsIGN1cnJlbnRRdWVzdGlvbi50eXBlCiAgICAgICAgICApCiAgICAgICAgKQoKICAgICAgICAsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ2gzJywgeyBjbGFzc05hbWU6ICJ0ZXh0LXhsIGZvbnQtc2VtaWJvbGQgbWItNiB0ZXh0LWdyYXktMjAwIiAgICwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDEzODZ9fSwgY3VycmVudFF1ZXN0aW9uLnEpCgogICAgICAgICwgUmVhY3QuY3JlYXRlRWxlbWVudCgnZGl2JywgeyBjbGFzc05hbWU6ICJmbGV4IGZsZXgtY29sIHNtOmZsZXgtcm93IGdhcC0yIGl0ZW1zLWNlbnRlciIgICAgLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogMTM4OH19CiAgICAgICAgICAsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jywgew0KICAgICAgICAgICAgdHlwZTogIm51bWJlciIsDQogICAgICAgICAgICBzdGVwOiAiYW55IiwNCiAgICAgICAgICAgIHZhbHVlOiB1c2VyQW5zd2VyIHx8ICcnLA0KICAgICAgICAgICAgb25DaGFuZ2U6IGhhbmRsZUFuc3dlckNoYW5nZSwNCiAgICAgICAgICAgIGRpc2FibGVkOiBzaG93RmVlZGJhY2ssDQogICAgICAgICAgICBjbGFzc05hbWU6ICJwcmFjdGljZS1pbnB1dCBmbGV4LWdyb3cgdy1mdWxsIHNtOnctYXV0byBweC00IHB5LTMgYmctZ3JheS04MDAgYm9yZGVyLTIgYm9yZGVyLWdyYXktNjAwIHJvdW5kZWQtbGcgdGV4dC13aGl0ZSB0ZXh0LWxnIGZvY3VzOm91dGxpbmUtbm9uZSBmb2N1czpib3JkZXItYmx1ZS01MDAgZGlzYWJsZWQ6b3BhY2l0eS01MCIgICAgICAgICAgICAgICwNCiAgICAgICAgICAgIHBsYWNlaG9sZGVyOiAiVHlwZSB5b3VyIGFuc3dlciIgICwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDEzODl9fQ0KICAgICAgICAgICkKICAgICAgICAgICwgUmVhY3QuY3JlYXRlRWxlbWVudCgnc3BhbicsIHsgY2xhc3NOYW1lOiAidGV4dC1sZyBmb250LXNlbWlib2xkIHRleHQtZ3JheS0zMDAiICAsIF9fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiAxMzk4fX0sIGN1cnJlbnRRdWVzdGlvbi51bml0KQogICAgICAgICkKCiAgICAgICAgLCBzaG93RmVlZGJhY2sgJiYgKA0KICAgICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ2RpdicsIHsgY2xhc3NOYW1lOiBgbXQtNiBwLTQgcm91bmRlZC1sZyBib3JkZXItMiAkew0KICAgICAgICAgICAgaXNDb3JyZWN0ID8gJ2JnLWdyZWVuLTkwMC81MCBib3JkZXItZ3JlZW4tNTAwJyA6ICdiZy1yZWQtOTAwLzUwIGJvcmRlci1yZWQtNTAwJw0KICAgICAgICAgIH1gLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogMTQwMn19CiAgICAgICAgICAgICwgUmVhY3QuY3JlYXRlRWxlbWVudCgnZGl2JywgeyBjbGFzc05hbWU6ICJmbGV4IGl0ZW1zLXN0YXJ0IGdhcC0zIiAgLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogMTQwNX19CiAgICAgICAgICAgICAgLCBpc0NvcnJlY3QgPyBSZWFjdC5jcmVhdGVFbGVtZW50KENoZWNrLCB7IHNpemU6IDI0LCBjbGFzc05hbWU6ICJ0ZXh0LWdyZWVuLTQwMCIsIF9fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiAxNDA2fX0gKSA6IFJlYWN0LmNyZWF0ZUVsZW1lbnQoWCwgeyBzaXplOiAyNCwgY2xhc3NOYW1lOiAidGV4dC1yZWQtNDAwIiwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDE0MDZ9fSApCiAgICAgICAgICAgICAgLCBSZWFjdC5jcmVhdGVFbGVtZW50KCdkaXYnLCB7X19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDE0MDd9fQogICAgICAgICAgICAgICAgLCBSZWFjdC5jcmVhdGVFbGVtZW50KCdoNCcsIHsgY2xhc3NOYW1lOiAiZm9udC1ib2xkIHRleHQtbGcgbWItMSIgICwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDE0MDh9fQogICAgICAgICAgICAgICAgICAsIGlzQ29ycmVjdCA/ICdDb3JyZWN0IScgOiAnSW5jb3JyZWN0JwogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgLCBSZWFjdC5jcmVhdGVFbGVtZW50KCdwJywgeyBjbGFzc05hbWU6ICJ0ZXh0LWJhc2UiLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogMTQxMX19LCAiVGhlIGNvcnJlY3QgYW5zd2VyIGlzICIKICAgICAgICAgICAgICAgICAgICAgICwgUmVhY3QuY3JlYXRlRWxlbWVudCgnc3BhbicsIHsgY2xhc3NOYW1lOiAiZm9udC1ib2xkIiwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDE0MTJ9fSwgY3VycmVudFF1ZXN0aW9uLmEsICIgIiAsIGN1cnJlbnRRdWVzdGlvbi51bml0KSwgIi4iCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgKQogICAgICAgICAgICApCiAgICAgICAgICApDQogICAgICAgICkKCiAgICAgICAgLCBSZWFjdC5jcmVhdGVFbGVtZW50KCdkaXYnLCB7IGNsYXNzTmFtZTogIm10LTgiLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogMTQxOX19CiAgICAgICAgICAsICFzaG93RmVlZGJhY2sgPyAoDQogICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCdidXR0b24nLCB7DQogICAgICAgICAgICAgIG9uQ2xpY2s6IGNoZWNrQW5zd2VyLA0KICAgICAgICAgICAgICBkaXNhYmxlZDogIXVzZXJBbnN3ZXIsDQogICAgICAgICAgICAgIGNsYXNzTmFtZTogInB4LTYgcHktMyBiZy1ibHVlLTYwMCBob3ZlcjpiZy1ibHVlLTcwMCB0ZXh0LXdoaXRlIHJvdW5kZWQtbGcgZm9udC1zZW1pYm9sZCB0cmFuc2l0aW9uLWFsbCB3LWZ1bGwgc206dy1hdXRvIGRpc2FibGVkOm9wYWNpdHktNTAiICAgICAgICAgICwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDE0MjF9fQ0KLCAiQ2hlY2sgQW5zd2VyIgoKICAgICAgICAgICAgKQ0KICAgICAgICAgICkgOiAoDQogICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KCdidXR0b24nLCB7DQogICAgICAgICAgICAgIG9uQ2xpY2s6IG5leHRRdWVzdGlvbiwNCiAgICAgICAgICAgICAgY2xhc3NOYW1lOiAicHgtNiBweS0zIGJnLXB1cnBsZS02MDAgaG92ZXI6YmctcHVycGxlLTcwMCB0ZXh0LXdoaXRlIHJvdW5kZWQtbGcgZm9udC1zZW1pYm9sZCB0cmFuc2l0aW9uLWFsbCB3LWZ1bGwgc206dy1hdXRvIiAgICAgICAgICwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDE0Mjl9fQ0KLCAiTmV4dCBRdWVzdGlvbiAiCiAgICAgICAgICAgICAgICAsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoQ2hldnJvblJpZ2h0LCB7IHNpemU6IDIwLCBjbGFzc05hbWU6ICJpbmxpbmUiLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogMTQzM319ICkKICAgICAgICAgICAgKQ0KICAgICAgICAgICkKICAgICAgICApCiAgICAgICkKICAgICkNCiAgKTsNCn07DQoNCg0KLy8gTWFpbiBBcHAgQ29tcG9uZW50DQpjb25zdCBVbml0Q29udmVyc2lvbkFwcCA9ICgpID0+IHsNCiAgY29uc3QgW2FjdGl2ZVRhYiwgc2V0QWN0aXZlVGFiXSA9IHVzZVN0YXRlKDApOw0KICBjb25zdCBbaXNEYXJrTW9kZSwgc2V0SXNEYXJrTW9kZV0gPSB1c2VTdGF0ZSh0cnVlKTsNCg0KICB1c2VFZmZlY3QoKCkgPT4gew0KICAgIGNvbnN0IHByZWZlcnNEYXJrID0gd2luZG93Lm1hdGNoTWVkaWEoJyhwcmVmZXJzLWNvbG9yLXNjaGVtZTogZGFyayknKS5tYXRjaGVzOw0KICAgIGNvbnN0IHNhdmVkVGhlbWUgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndGhlbWUnKTsNCiAgICANCiAgICBpZiAoc2F2ZWRUaGVtZSA9PT0gJ2RhcmsnKSB7DQogICAgICBzZXRJc0RhcmtNb2RlKHRydWUpOw0KICAgIH0gZWxzZSBpZiAoc2F2ZWRUaGVtZSA9PT0gJ2xpZ2h0Jykgew0KICAgICAgc2V0SXNEYXJrTW9kZShmYWxzZSk7DQogICAgfSBlbHNlIHsNCiAgICAgIHNldElzRGFya01vZGUocHJlZmVyc0RhcmspOw0KICAgIH0NCiAgfSwgW10pOw0KDQogIHVzZUVmZmVjdCgoKSA9PiB7DQogICAgaWYgKGlzRGFya01vZGUpIHsNCiAgICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGFzc0xpc3QuYWRkKCdkYXJrJyk7DQogICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgndGhlbWUnLCAnZGFyaycpOw0KICAgIH0gZWxzZSB7DQogICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnZGFyaycpOw0KICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3RoZW1lJywgJ2xpZ2h0Jyk7DQogICAgfQ0KICB9LCBbaXNEYXJrTW9kZV0pOw0KDQogIGNvbnN0IHRvZ2dsZURhcmtNb2RlID0gKCkgPT4gew0KICAgIHNldElzRGFya01vZGUoIWlzRGFya01vZGUpOw0KICB9Ow0KDQogIGNvbnN0IHRhYnMgPSBbJ1NjYWxlJywgJ0NvbnZlcnNpb25zJywgJ0NhbmNlbGxhdGlvbicsICdQcmFjdGljZSddOw0KDQogIHJldHVybiAoDQogICAgUmVhY3QuY3JlYXRlRWxlbWVudCgnZGl2JywgeyBjbGFzc05hbWU6ICJtaW4taC1zY3JlZW4gYmctd2hpdGUgZGFyazpiZy1ncmF5LTkwMCB0ZXh0LWdyYXktOTAwIGRhcms6dGV4dC1ncmF5LTEwMCBwLTQgbWQ6cC02IHRyYW5zaXRpb24tY29sb3JzIGR1cmF0aW9uLTMwMCIgICAgICAgICwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDE0Nzh9fQogICAgICAsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ2RpdicsIHsgY2xhc3NOYW1lOiAibWF4LXctNnhsIG14LWF1dG8iICwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDE0Nzl9fQogICAgICAgICwgUmVhY3QuY3JlYXRlRWxlbWVudCgnaGVhZGVyJywgeyBjbGFzc05hbWU6ICJtYi02IG1kOm1iLTggZmxleCBqdXN0aWZ5LWJldHdlZW4gaXRlbXMtY2VudGVyIiAgICAsIF9fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiAxNDgwfX0KICAgICAgICAgICwgUmVhY3QuY3JlYXRlRWxlbWVudCgnZGl2Jywge19fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiAxNDgxfX0KICAgICAgICAgICAgLCBSZWFjdC5jcmVhdGVFbGVtZW50KCdoMScsIHsgY2xhc3NOYW1lOiAidGV4dC0zeGwgbWQ6dGV4dC00eGwgZm9udC1ib2xkIG1iLTEgYmctZ3JhZGllbnQtdG8tciBmcm9tLWJsdWUtNTAwIHRvLXB1cnBsZS01MDAgYmctY2xpcC10ZXh0IHRleHQtdHJhbnNwYXJlbnQiICAgICAgICAsIF9fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiAxNDgyfX0sICJVbml0IENvbnZlcnNpb24iCgogICAgICAgICAgICApCiAgICAgICAgICAgICwgUmVhY3QuY3JlYXRlRWxlbWVudCgncCcsIHsgY2xhc3NOYW1lOiAidGV4dC1zbSBtZDp0ZXh0LWJhc2UgdGV4dC1ncmF5LTYwMCBkYXJrOnRleHQtZ3JheS00MDAiICAgLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogMTQ4NX19LCAiTGVhcm4gbWVhc3VyZW1lbnQgYW5kIHVuaXQgY29udmVyc2lvbnMgc3RlcCBieSBzdGVwIiAgICAgICApCiAgICAgICAgICApCiAgICAgICAgICAsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicsIHsNCiAgICAgICAgICAgIG9uQ2xpY2s6IHRvZ2dsZURhcmtNb2RlLA0KICAgICAgICAgICAgY2xhc3NOYW1lOiAicC0yIHJvdW5kZWQtZnVsbCBiZy1ncmF5LTIwMCBkYXJrOmJnLWdyYXktODAwIHRleHQtZ3JheS03MDAgZGFyazp0ZXh0LWdyYXktMzAwIGhvdmVyOmJnLWdyYXktMzAwIGRhcms6aG92ZXI6YmctZ3JheS03MDAgdHJhbnNpdGlvbi1hbGwiICAgICAgICAsDQogICAgICAgICAgICAnYXJpYS1sYWJlbCc6ICJUb2dnbGUgZGFyayBtb2RlIiAgLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogMTQ4N319DQoKICAgICAgICAgICAgLCBpc0RhcmtNb2RlID8gUmVhY3QuY3JlYXRlRWxlbWVudChTdW4sIHsgc2l6ZTogMjAsIF9fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiAxNDkyfX0gKSA6IFJlYWN0LmNyZWF0ZUVsZW1lbnQoTW9vbiwgeyBzaXplOiAyMCwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDE0OTJ9fSApCiAgICAgICAgICApCiAgICAgICAgKQoKICAgICAgICAvKiBUYWJzICovCiAgICAgICAgLCBSZWFjdC5jcmVhdGVFbGVtZW50KCduYXYnLCB7IGNsYXNzTmFtZTogIm1iLTYgbWQ6bWItOCIgLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogMTQ5N319CiAgICAgICAgICAsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ2RpdicsIHsgY2xhc3NOYW1lOiAiZmxleCBmbGV4LXdyYXAgZ2FwLTIgcGItMiAtbWItMiIgICAgLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogMTQ5OH19CiAgICAgICAgICAgICwgdGFicy5tYXAoKHRhYiwgaW5kZXgpID0+ICgNCiAgICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgnYnV0dG9uJywgew0KICAgICAgICAgICAgICAgIGtleTogaW5kZXgsDQogICAgICAgICAgICAgICAgb25DbGljazogKCkgPT4gc2V0QWN0aXZlVGFiKGluZGV4KSwNCiAgICAgICAgICAgICAgICBjbGFzc05hbWU6IGBweC00IHB5LTIgbWQ6cHgtNiBtZDpweS0zIHJvdW5kZWQtbGcgZm9udC1zZW1pYm9sZCB3aGl0ZXNwYWNlLW5vd3JhcCB0cmFuc2l0aW9uLWFsbCB0cmFuc2Zvcm0gYWN0aXZlOnNjYWxlLTk1ICR7DQogICAgICAgICAgICAgICAgICBhY3RpdmVUYWIgPT09IGluZGV4DQogICAgICAgICAgICAgICAgICAgID8gJ2JnLWJsdWUtNjAwIHRleHQtd2hpdGUgc2hhZG93LWxnIHNoYWRvdy1ibHVlLTUwMC8zMCBkYXJrOnNoYWRvdy1ibHVlLTUwMC81MCcNCiAgICAgICAgICAgICAgICAgICAgOiAnYmctZ3JheS0yMDAgZGFyazpiZy1ncmF5LTgwMCB0ZXh0LWdyYXktNjAwIGRhcms6dGV4dC1ncmF5LTQwMCBob3ZlcjpiZy1ncmF5LTMwMCBkYXJrOmhvdmVyOmJnLWdyYXktNzAwIGFjdGl2ZTpiZy1ncmF5LTQwMCBkYXJrOmFjdGl2ZTpiZy1ncmF5LTYwMCcNCiAgICAgICAgICAgICAgICB9YCwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDE1MDB9fQ0KCiAgICAgICAgICAgICAgICAsIGluZGV4ICsgMSwgIi4gIiAsIHRhYgogICAgICAgICAgICAgICkNCiAgICAgICAgICAgICkpCiAgICAgICAgICApCiAgICAgICAgKQoKICAgICAgICAvKiBUYWIgQ29udGVudCAqLwogICAgICAgICwgUmVhY3QuY3JlYXRlRWxlbWVudCgnbWFpbicsIHsgY2xhc3NOYW1lOiAiYmctZ3JheS0xMDAgZGFyazpiZy1ncmF5LTgwMCByb3VuZGVkLXhsIHAtNiBtZDpwLTggc2hhZG93LWlubmVyIGRhcms6c2hhZG93LTJ4bCIgICAgICAsIF9fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiAxNTE2fX0KICAgICAgICAgICwgYWN0aXZlVGFiID09PSAwICYmIFJlYWN0LmNyZWF0ZUVsZW1lbnQoU2Vuc2VPZlNjYWxlVGFiLCB7X19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDE1MTd9fSApCiAgICAgICAgICAsIGFjdGl2ZVRhYiA9PT0gMSAmJiBSZWFjdC5jcmVhdGVFbGVtZW50KFVuZGVyc3RhbmRpbmdDb252ZXJzaW9uc1RhYiwge19fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiAxNTE4fX0gKQogICAgICAgICAgLCBhY3RpdmVUYWIgPT09IDIgJiYgUmVhY3QuY3JlYXRlRWxlbWVudChVbml0Q2FuY2VsbGF0aW9uVGFiLCB7X19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDE1MTl9fSApCiAgICAgICAgICAsIGFjdGl2ZVRhYiA9PT0gMyAmJiBSZWFjdC5jcmVhdGVFbGVtZW50KFByYWN0aWNlVGFiLCB7X19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDE1MjB9fSApCiAgICAgICAgKQoKICAgICAgICAsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ2Zvb3RlcicsIHsgY2xhc3NOYW1lOiAidGV4dC1jZW50ZXIgbXQtOCB0ZXh0LWdyYXktNTAwIGRhcms6dGV4dC1ncmF5LTYwMCB0ZXh0LXNtIiAgICAsIF9fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiAxNTIzfX0sICJVbml0IENvbnZlcnNpb24gVHV0b3IgQXBwIgoKICAgICAgICApCiAgICAgICkKICAgICkNCiAgKTsNCn07DQoNCi8vIEVycm9yIEJvdW5kYXJ5DQpjbGFzcyBFcnJvckJvdW5kYXJ5IGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHsNCiAgY29uc3RydWN0b3IocHJvcHMpIHsNCiAgICBzdXBlcihwcm9wcyk7DQogICAgdGhpcy5zdGF0ZSA9IHsgaGFzRXJyb3I6IGZhbHNlLCBlcnJvcjogbnVsbCB9Ow0KICB9DQoNCiAgc3RhdGljIGdldERlcml2ZWRTdGF0ZUZyb21FcnJvcihlcnJvcikgew0KICAgIHJldHVybiB7IGhhc0Vycm9yOiB0cnVlLCBlcnJvcjogZXJyb3IgfTsNCiAgfQ0KDQogIGNvbXBvbmVudERpZENhdGNoKGVycm9yLCBlcnJvckluZm8pIHsNCiAgICBjb25zb2xlLmVycm9yKCJVbmNhdWdodCBlcnJvcjoiLCBlcnJvciwgZXJyb3JJbmZvKTsNCiAgfQ0KDQogIHJlbmRlcigpIHsNCiAgICBpZiAodGhpcy5zdGF0ZS5oYXNFcnJvcikgew0KICAgICAgcmV0dXJuICgNCiAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudCgnZGl2JywgeyBjbGFzc05hbWU6ICJtaW4taC1zY3JlZW4gYmctZ3JheS05MDAgdGV4dC1ncmF5LTEwMCBwLTYgZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXIiICAgICAgLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogMTU0OX19CiAgICAgICAgICAsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ2RpdicsIHsgY2xhc3NOYW1lOiAiYmctcmVkLTkwMC81MCBib3JkZXItMiBib3JkZXItcmVkLTUwMCBwLTggcm91bmRlZC1sZyBtYXgtdy0yeGwiICAgICAsIF9fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiAxNTUwfX0KICAgICAgICAgICAgLCBSZWFjdC5jcmVhdGVFbGVtZW50KCdoMScsIHsgY2xhc3NOYW1lOiAidGV4dC0zeGwgZm9udC1ib2xkIG1iLTQgdGV4dC1yZWQtMzAwIiAgICwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDE1NTF9fSwgIlNvbWV0aGluZyB3ZW50IHdyb25nLiIgICkKICAgICAgICAgICAgLCBSZWFjdC5jcmVhdGVFbGVtZW50KCdwJywgeyBjbGFzc05hbWU6ICJ0ZXh0LWxnIHRleHQtZ3JheS0yMDAgbWItNiIgICwgX19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDE1NTJ9fSwgIkFuIGVycm9yIG9jY3VycmVkIGluIHRoZSBhcHBsaWNhdGlvbi4gUGxlYXNlIHRyeSByZWZyZXNoaW5nIHRoZSBwYWdlLiIgICAgICAgICAgKQogICAgICAgICAgICAsIFJlYWN0LmNyZWF0ZUVsZW1lbnQoJ3ByZScsIHsgY2xhc3NOYW1lOiAiYmctZ3JheS04MDAgcC00IHJvdW5kZWQtbGcgdGV4dC1yZWQtMjAwIG92ZXJmbG93LXgtYXV0byIgICAgLCBfX3NlbGY6IHRoaXMsIF9fc291cmNlOiB7ZmlsZU5hbWU6IF9qc3hGaWxlTmFtZSwgbGluZU51bWJlcjogMTU1M319CiAgICAgICAgICAgICAgLCB0aGlzLnN0YXRlLmVycm9yICYmIHRoaXMuc3RhdGUuZXJyb3IudG9TdHJpbmcoKQogICAgICAgICAgICApCiAgICAgICAgICApCiAgICAgICAgKQ0KICAgICAgKTsNCiAgICB9DQogICAgcmV0dXJuIHRoaXMucHJvcHMuY2hpbGRyZW47DQogIH0NCn0NCg0KLy8gRmluYWwgQXBwIGV4cG9ydA0KZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gQXBwKCkgew0KICByZXR1cm4gKA0KICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoRXJyb3JCb3VuZGFyeSwge19fc2VsZjogdGhpcywgX19zb3VyY2U6IHtmaWxlTmFtZTogX2pzeEZpbGVOYW1lLCBsaW5lTnVtYmVyOiAxNTY3fX0KICAgICAgLCBSZWFjdC5jcmVhdGVFbGVtZW50KFVuaXRDb252ZXJzaW9uQXBwLCB7X19zZWxmOiB0aGlzLCBfX3NvdXJjZToge2ZpbGVOYW1lOiBfanN4RmlsZU5hbWUsIGxpbmVOdW1iZXI6IDE1Njh9fSApCiAgICApDQogICk7DQp9DQoNCi8vIEN1c3RvbSBDU1MgZm9yIHNsaWRlciB0aHVtYiBhbmQgdG8gaGlkZSBudW1iZXIgaW5wdXQgc3Bpbm5lcnMNCmNvbnN0IHN0eWxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3R5bGUnKTsNCnN0eWxlLnRleHRDb250ZW50ID0gYA0KICAvKiAtLS0gU2xpZGVyIFRodW1iIFN0eWxlcyAtLS0gKi8NCiAgaW5wdXRbdHlwZT1yYW5nZV06Oi13ZWJraXQtc2xpZGVyLXRodW1iIHsNCiAgICAtd2Via2l0LWFwcGVhcmFuY2U6IG5vbmU7DQogICAgYXBwZWFyYW5jZTogbm9uZTsNCiAgICB3aWR0aDogMjBweDsNCiAgICBoZWlnaHQ6IDIwcHg7DQogICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0tc2xpZGVyLXRodW1iLWJnLCAjM2I4MmY2KTsNCiAgICBib3JkZXI6IDJweCBzb2xpZCB2YXIoLS1zbGlkZXItdGh1bWItYm9yZGVyLCAjMWUzYThhKTsNCiAgICBib3JkZXItcmFkaXVzOiA1MCU7DQogICAgY3Vyc29yOiBncmFiOw0KICAgIG1hcmdpbi10b3A6IC02cHg7IC8qIENlbnRlciAyMHB4IHRodW1iIG9uIDhweCB0cmFjayAoICg4LTIwKS8yID0gLTYgKSAqLw0KICAgIHRyYW5zaXRpb246IGJhY2tncm91bmQtY29sb3IgMC4yczsNCiAgICB6LWluZGV4OiAyMDsgLyogRW5zdXJlIHRodW1iIGlzIGFib3ZlIHRyYWNrICovDQogICAgcG9zaXRpb246IHJlbGF0aXZlOyAvKiBFbnN1cmUgei1pbmRleCBpcyBhcHBsaWVkICovDQogIH0NCiAgaW5wdXRbdHlwZT1yYW5nZV06Oi1tb3otcmFuZ2UtdGh1bWIgew0KICAgIHdpZHRoOiAyMHB4Ow0KICAgIGhlaWdodDogMjBweDsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1zbGlkZXItdGh1bWItYmcsICMzYjgyZjYpOw0KICAgIGJvcmRlcjogMnB4IHNvbGlkIHZhcigtLXNsaWRlci10aHVtYi1ib3JkZXIsICMxZTNhOGEpOw0KICAgIGJvcmRlci1yYWRpdXM6IDUwJTsNCiAgICBjdXJzb3I6IGdyYWI7DQogICAgei1pbmRleDogMjA7DQogICAgcG9zaXRpb246IHJlbGF0aXZlOw0KICB9DQogIGlucHV0W3R5cGU9cmFuZ2VdOmFjdGl2ZTo6LXdlYmtpdC1zbGlkZXItdGh1bWIgew0KICAgIGJhY2tncm91bmQtY29sb3I6ICM2MGE1ZmE7IC8qIEEgbGlnaHRlciBibHVlIGZvciBhY3RpdmUgc3RhdGUgKi8NCiAgICBjdXJzb3I6IGdyYWJiaW5nOw0KICB9DQogIGlucHV0W3R5cGU9cmFuZ2VdOmFjdGl2ZTo6LW1vei1yYW5nZS10aHVtYiB7DQogICAgYmFja2dyb3VuZC1jb2xvcjogIzYwYTVmYTsNCiAgICBjdXJzb3I6IGdyYWJiaW5nOw0KICB9DQoNCiAgLyogLS0tIEhpZGUgTnVtYmVyIElucHV0IFNwaW5uZXJzIC0tLSAqLw0KICAucHJhY3RpY2UtaW5wdXQ6Oi13ZWJraXQtb3V0ZXItc3Bpbi1idXR0b24sDQogIC5wcmFjdGljZS1pbnB1dDo6LXdlYmtpdC1pbm5lci1zcGluLWJ1dHRvbiB7DQogICAgLXdlYmtpdC1hcHBlYXJhbmNlOiBub25lOw0KICAgIG1hcmdpbjogMDsNCiAgfQ0KICAucHJhY3RpY2UtaW5wdXRbdHlwZT1udW1iZXJdIHsNCiAgICAtbW96LWFwcGVhcmFuY2U6IHRleHRmaWVsZDsNCiAgfQ0KYDsNCmRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQoc3R5bGUpOwppbXBvcnQgeyBjcmVhdGVSb290IH0gZnJvbSAicmVhY3QtZG9tL2NsaWVudCI7CgogICAgZXhwb3J0IGNvbnN0IF9SZWFjdCA9IFJlYWN0OwogICAgZXhwb3J0IGNvbnN0IF9jcmVhdGVSb290ID0gY3JlYXRlUm9vdDsKICA=";

      const binaryString = atob(encodedReactCode);
      const bytes = new Uint8Array(binaryString.length);
      for (let i = 0; i < binaryString.length; i++) {
        bytes[i] = binaryString.charCodeAt(i);
      }
      const decodedReactCode = new TextDecoder("utf-8").decode(bytes);

      const blob = new Blob([decodedReactCode], {
        type: "application/javascript",
      });
      const moduleUrl = URL.createObjectURL(blob);

      import(moduleUrl)
        .then((module) => {
          const rootElement = document.getElementById("root");
          if (
            rootElement &&
            module.default &&
            typeof module.default === "function"
          ) {
            const React = module._React;
            const createRoot = module._createRoot;
            const root = createRoot(rootElement);
            root.render(React.createElement(module.default));
          } else {
            console.error(
              "Failed to mount React app: root element or module default export is not valid"
            );
          }

          URL.revokeObjectURL(moduleUrl);
        })
        .catch((error) => {
          console.error("Error importing module:", error);
          URL.revokeObjectURL(moduleUrl);
        });
    </script>
  </body>
</html>
